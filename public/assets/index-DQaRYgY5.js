(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function $R(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var wp={exports:{}},bu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE;function WR(){if(cE)return bu;cE=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:i,type:s,key:c,ref:a!==void 0?a:null,props:l}}return bu.Fragment=e,bu.jsx=t,bu.jsxs=t,bu}var hE;function XR(){return hE||(hE=1,wp.exports=WR()),wp.exports}var T=XR(),Sp={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE;function JR(){if(dE)return Le;dE=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),b=Symbol.iterator;function S(N){return N===null||typeof N!="object"?null:(N=b&&N[b]||N["@@iterator"],typeof N=="function"?N:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,q={};function K(N,X,re){this.props=N,this.context=X,this.refs=q,this.updater=re||P}K.prototype.isReactComponent={},K.prototype.setState=function(N,X){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,X,"setState")},K.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function pe(){}pe.prototype=K.prototype;function ae(N,X,re){this.props=N,this.context=X,this.refs=q,this.updater=re||P}var ce=ae.prototype=new pe;ce.constructor=ae,k(ce,K.prototype),ce.isPureReactComponent=!0;var Te=Array.isArray,be={H:null,A:null,T:null,S:null,V:null},Re=Object.prototype.hasOwnProperty;function M(N,X,re,ne,ye,Oe){return re=Oe.ref,{$$typeof:i,type:N,key:X,ref:re!==void 0?re:null,props:Oe}}function R(N,X){return M(N.type,X,void 0,void 0,void 0,N.props)}function I(N){return typeof N=="object"&&N!==null&&N.$$typeof===i}function D(N){var X={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(re){return X[re]})}var V=/\/+/g;function L(N,X){return typeof N=="object"&&N!==null&&N.key!=null?D(""+N.key):X.toString(36)}function x(){}function ue(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(x,x):(N.status="pending",N.then(function(X){N.status==="pending"&&(N.status="fulfilled",N.value=X)},function(X){N.status==="pending"&&(N.status="rejected",N.reason=X)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function oe(N,X,re,ne,ye){var Oe=typeof N;(Oe==="undefined"||Oe==="boolean")&&(N=null);var Ne=!1;if(N===null)Ne=!0;else switch(Oe){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(N.$$typeof){case i:case e:Ne=!0;break;case y:return Ne=N._init,oe(Ne(N._payload),X,re,ne,ye)}}if(Ne)return ye=ye(N),Ne=ne===""?"."+L(N,0):ne,Te(ye)?(re="",Ne!=null&&(re=Ne.replace(V,"$&/")+"/"),oe(ye,X,re,"",function(Wn){return Wn})):ye!=null&&(I(ye)&&(ye=R(ye,re+(ye.key==null||N&&N.key===ye.key?"":(""+ye.key).replace(V,"$&/")+"/")+Ne)),X.push(ye)),1;Ne=0;var Mt=ne===""?".":ne+":";if(Te(N))for(var ot=0;ot<N.length;ot++)ne=N[ot],Oe=Mt+L(ne,ot),Ne+=oe(ne,X,re,Oe,ye);else if(ot=S(N),typeof ot=="function")for(N=ot.call(N),ot=0;!(ne=N.next()).done;)ne=ne.value,Oe=Mt+L(ne,ot++),Ne+=oe(ne,X,re,Oe,ye);else if(Oe==="object"){if(typeof N.then=="function")return oe(ue(N),X,re,ne,ye);throw X=String(N),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function z(N,X,re){if(N==null)return N;var ne=[],ye=0;return oe(N,ne,"","",function(Oe){return X.call(re,Oe,ye++)}),ne}function te(N){if(N._status===-1){var X=N._result;X=X(),X.then(function(re){(N._status===0||N._status===-1)&&(N._status=1,N._result=re)},function(re){(N._status===0||N._status===-1)&&(N._status=2,N._result=re)}),N._status===-1&&(N._status=0,N._result=X)}if(N._status===1)return N._result.default;throw N._result}var Z=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var X=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(X))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)};function fe(){}return Le.Children={map:z,forEach:function(N,X,re){z(N,function(){X.apply(this,arguments)},re)},count:function(N){var X=0;return z(N,function(){X++}),X},toArray:function(N){return z(N,function(X){return X})||[]},only:function(N){if(!I(N))throw Error("React.Children.only expected to receive a single React element child.");return N}},Le.Component=K,Le.Fragment=t,Le.Profiler=a,Le.PureComponent=ae,Le.StrictMode=s,Le.Suspense=p,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=be,Le.__COMPILER_RUNTIME={__proto__:null,c:function(N){return be.H.useMemoCache(N)}},Le.cache=function(N){return function(){return N.apply(null,arguments)}},Le.cloneElement=function(N,X,re){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var ne=k({},N.props),ye=N.key,Oe=void 0;if(X!=null)for(Ne in X.ref!==void 0&&(Oe=void 0),X.key!==void 0&&(ye=""+X.key),X)!Re.call(X,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&X.ref===void 0||(ne[Ne]=X[Ne]);var Ne=arguments.length-2;if(Ne===1)ne.children=re;else if(1<Ne){for(var Mt=Array(Ne),ot=0;ot<Ne;ot++)Mt[ot]=arguments[ot+2];ne.children=Mt}return M(N.type,ye,void 0,void 0,Oe,ne)},Le.createContext=function(N){return N={$$typeof:c,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:l,_context:N},N},Le.createElement=function(N,X,re){var ne,ye={},Oe=null;if(X!=null)for(ne in X.key!==void 0&&(Oe=""+X.key),X)Re.call(X,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(ye[ne]=X[ne]);var Ne=arguments.length-2;if(Ne===1)ye.children=re;else if(1<Ne){for(var Mt=Array(Ne),ot=0;ot<Ne;ot++)Mt[ot]=arguments[ot+2];ye.children=Mt}if(N&&N.defaultProps)for(ne in Ne=N.defaultProps,Ne)ye[ne]===void 0&&(ye[ne]=Ne[ne]);return M(N,Oe,void 0,void 0,null,ye)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(N){return{$$typeof:f,render:N}},Le.isValidElement=I,Le.lazy=function(N){return{$$typeof:y,_payload:{_status:-1,_result:N},_init:te}},Le.memo=function(N,X){return{$$typeof:g,type:N,compare:X===void 0?null:X}},Le.startTransition=function(N){var X=be.T,re={};be.T=re;try{var ne=N(),ye=be.S;ye!==null&&ye(re,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(fe,Z)}catch(Oe){Z(Oe)}finally{be.T=X}},Le.unstable_useCacheRefresh=function(){return be.H.useCacheRefresh()},Le.use=function(N){return be.H.use(N)},Le.useActionState=function(N,X,re){return be.H.useActionState(N,X,re)},Le.useCallback=function(N,X){return be.H.useCallback(N,X)},Le.useContext=function(N){return be.H.useContext(N)},Le.useDebugValue=function(){},Le.useDeferredValue=function(N,X){return be.H.useDeferredValue(N,X)},Le.useEffect=function(N,X,re){var ne=be.H;if(typeof re=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ne.useEffect(N,X)},Le.useId=function(){return be.H.useId()},Le.useImperativeHandle=function(N,X,re){return be.H.useImperativeHandle(N,X,re)},Le.useInsertionEffect=function(N,X){return be.H.useInsertionEffect(N,X)},Le.useLayoutEffect=function(N,X){return be.H.useLayoutEffect(N,X)},Le.useMemo=function(N,X){return be.H.useMemo(N,X)},Le.useOptimistic=function(N,X){return be.H.useOptimistic(N,X)},Le.useReducer=function(N,X,re){return be.H.useReducer(N,X,re)},Le.useRef=function(N){return be.H.useRef(N)},Le.useState=function(N){return be.H.useState(N)},Le.useSyncExternalStore=function(N,X,re){return be.H.useSyncExternalStore(N,X,re)},Le.useTransition=function(){return be.H.useTransition()},Le.version="19.1.0",Le}var fE;function Mg(){return fE||(fE=1,Sp.exports=JR()),Sp.exports}var Se=Mg();const mE=$R(Se);var Ap={exports:{}},wu={},Rp={exports:{}},Cp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pE;function ZR(){return pE||(pE=1,function(i){function e(z,te){var Z=z.length;z.push(te);e:for(;0<Z;){var fe=Z-1>>>1,N=z[fe];if(0<a(N,te))z[fe]=te,z[Z]=N,Z=fe;else break e}}function t(z){return z.length===0?null:z[0]}function s(z){if(z.length===0)return null;var te=z[0],Z=z.pop();if(Z!==te){z[0]=Z;e:for(var fe=0,N=z.length,X=N>>>1;fe<X;){var re=2*(fe+1)-1,ne=z[re],ye=re+1,Oe=z[ye];if(0>a(ne,Z))ye<N&&0>a(Oe,ne)?(z[fe]=Oe,z[ye]=Z,fe=ye):(z[fe]=ne,z[re]=Z,fe=re);else if(ye<N&&0>a(Oe,Z))z[fe]=Oe,z[ye]=Z,fe=ye;else break e}}return te}function a(z,te){var Z=z.sortIndex-te.sortIndex;return Z!==0?Z:z.id-te.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;i.unstable_now=function(){return l.now()}}else{var c=Date,f=c.now();i.unstable_now=function(){return c.now()-f}}var p=[],g=[],y=1,b=null,S=3,P=!1,k=!1,q=!1,K=!1,pe=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,ce=typeof setImmediate<"u"?setImmediate:null;function Te(z){for(var te=t(g);te!==null;){if(te.callback===null)s(g);else if(te.startTime<=z)s(g),te.sortIndex=te.expirationTime,e(p,te);else break;te=t(g)}}function be(z){if(q=!1,Te(z),!k)if(t(p)!==null)k=!0,Re||(Re=!0,L());else{var te=t(g);te!==null&&oe(be,te.startTime-z)}}var Re=!1,M=-1,R=5,I=-1;function D(){return K?!0:!(i.unstable_now()-I<R)}function V(){if(K=!1,Re){var z=i.unstable_now();I=z;var te=!0;try{e:{k=!1,q&&(q=!1,ae(M),M=-1),P=!0;var Z=S;try{t:{for(Te(z),b=t(p);b!==null&&!(b.expirationTime>z&&D());){var fe=b.callback;if(typeof fe=="function"){b.callback=null,S=b.priorityLevel;var N=fe(b.expirationTime<=z);if(z=i.unstable_now(),typeof N=="function"){b.callback=N,Te(z),te=!0;break t}b===t(p)&&s(p),Te(z)}else s(p);b=t(p)}if(b!==null)te=!0;else{var X=t(g);X!==null&&oe(be,X.startTime-z),te=!1}}break e}finally{b=null,S=Z,P=!1}te=void 0}}finally{te?L():Re=!1}}}var L;if(typeof ce=="function")L=function(){ce(V)};else if(typeof MessageChannel<"u"){var x=new MessageChannel,ue=x.port2;x.port1.onmessage=V,L=function(){ue.postMessage(null)}}else L=function(){pe(V,0)};function oe(z,te){M=pe(function(){z(i.unstable_now())},te)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(z){z.callback=null},i.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<z?Math.floor(1e3/z):5},i.unstable_getCurrentPriorityLevel=function(){return S},i.unstable_next=function(z){switch(S){case 1:case 2:case 3:var te=3;break;default:te=S}var Z=S;S=te;try{return z()}finally{S=Z}},i.unstable_requestPaint=function(){K=!0},i.unstable_runWithPriority=function(z,te){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Z=S;S=z;try{return te()}finally{S=Z}},i.unstable_scheduleCallback=function(z,te,Z){var fe=i.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?fe+Z:fe):Z=fe,z){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=Z+N,z={id:y++,callback:te,priorityLevel:z,startTime:Z,expirationTime:N,sortIndex:-1},Z>fe?(z.sortIndex=Z,e(g,z),t(p)===null&&z===t(g)&&(q?(ae(M),M=-1):q=!0,oe(be,Z-fe))):(z.sortIndex=N,e(p,z),k||P||(k=!0,Re||(Re=!0,L()))),z},i.unstable_shouldYield=D,i.unstable_wrapCallback=function(z){var te=S;return function(){var Z=S;S=te;try{return z.apply(this,arguments)}finally{S=Z}}}}(Cp)),Cp}var gE;function eC(){return gE||(gE=1,Rp.exports=ZR()),Rp.exports}var Ip={exports:{}},gn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _E;function tC(){if(_E)return gn;_E=1;var i=Mg();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)g+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(p,g,y){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:p,containerInfo:g,implementation:y}}var c=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return gn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,gn.createPortal=function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(p,g,null,y)},gn.flushSync=function(p){var g=c.T,y=s.p;try{if(c.T=null,s.p=2,p)return p()}finally{c.T=g,s.p=y,s.d.f()}},gn.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,s.d.C(p,g))},gn.prefetchDNS=function(p){typeof p=="string"&&s.d.D(p)},gn.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var y=g.as,b=f(y,g.crossOrigin),S=typeof g.integrity=="string"?g.integrity:void 0,P=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;y==="style"?s.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:b,integrity:S,fetchPriority:P}):y==="script"&&s.d.X(p,{crossOrigin:b,integrity:S,fetchPriority:P,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},gn.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var y=f(g.as,g.crossOrigin);s.d.M(p,{crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&s.d.M(p)},gn.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var y=g.as,b=f(y,g.crossOrigin);s.d.L(p,y,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},gn.preloadModule=function(p,g){if(typeof p=="string")if(g){var y=f(g.as,g.crossOrigin);s.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else s.d.m(p)},gn.requestFormReset=function(p){s.d.r(p)},gn.unstable_batchedUpdates=function(p,g){return p(g)},gn.useFormState=function(p,g,y){return c.H.useFormState(p,g,y)},gn.useFormStatus=function(){return c.H.useHostTransitionStatus()},gn.version="19.1.0",gn}var yE;function nC(){if(yE)return Ip.exports;yE=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Ip.exports=tC(),Ip.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vE;function iC(){if(vE)return wu;vE=1;var i=eC(),e=Mg(),t=nC();function s(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function c(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function f(n){if(l(n)!==n)throw Error(s(188))}function p(n){var r=n.alternate;if(!r){if(r=l(n),r===null)throw Error(s(188));return r!==n?null:n}for(var o=n,u=r;;){var d=o.return;if(d===null)break;var m=d.alternate;if(m===null){if(u=d.return,u!==null){o=u;continue}break}if(d.child===m.child){for(m=d.child;m;){if(m===o)return f(d),n;if(m===u)return f(d),r;m=m.sibling}throw Error(s(188))}if(o.return!==u.return)o=d,u=m;else{for(var E=!1,w=d.child;w;){if(w===o){E=!0,o=d,u=m;break}if(w===u){E=!0,u=d,o=m;break}w=w.sibling}if(!E){for(w=m.child;w;){if(w===o){E=!0,o=m,u=d;break}if(w===u){E=!0,u=m,o=d;break}w=w.sibling}if(!E)throw Error(s(189))}}if(o.alternate!==u)throw Error(s(190))}if(o.tag!==3)throw Error(s(188));return o.stateNode.current===o?n:r}function g(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=g(n),r!==null)return r;n=n.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),pe=Symbol.for("react.provider"),ae=Symbol.for("react.consumer"),ce=Symbol.for("react.context"),Te=Symbol.for("react.forward_ref"),be=Symbol.for("react.suspense"),Re=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function L(n){return n===null||typeof n!="object"?null:(n=V&&n[V]||n["@@iterator"],typeof n=="function"?n:null)}var x=Symbol.for("react.client.reference");function ue(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===x?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case k:return"Fragment";case K:return"Profiler";case q:return"StrictMode";case be:return"Suspense";case Re:return"SuspenseList";case I:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case P:return"Portal";case ce:return(n.displayName||"Context")+".Provider";case ae:return(n._context.displayName||"Context")+".Consumer";case Te:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case M:return r=n.displayName||null,r!==null?r:ue(n.type)||"Memo";case R:r=n._payload,n=n._init;try{return ue(n(r))}catch{}}return null}var oe=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},fe=[],N=-1;function X(n){return{current:n}}function re(n){0>N||(n.current=fe[N],fe[N]=null,N--)}function ne(n,r){N++,fe[N]=n.current,n.current=r}var ye=X(null),Oe=X(null),Ne=X(null),Mt=X(null);function ot(n,r){switch(ne(Ne,r),ne(Oe,n),ne(ye,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?Uv(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=Uv(r),n=jv(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}re(ye),ne(ye,n)}function Wn(){re(ye),re(Oe),re(Ne)}function xi(n){n.memoizedState!==null&&ne(Mt,n);var r=ye.current,o=jv(r,n.type);r!==o&&(ne(Oe,n),ne(ye,o))}function mi(n){Oe.current===n&&(re(ye),re(Oe)),Mt.current===n&&(re(Mt),_u._currentValue=Z)}var rs=Object.prototype.hasOwnProperty,as=i.unstable_scheduleCallback,os=i.unstable_cancelCallback,Xs=i.unstable_shouldYield,ls=i.unstable_requestPaint,An=i.unstable_now,vl=i.unstable_getCurrentPriorityLevel,Jr=i.unstable_ImmediatePriority,Ni=i.unstable_UserBlockingPriority,pi=i.unstable_NormalPriority,El=i.unstable_LowPriority,us=i.unstable_IdlePriority,Js=i.log,$a=i.unstable_setDisableYieldValue,Et=null,Pe=null;function Rn(n){if(typeof Js=="function"&&$a(n),Pe&&typeof Pe.setStrictMode=="function")try{Pe.setStrictMode(Et,n)}catch{}}var $t=Math.clz32?Math.clz32:cs,Wa=Math.log,Tl=Math.LN2;function cs(n){return n>>>=0,n===0?32:31-(Wa(n)/Tl|0)|0}var hs=256,ds=4194304;function Un(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Zs(n,r,o){var u=n.pendingLanes;if(u===0)return 0;var d=0,m=n.suspendedLanes,E=n.pingedLanes;n=n.warmLanes;var w=u&134217727;return w!==0?(u=w&~m,u!==0?d=Un(u):(E&=w,E!==0?d=Un(E):o||(o=w&~n,o!==0&&(d=Un(o))))):(w=u&~m,w!==0?d=Un(w):E!==0?d=Un(E):o||(o=u&~n,o!==0&&(d=Un(o)))),d===0?0:r!==0&&r!==d&&(r&m)===0&&(m=d&-d,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:d}function fs(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function ie(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function me(){var n=hs;return hs<<=1,(hs&4194048)===0&&(hs=256),n}function ge(){var n=ds;return ds<<=1,(ds&62914560)===0&&(ds=4194304),n}function Ee(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function Fe(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function ze(n,r,o,u,d,m){var E=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var w=n.entanglements,C=n.expirationTimes,F=n.hiddenUpdates;for(o=E&~o;0<o;){var Q=31-$t(o),J=1<<Q;w[Q]=0,C[Q]=-1;var H=F[Q];if(H!==null)for(F[Q]=null,Q=0;Q<H.length;Q++){var G=H[Q];G!==null&&(G.lane&=-536870913)}o&=~J}u!==0&&Ve(n,u,0),m!==0&&d===0&&n.tag!==0&&(n.suspendedLanes|=m&~(E&~r))}function Ve(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var u=31-$t(r);n.entangledLanes|=r,n.entanglements[u]=n.entanglements[u]|1073741824|o&4194090}function zt(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var u=31-$t(o),d=1<<u;d&r|n[u]&r&&(n[u]|=r),o&=~d}}function xt(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function rn(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function gi(){var n=te.p;return n!==0?n:(n=window.event,n===void 0?32:sE(n.type))}function bc(n,r){var o=te.p;try{return te.p=n,r()}finally{te.p=o}}var Tt=Math.random().toString(36).slice(2),qt="__reactFiber$"+Tt,Pt="__reactProps$"+Tt,Xn="__reactContainer$"+Tt,bl="__reactEvents$"+Tt,Rf="__reactListeners$"+Tt,er="__reactHandles$"+Tt,wc="__reactResources$"+Tt,Zr="__reactMarker$"+Tt;function tr(n){delete n[qt],delete n[Pt],delete n[bl],delete n[Rf],delete n[er]}function ms(n){var r=n[qt];if(r)return r;for(var o=n.parentNode;o;){if(r=o[Xn]||o[qt]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=qv(n);n!==null;){if(o=n[qt])return o;n=qv(n)}return r}n=o,o=n.parentNode}return null}function Di(n){if(n=n[qt]||n[Xn]){var r=n.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return n}return null}function Oi(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(s(33))}function Cn(n){var r=n[wc];return r||(r=n[wc]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Nt(n){n[Zr]=!0}var wl=new Set,Xa={};function _i(n,r){ps(n,r),ps(n+"Capture",r)}function ps(n,r){for(Xa[n]=r,n=0;n<r.length;n++)wl.add(r[n])}var Sc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ac={},ea={};function Rc(n){return rs.call(ea,n)?!0:rs.call(Ac,n)?!1:Sc.test(n)?ea[n]=!0:(Ac[n]=!0,!1)}function nr(n,r,o){if(Rc(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function ki(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function an(n,r,o,u){if(u===null)n.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+u)}}var ta,Cc;function gs(n){if(ta===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);ta=r&&r[1]||"",Cc=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ta+n+Cc}var Ja=!1;function Za(n,r){if(!n||Ja)return"";Ja=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(G){var H=G}Reflect.construct(n,[],J)}else{try{J.call()}catch(G){H=G}n.call(J.prototype)}}else{try{throw Error()}catch(G){H=G}(J=n())&&typeof J.catch=="function"&&J.catch(function(){})}}catch(G){if(G&&H&&typeof G.stack=="string")return[G.stack,H.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=u.DetermineComponentFrameRoot(),E=m[0],w=m[1];if(E&&w){var C=E.split(`
`),F=w.split(`
`);for(d=u=0;u<C.length&&!C[u].includes("DetermineComponentFrameRoot");)u++;for(;d<F.length&&!F[d].includes("DetermineComponentFrameRoot");)d++;if(u===C.length||d===F.length)for(u=C.length-1,d=F.length-1;1<=u&&0<=d&&C[u]!==F[d];)d--;for(;1<=u&&0<=d;u--,d--)if(C[u]!==F[d]){if(u!==1||d!==1)do if(u--,d--,0>d||C[u]!==F[d]){var Q=`
`+C[u].replace(" at new "," at ");return n.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",n.displayName)),Q}while(1<=u&&0<=d);break}}}finally{Ja=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?gs(o):""}function Sl(n){switch(n.tag){case 26:case 27:case 5:return gs(n.type);case 16:return gs("Lazy");case 13:return gs("Suspense");case 19:return gs("SuspenseList");case 0:case 15:return Za(n.type,!1);case 11:return Za(n.type.render,!1);case 1:return Za(n.type,!0);case 31:return gs("Activity");default:return""}}function eo(n){try{var r="";do r+=Sl(n),n=n.return;while(n);return r}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function In(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Al(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Cf(n){var r=Al(n)?"checked":"value",o=Object.getOwnPropertyDescriptor(n.constructor.prototype,r),u=""+n[r];if(!n.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var d=o.get,m=o.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return d.call(this)},set:function(E){u=""+E,m.call(this,E)}}),Object.defineProperty(n,r,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(E){u=""+E},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function to(n){n._valueTracker||(n._valueTracker=Cf(n))}function Rl(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),u="";return n&&(u=Al(n)?n.checked?"true":"false":n.value),n=u,n!==o?(r.setValue(n),!0):!1}function na(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var If=/[\n"\\]/g;function Vt(n){return n.replace(If,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function jn(n,r,o,u,d,m,E,w){n.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.type=E:n.removeAttribute("type"),r!=null?E==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+In(r)):n.value!==""+In(r)&&(n.value=""+In(r)):E!=="submit"&&E!=="reset"||n.removeAttribute("value"),r!=null?ir(n,E,In(r)):o!=null?ir(n,E,In(o)):u!=null&&n.removeAttribute("value"),d==null&&m!=null&&(n.defaultChecked=!!m),d!=null&&(n.checked=d&&typeof d!="function"&&typeof d!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?n.name=""+In(w):n.removeAttribute("name")}function ia(n,r,o,u,d,m,E,w){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null))return;o=o!=null?""+In(o):"",r=r!=null?""+In(r):o,w||r===n.value||(n.value=r),n.defaultValue=r}u=u??d,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=w?n.checked:!!u,n.defaultChecked=!!u,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.name=E)}function ir(n,r,o){r==="number"&&na(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function _s(n,r,o,u){if(n=n.options,r){r={};for(var d=0;d<o.length;d++)r["$"+o[d]]=!0;for(o=0;o<n.length;o++)d=r.hasOwnProperty("$"+n[o].value),n[o].selected!==d&&(n[o].selected=d),d&&u&&(n[o].defaultSelected=!0)}else{for(o=""+In(o),r=null,d=0;d<n.length;d++){if(n[d].value===o){n[d].selected=!0,u&&(n[d].defaultSelected=!0);return}r!==null||n[d].disabled||(r=n[d])}r!==null&&(r.selected=!0)}}function lt(n,r,o){if(r!=null&&(r=""+In(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+In(o):""}function sa(n,r,o,u){if(r==null){if(u!=null){if(o!=null)throw Error(s(92));if(oe(u)){if(1<u.length)throw Error(s(93));u=u[0]}o=u}o==null&&(o=""),r=o}o=In(r),n.defaultValue=o,u=n.textContent,u===o&&u!==""&&u!==null&&(n.value=u)}function Jn(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var ra=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ic(n,r,o){var u=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":u?n.setProperty(r,o):typeof o!="number"||o===0||ra.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function Cl(n,r,o){if(r!=null&&typeof r!="object")throw Error(s(62));if(n=n.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var d in r)u=r[d],r.hasOwnProperty(d)&&o[d]!==u&&Ic(n,d,u)}else for(var m in r)r.hasOwnProperty(m)&&Ic(n,m,r[m])}function Il(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function no(n){return Nf.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var ys=null;function Zn(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var vs=null,Es=null;function xl(n){var r=Di(n);if(r&&(n=r.stateNode)){var o=n[Pt]||null;e:switch(n=r.stateNode,r.type){case"input":if(jn(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Vt(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var u=o[r];if(u!==n&&u.form===n.form){var d=u[Pt]||null;if(!d)throw Error(s(90));jn(u,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(r=0;r<o.length;r++)u=o[r],u.form===n.form&&Rl(u)}break e;case"textarea":lt(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&_s(n,!!o.multiple,r,!1)}}}var Mi=!1;function xc(n,r,o){if(Mi)return n(r,o);Mi=!0;try{var u=n(r);return u}finally{if(Mi=!1,(vs!==null||Es!==null)&&(bh(),vs&&(r=vs,n=Es,Es=vs=null,xl(r),n)))for(r=0;r<n.length;r++)xl(n[r])}}function aa(n,r){var o=n.stateNode;if(o===null)return null;var u=o[Pt]||null;if(u===null)return null;o=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(s(231,r,typeof o));return o}var yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ei=!1;if(yi)try{var oa={};Object.defineProperty(oa,"passive",{get:function(){ei=!0}}),window.addEventListener("test",oa,oa),window.removeEventListener("test",oa,oa)}catch{ei=!1}var Pi=null,sr=null,Ts=null;function Nl(){if(Ts)return Ts;var n,r=sr,o=r.length,u,d="value"in Pi?Pi.value:Pi.textContent,m=d.length;for(n=0;n<o&&r[n]===d[n];n++);var E=o-n;for(u=1;u<=E&&r[o-u]===d[m-u];u++);return Ts=d.slice(n,1<u?1-u:void 0)}function Vi(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Li(){return!0}function Dl(){return!1}function Wt(n){function r(o,u,d,m,E){this._reactName=o,this._targetInst=d,this.type=u,this.nativeEvent=m,this.target=E,this.currentTarget=null;for(var w in n)n.hasOwnProperty(w)&&(o=n[w],this[w]=o?o(m):m[w]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Li:Dl,this.isPropagationStopped=Dl,this}return y(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Li)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Li)},persist:function(){},isPersistent:Li}),r}var nt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},io=Wt(nt),la=y({},nt,{view:0,detail:0}),Nc=Wt(la),so,ro,Ui,ua=y({},la,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:da,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ui&&(Ui&&n.type==="mousemove"?(so=n.screenX-Ui.screenX,ro=n.screenY-Ui.screenY):ro=so=0,Ui=n),so)},movementY:function(n){return"movementY"in n?n.movementY:ro}}),ti=Wt(ua),Dc=y({},ua,{dataTransfer:0}),Df=Wt(Dc),ca=y({},la,{relatedTarget:0}),ao=Wt(ca),Ol=y({},nt,{animationName:0,elapsedTime:0,pseudoElement:0}),oo=Wt(Ol),Oc=y({},nt,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),lo=Wt(Oc),Of=y({},nt,{data:0}),kl=Wt(Of),ha={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ml(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Mc[n])?!!r[n]:!1}function da(){return Ml}var Pc=y({},la,{key:function(n){if(n.key){var r=ha[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Vi(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?kc[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:da,charCode:function(n){return n.type==="keypress"?Vi(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Vi(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),uo=Wt(Pc),Vc=y({},ua,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pl=Wt(Vc),bs=y({},la,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:da}),Lc=Wt(bs),Uc=y({},nt,{propertyName:0,elapsedTime:0,pseudoElement:0}),jc=Wt(Uc),Bc=y({},ua,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),co=Wt(Bc),xn=y({},nt,{newState:0,oldState:0}),Fc=Wt(xn),zc=[9,13,27,32],ji=yi&&"CompositionEvent"in window,h=null;yi&&"documentMode"in document&&(h=document.documentMode);var _=yi&&"TextEvent"in window&&!h,v=yi&&(!ji||h&&8<h&&11>=h),A=" ",j=!1;function Y(n,r){switch(n){case"keyup":return zc.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function se(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Qe=!1;function Ht(n,r){switch(n){case"compositionend":return se(r);case"keypress":return r.which!==32?null:(j=!0,A);case"textInput":return n=r.data,n===A&&j?null:n;default:return null}}function $e(n,r){if(Qe)return n==="compositionend"||!ji&&Y(n,r)?(n=Nl(),Ts=sr=Pi=null,Qe=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return v&&r.locale!=="ko"?null:r.data;default:return null}}var Xt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gt(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!Xt[n.type]:r==="textarea"}function ws(n,r,o,u){vs?Es?Es.push(u):Es=[u]:vs=u,r=Ih(r,"onChange"),0<r.length&&(o=new io("onChange","change",null,o,u),n.push({event:o,listeners:r}))}var on=null,Bi=null;function Vl(n){kv(n,0)}function qc(n){var r=Oi(n);if(Rl(r))return n}function e0(n,r){if(n==="change")return r}var t0=!1;if(yi){var kf;if(yi){var Mf="oninput"in document;if(!Mf){var n0=document.createElement("div");n0.setAttribute("oninput","return;"),Mf=typeof n0.oninput=="function"}kf=Mf}else kf=!1;t0=kf&&(!document.documentMode||9<document.documentMode)}function i0(){on&&(on.detachEvent("onpropertychange",s0),Bi=on=null)}function s0(n){if(n.propertyName==="value"&&qc(Bi)){var r=[];ws(r,Bi,n,Zn(n)),xc(Vl,r)}}function AA(n,r,o){n==="focusin"?(i0(),on=r,Bi=o,on.attachEvent("onpropertychange",s0)):n==="focusout"&&i0()}function RA(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return qc(Bi)}function CA(n,r){if(n==="click")return qc(r)}function IA(n,r){if(n==="input"||n==="change")return qc(r)}function xA(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Bn=typeof Object.is=="function"?Object.is:xA;function Ll(n,r){if(Bn(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),u=Object.keys(r);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var d=o[u];if(!rs.call(r,d)||!Bn(n[d],r[d]))return!1}return!0}function r0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function a0(n,r){var o=r0(n);n=0;for(var u;o;){if(o.nodeType===3){if(u=n+o.textContent.length,n<=r&&u>=r)return{node:o,offset:r-n};n=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=r0(o)}}function o0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?o0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function l0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=na(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=na(n.document)}return r}function Pf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var NA=yi&&"documentMode"in document&&11>=document.documentMode,ho=null,Vf=null,Ul=null,Lf=!1;function u0(n,r,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Lf||ho==null||ho!==na(u)||(u=ho,"selectionStart"in u&&Pf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ul&&Ll(Ul,u)||(Ul=u,u=Ih(Vf,"onSelect"),0<u.length&&(r=new io("onSelect","select",null,r,o),n.push({event:r,listeners:u}),r.target=ho)))}function fa(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var fo={animationend:fa("Animation","AnimationEnd"),animationiteration:fa("Animation","AnimationIteration"),animationstart:fa("Animation","AnimationStart"),transitionrun:fa("Transition","TransitionRun"),transitionstart:fa("Transition","TransitionStart"),transitioncancel:fa("Transition","TransitionCancel"),transitionend:fa("Transition","TransitionEnd")},Uf={},c0={};yi&&(c0=document.createElement("div").style,"AnimationEvent"in window||(delete fo.animationend.animation,delete fo.animationiteration.animation,delete fo.animationstart.animation),"TransitionEvent"in window||delete fo.transitionend.transition);function ma(n){if(Uf[n])return Uf[n];if(!fo[n])return n;var r=fo[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in c0)return Uf[n]=r[o];return n}var h0=ma("animationend"),d0=ma("animationiteration"),f0=ma("animationstart"),DA=ma("transitionrun"),OA=ma("transitionstart"),kA=ma("transitioncancel"),m0=ma("transitionend"),p0=new Map,jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jf.push("scrollEnd");function vi(n,r){p0.set(n,r),_i(r,[n])}var g0=new WeakMap;function ni(n,r){if(typeof n=="object"&&n!==null){var o=g0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:eo(r)},g0.set(n,r),r)}return{value:n,source:r,stack:eo(r)}}var ii=[],mo=0,Bf=0;function Hc(){for(var n=mo,r=Bf=mo=0;r<n;){var o=ii[r];ii[r++]=null;var u=ii[r];ii[r++]=null;var d=ii[r];ii[r++]=null;var m=ii[r];if(ii[r++]=null,u!==null&&d!==null){var E=u.pending;E===null?d.next=d:(d.next=E.next,E.next=d),u.pending=d}m!==0&&_0(o,d,m)}}function Gc(n,r,o,u){ii[mo++]=n,ii[mo++]=r,ii[mo++]=o,ii[mo++]=u,Bf|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function Ff(n,r,o,u){return Gc(n,r,o,u),Kc(n)}function po(n,r){return Gc(n,null,null,r),Kc(n)}function _0(n,r,o){n.lanes|=o;var u=n.alternate;u!==null&&(u.lanes|=o);for(var d=!1,m=n.return;m!==null;)m.childLanes|=o,u=m.alternate,u!==null&&(u.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(d=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,d&&r!==null&&(d=31-$t(o),n=m.hiddenUpdates,u=n[d],u===null?n[d]=[r]:u.push(r),r.lane=o|536870912),m):null}function Kc(n){if(50<uu)throw uu=0,Ym=null,Error(s(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var go={};function MA(n,r,o,u){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(n,r,o,u){return new MA(n,r,o,u)}function zf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ss(n,r){var o=n.alternate;return o===null?(o=Fn(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function y0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function Yc(n,r,o,u,d,m){var E=0;if(u=n,typeof n=="function")zf(n)&&(E=1);else if(typeof n=="string")E=VR(n,o,ye.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case I:return n=Fn(31,o,r,d),n.elementType=I,n.lanes=m,n;case k:return pa(o.children,d,m,r);case q:E=8,d|=24;break;case K:return n=Fn(12,o,r,d|2),n.elementType=K,n.lanes=m,n;case be:return n=Fn(13,o,r,d),n.elementType=be,n.lanes=m,n;case Re:return n=Fn(19,o,r,d),n.elementType=Re,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case pe:case ce:E=10;break e;case ae:E=9;break e;case Te:E=11;break e;case M:E=14;break e;case R:E=16,u=null;break e}E=29,o=Error(s(130,n===null?"null":typeof n,"")),u=null}return r=Fn(E,o,r,d),r.elementType=n,r.type=u,r.lanes=m,r}function pa(n,r,o,u){return n=Fn(7,n,u,r),n.lanes=o,n}function qf(n,r,o){return n=Fn(6,n,null,r),n.lanes=o,n}function Hf(n,r,o){return r=Fn(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var _o=[],yo=0,Qc=null,$c=0,si=[],ri=0,ga=null,As=1,Rs="";function _a(n,r){_o[yo++]=$c,_o[yo++]=Qc,Qc=n,$c=r}function v0(n,r,o){si[ri++]=As,si[ri++]=Rs,si[ri++]=ga,ga=n;var u=As;n=Rs;var d=32-$t(u)-1;u&=~(1<<d),o+=1;var m=32-$t(r)+d;if(30<m){var E=d-d%5;m=(u&(1<<E)-1).toString(32),u>>=E,d-=E,As=1<<32-$t(r)+d|o<<d|u,Rs=m+n}else As=1<<m|o<<d|u,Rs=n}function Gf(n){n.return!==null&&(_a(n,1),v0(n,1,0))}function Kf(n){for(;n===Qc;)Qc=_o[--yo],_o[yo]=null,$c=_o[--yo],_o[yo]=null;for(;n===ga;)ga=si[--ri],si[ri]=null,Rs=si[--ri],si[ri]=null,As=si[--ri],si[ri]=null}var Nn=null,Rt=null,tt=!1,ya=null,Fi=!1,Yf=Error(s(519));function va(n){var r=Error(s(418,""));throw Fl(ni(r,n)),Yf}function E0(n){var r=n.stateNode,o=n.type,u=n.memoizedProps;switch(r[qt]=n,r[Pt]=u,o){case"dialog":He("cancel",r),He("close",r);break;case"iframe":case"object":case"embed":He("load",r);break;case"video":case"audio":for(o=0;o<hu.length;o++)He(hu[o],r);break;case"source":He("error",r);break;case"img":case"image":case"link":He("error",r),He("load",r);break;case"details":He("toggle",r);break;case"input":He("invalid",r),ia(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),to(r);break;case"select":He("invalid",r);break;case"textarea":He("invalid",r),sa(r,u.value,u.defaultValue,u.children),to(r)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||u.suppressHydrationWarning===!0||Lv(r.textContent,o)?(u.popover!=null&&(He("beforetoggle",r),He("toggle",r)),u.onScroll!=null&&He("scroll",r),u.onScrollEnd!=null&&He("scrollend",r),u.onClick!=null&&(r.onclick=xh),r=!0):r=!1,r||va(n)}function T0(n){for(Nn=n.return;Nn;)switch(Nn.tag){case 5:case 13:Fi=!1;return;case 27:case 3:Fi=!0;return;default:Nn=Nn.return}}function jl(n){if(n!==Nn)return!1;if(!tt)return T0(n),tt=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||up(n.type,n.memoizedProps)),o=!o),o&&Rt&&va(n),T0(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(317));e:{for(n=n.nextSibling,r=0;n;){if(n.nodeType===8)if(o=n.data,o==="/$"){if(r===0){Rt=Ti(n.nextSibling);break e}r--}else o!=="$"&&o!=="$!"&&o!=="$?"||r++;n=n.nextSibling}Rt=null}}else r===27?(r=Rt,Er(n.type)?(n=fp,fp=null,Rt=n):Rt=r):Rt=Nn?Ti(n.stateNode.nextSibling):null;return!0}function Bl(){Rt=Nn=null,tt=!1}function b0(){var n=ya;return n!==null&&(kn===null?kn=n:kn.push.apply(kn,n),ya=null),n}function Fl(n){ya===null?ya=[n]:ya.push(n)}var Qf=X(null),Ea=null,Cs=null;function rr(n,r,o){ne(Qf,r._currentValue),r._currentValue=o}function Is(n){n._currentValue=Qf.current,re(Qf)}function $f(n,r,o){for(;n!==null;){var u=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),n===o)break;n=n.return}}function Wf(n,r,o,u){var d=n.child;for(d!==null&&(d.return=n);d!==null;){var m=d.dependencies;if(m!==null){var E=d.child;m=m.firstContext;e:for(;m!==null;){var w=m;m=d;for(var C=0;C<r.length;C++)if(w.context===r[C]){m.lanes|=o,w=m.alternate,w!==null&&(w.lanes|=o),$f(m.return,o,n),u||(E=null);break e}m=w.next}}else if(d.tag===18){if(E=d.return,E===null)throw Error(s(341));E.lanes|=o,m=E.alternate,m!==null&&(m.lanes|=o),$f(E,o,n),E=null}else E=d.child;if(E!==null)E.return=d;else for(E=d;E!==null;){if(E===n){E=null;break}if(d=E.sibling,d!==null){d.return=E.return,E=d;break}E=E.return}d=E}}function zl(n,r,o,u){n=null;for(var d=r,m=!1;d!==null;){if(!m){if((d.flags&524288)!==0)m=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var E=d.alternate;if(E===null)throw Error(s(387));if(E=E.memoizedProps,E!==null){var w=d.type;Bn(d.pendingProps.value,E.value)||(n!==null?n.push(w):n=[w])}}else if(d===Mt.current){if(E=d.alternate,E===null)throw Error(s(387));E.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(n!==null?n.push(_u):n=[_u])}d=d.return}n!==null&&Wf(r,n,o,u),r.flags|=262144}function Wc(n){for(n=n.firstContext;n!==null;){if(!Bn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ta(n){Ea=n,Cs=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function pn(n){return w0(Ea,n)}function Xc(n,r){return Ea===null&&Ta(n),w0(n,r)}function w0(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Cs===null){if(n===null)throw Error(s(308));Cs=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else Cs=Cs.next=r;return o}var PA=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,u){n.push(u)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},VA=i.unstable_scheduleCallback,LA=i.unstable_NormalPriority,Kt={$$typeof:ce,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xf(){return{controller:new PA,data:new Map,refCount:0}}function ql(n){n.refCount--,n.refCount===0&&VA(LA,function(){n.controller.abort()})}var Hl=null,Jf=0,vo=0,Eo=null;function UA(n,r){if(Hl===null){var o=Hl=[];Jf=0,vo=ep(),Eo={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Jf++,r.then(S0,S0),r}function S0(){if(--Jf===0&&Hl!==null){Eo!==null&&(Eo.status="fulfilled");var n=Hl;Hl=null,vo=0,Eo=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function jA(n,r){var o=[],u={status:"pending",value:null,reason:null,then:function(d){o.push(d)}};return n.then(function(){u.status="fulfilled",u.value=r;for(var d=0;d<o.length;d++)(0,o[d])(r)},function(d){for(u.status="rejected",u.reason=d,d=0;d<o.length;d++)(0,o[d])(void 0)}),u}var A0=z.S;z.S=function(n,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&UA(n,r),A0!==null&&A0(n,r)};var ba=X(null);function Zf(){var n=ba.current;return n!==null?n:mt.pooledCache}function Jc(n,r){r===null?ne(ba,ba.current):ne(ba,r.pool)}function R0(){var n=Zf();return n===null?null:{parent:Kt._currentValue,pool:n}}var Gl=Error(s(460)),C0=Error(s(474)),Zc=Error(s(542)),em={then:function(){}};function I0(n){return n=n.status,n==="fulfilled"||n==="rejected"}function eh(){}function x0(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(eh,eh),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,D0(n),n;default:if(typeof r.status=="string")r.then(eh,eh);else{if(n=mt,n!==null&&100<n.shellSuspendCounter)throw Error(s(482));n=r,n.status="pending",n.then(function(u){if(r.status==="pending"){var d=r;d.status="fulfilled",d.value=u}},function(u){if(r.status==="pending"){var d=r;d.status="rejected",d.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,D0(n),n}throw Kl=r,Gl}}var Kl=null;function N0(){if(Kl===null)throw Error(s(459));var n=Kl;return Kl=null,n}function D0(n){if(n===Gl||n===Zc)throw Error(s(483))}var ar=!1;function tm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function or(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function lr(n,r,o){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(rt&2)!==0){var d=u.pending;return d===null?r.next=r:(r.next=d.next,d.next=r),u.pending=r,r=Kc(n),_0(n,null,o),r}return Gc(n,u,r,o),Kc(n)}function Yl(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var u=r.lanes;u&=n.pendingLanes,o|=u,r.lanes=o,zt(n,o)}}function im(n,r){var o=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var d=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?d=m=E:m=m.next=E,o=o.next}while(o!==null);m===null?d=m=r:m=m.next=r}else d=m=r;o={baseState:u.baseState,firstBaseUpdate:d,lastBaseUpdate:m,shared:u.shared,callbacks:u.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var sm=!1;function Ql(){if(sm){var n=Eo;if(n!==null)throw n}}function $l(n,r,o,u){sm=!1;var d=n.updateQueue;ar=!1;var m=d.firstBaseUpdate,E=d.lastBaseUpdate,w=d.shared.pending;if(w!==null){d.shared.pending=null;var C=w,F=C.next;C.next=null,E===null?m=F:E.next=F,E=C;var Q=n.alternate;Q!==null&&(Q=Q.updateQueue,w=Q.lastBaseUpdate,w!==E&&(w===null?Q.firstBaseUpdate=F:w.next=F,Q.lastBaseUpdate=C))}if(m!==null){var J=d.baseState;E=0,Q=F=C=null,w=m;do{var H=w.lane&-536870913,G=H!==w.lane;if(G?(We&H)===H:(u&H)===H){H!==0&&H===vo&&(sm=!0),Q!==null&&(Q=Q.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var De=n,Ae=w;H=r;var ht=o;switch(Ae.tag){case 1:if(De=Ae.payload,typeof De=="function"){J=De.call(ht,J,H);break e}J=De;break e;case 3:De.flags=De.flags&-65537|128;case 0:if(De=Ae.payload,H=typeof De=="function"?De.call(ht,J,H):De,H==null)break e;J=y({},J,H);break e;case 2:ar=!0}}H=w.callback,H!==null&&(n.flags|=64,G&&(n.flags|=8192),G=d.callbacks,G===null?d.callbacks=[H]:G.push(H))}else G={lane:H,tag:w.tag,payload:w.payload,callback:w.callback,next:null},Q===null?(F=Q=G,C=J):Q=Q.next=G,E|=H;if(w=w.next,w===null){if(w=d.shared.pending,w===null)break;G=w,w=G.next,G.next=null,d.lastBaseUpdate=G,d.shared.pending=null}}while(!0);Q===null&&(C=J),d.baseState=C,d.firstBaseUpdate=F,d.lastBaseUpdate=Q,m===null&&(d.shared.lanes=0),gr|=E,n.lanes=E,n.memoizedState=J}}function O0(n,r){if(typeof n!="function")throw Error(s(191,n));n.call(r)}function k0(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)O0(o[n],r)}var To=X(null),th=X(0);function M0(n,r){n=Ps,ne(th,n),ne(To,r),Ps=n|r.baseLanes}function rm(){ne(th,Ps),ne(To,To.current)}function am(){Ps=th.current,re(To),re(th)}var ur=0,Ue=null,ut=null,Lt=null,nh=!1,bo=!1,wa=!1,ih=0,Wl=0,wo=null,BA=0;function Dt(){throw Error(s(321))}function om(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!Bn(n[o],r[o]))return!1;return!0}function lm(n,r,o,u,d,m){return ur=m,Ue=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,z.H=n===null||n.memoizedState===null?_y:yy,wa=!1,m=o(u,d),wa=!1,bo&&(m=V0(r,o,u,d)),P0(n),m}function P0(n){z.H=uh;var r=ut!==null&&ut.next!==null;if(ur=0,Lt=ut=Ue=null,nh=!1,Wl=0,wo=null,r)throw Error(s(300));n===null||Jt||(n=n.dependencies,n!==null&&Wc(n)&&(Jt=!0))}function V0(n,r,o,u){Ue=n;var d=0;do{if(bo&&(wo=null),Wl=0,bo=!1,25<=d)throw Error(s(301));if(d+=1,Lt=ut=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}z.H=YA,m=r(o,u)}while(bo);return m}function FA(){var n=z.H,r=n.useState()[0];return r=typeof r.then=="function"?Xl(r):r,n=n.useState()[0],(ut!==null?ut.memoizedState:null)!==n&&(Ue.flags|=1024),r}function um(){var n=ih!==0;return ih=0,n}function cm(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function hm(n){if(nh){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}nh=!1}ur=0,Lt=ut=Ue=null,bo=!1,Wl=ih=0,wo=null}function Dn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lt===null?Ue.memoizedState=Lt=n:Lt=Lt.next=n,Lt}function Ut(){if(ut===null){var n=Ue.alternate;n=n!==null?n.memoizedState:null}else n=ut.next;var r=Lt===null?Ue.memoizedState:Lt.next;if(r!==null)Lt=r,ut=n;else{if(n===null)throw Ue.alternate===null?Error(s(467)):Error(s(310));ut=n,n={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},Lt===null?Ue.memoizedState=Lt=n:Lt=Lt.next=n}return Lt}function dm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xl(n){var r=Wl;return Wl+=1,wo===null&&(wo=[]),n=x0(wo,n,r),r=Ue,(Lt===null?r.memoizedState:Lt.next)===null&&(r=r.alternate,z.H=r===null||r.memoizedState===null?_y:yy),n}function sh(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Xl(n);if(n.$$typeof===ce)return pn(n)}throw Error(s(438,String(n)))}function fm(n){var r=null,o=Ue.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var u=Ue.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(d){return d.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=dm(),Ue.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),u=0;u<n;u++)o[u]=D;return r.index++,o}function xs(n,r){return typeof r=="function"?r(n):r}function rh(n){var r=Ut();return mm(r,ut,n)}function mm(n,r,o){var u=n.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=o;var d=n.baseQueue,m=u.pending;if(m!==null){if(d!==null){var E=d.next;d.next=m.next,m.next=E}r.baseQueue=d=m,u.pending=null}if(m=n.baseState,d===null)n.memoizedState=m;else{r=d.next;var w=E=null,C=null,F=r,Q=!1;do{var J=F.lane&-536870913;if(J!==F.lane?(We&J)===J:(ur&J)===J){var H=F.revertLane;if(H===0)C!==null&&(C=C.next={lane:0,revertLane:0,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),J===vo&&(Q=!0);else if((ur&H)===H){F=F.next,H===vo&&(Q=!0);continue}else J={lane:0,revertLane:F.revertLane,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},C===null?(w=C=J,E=m):C=C.next=J,Ue.lanes|=H,gr|=H;J=F.action,wa&&o(m,J),m=F.hasEagerState?F.eagerState:o(m,J)}else H={lane:J,revertLane:F.revertLane,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},C===null?(w=C=H,E=m):C=C.next=H,Ue.lanes|=J,gr|=J;F=F.next}while(F!==null&&F!==r);if(C===null?E=m:C.next=w,!Bn(m,n.memoizedState)&&(Jt=!0,Q&&(o=Eo,o!==null)))throw o;n.memoizedState=m,n.baseState=E,n.baseQueue=C,u.lastRenderedState=m}return d===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function pm(n){var r=Ut(),o=r.queue;if(o===null)throw Error(s(311));o.lastRenderedReducer=n;var u=o.dispatch,d=o.pending,m=r.memoizedState;if(d!==null){o.pending=null;var E=d=d.next;do m=n(m,E.action),E=E.next;while(E!==d);Bn(m,r.memoizedState)||(Jt=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,u]}function L0(n,r,o){var u=Ue,d=Ut(),m=tt;if(m){if(o===void 0)throw Error(s(407));o=o()}else o=r();var E=!Bn((ut||d).memoizedState,o);E&&(d.memoizedState=o,Jt=!0),d=d.queue;var w=B0.bind(null,u,d,n);if(Jl(2048,8,w,[n]),d.getSnapshot!==r||E||Lt!==null&&Lt.memoizedState.tag&1){if(u.flags|=2048,So(9,ah(),j0.bind(null,u,d,o,r),null),mt===null)throw Error(s(349));m||(ur&124)!==0||U0(u,r,o)}return o}function U0(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Ue.updateQueue,r===null?(r=dm(),Ue.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function j0(n,r,o,u){r.value=o,r.getSnapshot=u,F0(r)&&z0(n)}function B0(n,r,o){return o(function(){F0(r)&&z0(n)})}function F0(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!Bn(n,o)}catch{return!0}}function z0(n){var r=po(n,2);r!==null&&Kn(r,n,2)}function gm(n){var r=Dn();if(typeof n=="function"){var o=n;if(n=o(),wa){Rn(!0);try{o()}finally{Rn(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:n},r}function q0(n,r,o,u){return n.baseState=o,mm(n,ut,typeof u=="function"?u:xs)}function zA(n,r,o,u,d){if(lh(n))throw Error(s(485));if(n=r.action,n!==null){var m={payload:d,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){m.listeners.push(E)}};z.T!==null?o(!0):m.isTransition=!1,u(m),o=r.pending,o===null?(m.next=r.pending=m,H0(r,m)):(m.next=o.next,r.pending=o.next=m)}}function H0(n,r){var o=r.action,u=r.payload,d=n.state;if(r.isTransition){var m=z.T,E={};z.T=E;try{var w=o(d,u),C=z.S;C!==null&&C(E,w),G0(n,r,w)}catch(F){_m(n,r,F)}finally{z.T=m}}else try{m=o(d,u),G0(n,r,m)}catch(F){_m(n,r,F)}}function G0(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){K0(n,r,u)},function(u){return _m(n,r,u)}):K0(n,r,o)}function K0(n,r,o){r.status="fulfilled",r.value=o,Y0(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,H0(n,o)))}function _m(n,r,o){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=o,Y0(r),r=r.next;while(r!==u)}n.action=null}function Y0(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function Q0(n,r){return r}function $0(n,r){if(tt){var o=mt.formState;if(o!==null){e:{var u=Ue;if(tt){if(Rt){t:{for(var d=Rt,m=Fi;d.nodeType!==8;){if(!m){d=null;break t}if(d=Ti(d.nextSibling),d===null){d=null;break t}}m=d.data,d=m==="F!"||m==="F"?d:null}if(d){Rt=Ti(d.nextSibling),u=d.data==="F!";break e}}va(u)}u=!1}u&&(r=o[0])}}return o=Dn(),o.memoizedState=o.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q0,lastRenderedState:r},o.queue=u,o=my.bind(null,Ue,u),u.dispatch=o,u=gm(!1),m=bm.bind(null,Ue,!1,u.queue),u=Dn(),d={state:r,dispatch:null,action:n,pending:null},u.queue=d,o=zA.bind(null,Ue,d,m,o),d.dispatch=o,u.memoizedState=n,[r,o,!1]}function W0(n){var r=Ut();return X0(r,ut,n)}function X0(n,r,o){if(r=mm(n,r,Q0)[0],n=rh(xs)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=Xl(r)}catch(E){throw E===Gl?Zc:E}else u=r;r=Ut();var d=r.queue,m=d.dispatch;return o!==r.memoizedState&&(Ue.flags|=2048,So(9,ah(),qA.bind(null,d,o),null)),[u,m,n]}function qA(n,r){n.action=r}function J0(n){var r=Ut(),o=ut;if(o!==null)return X0(r,o,n);Ut(),r=r.memoizedState,o=Ut();var u=o.queue.dispatch;return o.memoizedState=n,[r,u,!1]}function So(n,r,o,u){return n={tag:n,create:o,deps:u,inst:r,next:null},r=Ue.updateQueue,r===null&&(r=dm(),Ue.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(u=o.next,o.next=n,n.next=u,r.lastEffect=n),n}function ah(){return{destroy:void 0,resource:void 0}}function Z0(){return Ut().memoizedState}function oh(n,r,o,u){var d=Dn();u=u===void 0?null:u,Ue.flags|=n,d.memoizedState=So(1|r,ah(),o,u)}function Jl(n,r,o,u){var d=Ut();u=u===void 0?null:u;var m=d.memoizedState.inst;ut!==null&&u!==null&&om(u,ut.memoizedState.deps)?d.memoizedState=So(r,m,o,u):(Ue.flags|=n,d.memoizedState=So(1|r,m,o,u))}function ey(n,r){oh(8390656,8,n,r)}function ty(n,r){Jl(2048,8,n,r)}function ny(n,r){return Jl(4,2,n,r)}function iy(n,r){return Jl(4,4,n,r)}function sy(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function ry(n,r,o){o=o!=null?o.concat([n]):null,Jl(4,4,sy.bind(null,r,n),o)}function ym(){}function ay(n,r){var o=Ut();r=r===void 0?null:r;var u=o.memoizedState;return r!==null&&om(r,u[1])?u[0]:(o.memoizedState=[n,r],n)}function oy(n,r){var o=Ut();r=r===void 0?null:r;var u=o.memoizedState;if(r!==null&&om(r,u[1]))return u[0];if(u=n(),wa){Rn(!0);try{n()}finally{Rn(!1)}}return o.memoizedState=[u,r],u}function vm(n,r,o){return o===void 0||(ur&1073741824)!==0?n.memoizedState=r:(n.memoizedState=o,n=cv(),Ue.lanes|=n,gr|=n,o)}function ly(n,r,o,u){return Bn(o,r)?o:To.current!==null?(n=vm(n,o,u),Bn(n,r)||(Jt=!0),n):(ur&42)===0?(Jt=!0,n.memoizedState=o):(n=cv(),Ue.lanes|=n,gr|=n,r)}function uy(n,r,o,u,d){var m=te.p;te.p=m!==0&&8>m?m:8;var E=z.T,w={};z.T=w,bm(n,!1,r,o);try{var C=d(),F=z.S;if(F!==null&&F(w,C),C!==null&&typeof C=="object"&&typeof C.then=="function"){var Q=jA(C,u);Zl(n,r,Q,Gn(n))}else Zl(n,r,u,Gn(n))}catch(J){Zl(n,r,{then:function(){},status:"rejected",reason:J},Gn())}finally{te.p=m,z.T=E}}function HA(){}function Em(n,r,o,u){if(n.tag!==5)throw Error(s(476));var d=cy(n).queue;uy(n,d,r,Z,o===null?HA:function(){return hy(n),o(u)})}function cy(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:Z},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function hy(n){var r=cy(n).next.queue;Zl(n,r,{},Gn())}function Tm(){return pn(_u)}function dy(){return Ut().memoizedState}function fy(){return Ut().memoizedState}function GA(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Gn();n=or(o);var u=lr(r,n,o);u!==null&&(Kn(u,r,o),Yl(u,r,o)),r={cache:Xf()},n.payload=r;return}r=r.return}}function KA(n,r,o){var u=Gn();o={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},lh(n)?py(r,o):(o=Ff(n,r,o,u),o!==null&&(Kn(o,n,u),gy(o,r,u)))}function my(n,r,o){var u=Gn();Zl(n,r,o,u)}function Zl(n,r,o,u){var d={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(lh(n))py(r,d);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var E=r.lastRenderedState,w=m(E,o);if(d.hasEagerState=!0,d.eagerState=w,Bn(w,E))return Gc(n,r,d,0),mt===null&&Hc(),!1}catch{}finally{}if(o=Ff(n,r,d,u),o!==null)return Kn(o,n,u),gy(o,r,u),!0}return!1}function bm(n,r,o,u){if(u={lane:2,revertLane:ep(),action:u,hasEagerState:!1,eagerState:null,next:null},lh(n)){if(r)throw Error(s(479))}else r=Ff(n,o,u,2),r!==null&&Kn(r,n,2)}function lh(n){var r=n.alternate;return n===Ue||r!==null&&r===Ue}function py(n,r){bo=nh=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function gy(n,r,o){if((o&4194048)!==0){var u=r.lanes;u&=n.pendingLanes,o|=u,r.lanes=o,zt(n,o)}}var uh={readContext:pn,use:sh,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useLayoutEffect:Dt,useInsertionEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useSyncExternalStore:Dt,useId:Dt,useHostTransitionStatus:Dt,useFormState:Dt,useActionState:Dt,useOptimistic:Dt,useMemoCache:Dt,useCacheRefresh:Dt},_y={readContext:pn,use:sh,useCallback:function(n,r){return Dn().memoizedState=[n,r===void 0?null:r],n},useContext:pn,useEffect:ey,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,oh(4194308,4,sy.bind(null,r,n),o)},useLayoutEffect:function(n,r){return oh(4194308,4,n,r)},useInsertionEffect:function(n,r){oh(4,2,n,r)},useMemo:function(n,r){var o=Dn();r=r===void 0?null:r;var u=n();if(wa){Rn(!0);try{n()}finally{Rn(!1)}}return o.memoizedState=[u,r],u},useReducer:function(n,r,o){var u=Dn();if(o!==void 0){var d=o(r);if(wa){Rn(!0);try{o(r)}finally{Rn(!1)}}}else d=r;return u.memoizedState=u.baseState=d,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:d},u.queue=n,n=n.dispatch=KA.bind(null,Ue,n),[u.memoizedState,n]},useRef:function(n){var r=Dn();return n={current:n},r.memoizedState=n},useState:function(n){n=gm(n);var r=n.queue,o=my.bind(null,Ue,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:ym,useDeferredValue:function(n,r){var o=Dn();return vm(o,n,r)},useTransition:function(){var n=gm(!1);return n=uy.bind(null,Ue,n.queue,!0,!1),Dn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var u=Ue,d=Dn();if(tt){if(o===void 0)throw Error(s(407));o=o()}else{if(o=r(),mt===null)throw Error(s(349));(We&124)!==0||U0(u,r,o)}d.memoizedState=o;var m={value:o,getSnapshot:r};return d.queue=m,ey(B0.bind(null,u,m,n),[n]),u.flags|=2048,So(9,ah(),j0.bind(null,u,m,o,r),null),o},useId:function(){var n=Dn(),r=mt.identifierPrefix;if(tt){var o=Rs,u=As;o=(u&~(1<<32-$t(u)-1)).toString(32)+o,r="«"+r+"R"+o,o=ih++,0<o&&(r+="H"+o.toString(32)),r+="»"}else o=BA++,r="«"+r+"r"+o.toString(32)+"»";return n.memoizedState=r},useHostTransitionStatus:Tm,useFormState:$0,useActionState:$0,useOptimistic:function(n){var r=Dn();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=bm.bind(null,Ue,!0,o),o.dispatch=r,[n,r]},useMemoCache:fm,useCacheRefresh:function(){return Dn().memoizedState=GA.bind(null,Ue)}},yy={readContext:pn,use:sh,useCallback:ay,useContext:pn,useEffect:ty,useImperativeHandle:ry,useInsertionEffect:ny,useLayoutEffect:iy,useMemo:oy,useReducer:rh,useRef:Z0,useState:function(){return rh(xs)},useDebugValue:ym,useDeferredValue:function(n,r){var o=Ut();return ly(o,ut.memoizedState,n,r)},useTransition:function(){var n=rh(xs)[0],r=Ut().memoizedState;return[typeof n=="boolean"?n:Xl(n),r]},useSyncExternalStore:L0,useId:dy,useHostTransitionStatus:Tm,useFormState:W0,useActionState:W0,useOptimistic:function(n,r){var o=Ut();return q0(o,ut,n,r)},useMemoCache:fm,useCacheRefresh:fy},YA={readContext:pn,use:sh,useCallback:ay,useContext:pn,useEffect:ty,useImperativeHandle:ry,useInsertionEffect:ny,useLayoutEffect:iy,useMemo:oy,useReducer:pm,useRef:Z0,useState:function(){return pm(xs)},useDebugValue:ym,useDeferredValue:function(n,r){var o=Ut();return ut===null?vm(o,n,r):ly(o,ut.memoizedState,n,r)},useTransition:function(){var n=pm(xs)[0],r=Ut().memoizedState;return[typeof n=="boolean"?n:Xl(n),r]},useSyncExternalStore:L0,useId:dy,useHostTransitionStatus:Tm,useFormState:J0,useActionState:J0,useOptimistic:function(n,r){var o=Ut();return ut!==null?q0(o,ut,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:fm,useCacheRefresh:fy},Ao=null,eu=0;function ch(n){var r=eu;return eu+=1,Ao===null&&(Ao=[]),x0(Ao,n,r)}function tu(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function hh(n,r){throw r.$$typeof===b?Error(s(525)):(n=Object.prototype.toString.call(r),Error(s(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function vy(n){var r=n._init;return r(n._payload)}function Ey(n){function r(U,O){if(n){var B=U.deletions;B===null?(U.deletions=[O],U.flags|=16):B.push(O)}}function o(U,O){if(!n)return null;for(;O!==null;)r(U,O),O=O.sibling;return null}function u(U){for(var O=new Map;U!==null;)U.key!==null?O.set(U.key,U):O.set(U.index,U),U=U.sibling;return O}function d(U,O){return U=Ss(U,O),U.index=0,U.sibling=null,U}function m(U,O,B){return U.index=B,n?(B=U.alternate,B!==null?(B=B.index,B<O?(U.flags|=67108866,O):B):(U.flags|=67108866,O)):(U.flags|=1048576,O)}function E(U){return n&&U.alternate===null&&(U.flags|=67108866),U}function w(U,O,B,$){return O===null||O.tag!==6?(O=qf(B,U.mode,$),O.return=U,O):(O=d(O,B),O.return=U,O)}function C(U,O,B,$){var _e=B.type;return _e===k?Q(U,O,B.props.children,$,B.key):O!==null&&(O.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===R&&vy(_e)===O.type)?(O=d(O,B.props),tu(O,B),O.return=U,O):(O=Yc(B.type,B.key,B.props,null,U.mode,$),tu(O,B),O.return=U,O)}function F(U,O,B,$){return O===null||O.tag!==4||O.stateNode.containerInfo!==B.containerInfo||O.stateNode.implementation!==B.implementation?(O=Hf(B,U.mode,$),O.return=U,O):(O=d(O,B.children||[]),O.return=U,O)}function Q(U,O,B,$,_e){return O===null||O.tag!==7?(O=pa(B,U.mode,$,_e),O.return=U,O):(O=d(O,B),O.return=U,O)}function J(U,O,B){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=qf(""+O,U.mode,B),O.return=U,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case S:return B=Yc(O.type,O.key,O.props,null,U.mode,B),tu(B,O),B.return=U,B;case P:return O=Hf(O,U.mode,B),O.return=U,O;case R:var $=O._init;return O=$(O._payload),J(U,O,B)}if(oe(O)||L(O))return O=pa(O,U.mode,B,null),O.return=U,O;if(typeof O.then=="function")return J(U,ch(O),B);if(O.$$typeof===ce)return J(U,Xc(U,O),B);hh(U,O)}return null}function H(U,O,B,$){var _e=O!==null?O.key:null;if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return _e!==null?null:w(U,O,""+B,$);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case S:return B.key===_e?C(U,O,B,$):null;case P:return B.key===_e?F(U,O,B,$):null;case R:return _e=B._init,B=_e(B._payload),H(U,O,B,$)}if(oe(B)||L(B))return _e!==null?null:Q(U,O,B,$,null);if(typeof B.then=="function")return H(U,O,ch(B),$);if(B.$$typeof===ce)return H(U,O,Xc(U,B),$);hh(U,B)}return null}function G(U,O,B,$,_e){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return U=U.get(B)||null,w(O,U,""+$,_e);if(typeof $=="object"&&$!==null){switch($.$$typeof){case S:return U=U.get($.key===null?B:$.key)||null,C(O,U,$,_e);case P:return U=U.get($.key===null?B:$.key)||null,F(O,U,$,_e);case R:var Be=$._init;return $=Be($._payload),G(U,O,B,$,_e)}if(oe($)||L($))return U=U.get(B)||null,Q(O,U,$,_e,null);if(typeof $.then=="function")return G(U,O,B,ch($),_e);if($.$$typeof===ce)return G(U,O,B,Xc(O,$),_e);hh(O,$)}return null}function De(U,O,B,$){for(var _e=null,Be=null,ve=O,Ce=O=0,en=null;ve!==null&&Ce<B.length;Ce++){ve.index>Ce?(en=ve,ve=null):en=ve.sibling;var et=H(U,ve,B[Ce],$);if(et===null){ve===null&&(ve=en);break}n&&ve&&et.alternate===null&&r(U,ve),O=m(et,O,Ce),Be===null?_e=et:Be.sibling=et,Be=et,ve=en}if(Ce===B.length)return o(U,ve),tt&&_a(U,Ce),_e;if(ve===null){for(;Ce<B.length;Ce++)ve=J(U,B[Ce],$),ve!==null&&(O=m(ve,O,Ce),Be===null?_e=ve:Be.sibling=ve,Be=ve);return tt&&_a(U,Ce),_e}for(ve=u(ve);Ce<B.length;Ce++)en=G(ve,U,Ce,B[Ce],$),en!==null&&(n&&en.alternate!==null&&ve.delete(en.key===null?Ce:en.key),O=m(en,O,Ce),Be===null?_e=en:Be.sibling=en,Be=en);return n&&ve.forEach(function(Ar){return r(U,Ar)}),tt&&_a(U,Ce),_e}function Ae(U,O,B,$){if(B==null)throw Error(s(151));for(var _e=null,Be=null,ve=O,Ce=O=0,en=null,et=B.next();ve!==null&&!et.done;Ce++,et=B.next()){ve.index>Ce?(en=ve,ve=null):en=ve.sibling;var Ar=H(U,ve,et.value,$);if(Ar===null){ve===null&&(ve=en);break}n&&ve&&Ar.alternate===null&&r(U,ve),O=m(Ar,O,Ce),Be===null?_e=Ar:Be.sibling=Ar,Be=Ar,ve=en}if(et.done)return o(U,ve),tt&&_a(U,Ce),_e;if(ve===null){for(;!et.done;Ce++,et=B.next())et=J(U,et.value,$),et!==null&&(O=m(et,O,Ce),Be===null?_e=et:Be.sibling=et,Be=et);return tt&&_a(U,Ce),_e}for(ve=u(ve);!et.done;Ce++,et=B.next())et=G(ve,U,Ce,et.value,$),et!==null&&(n&&et.alternate!==null&&ve.delete(et.key===null?Ce:et.key),O=m(et,O,Ce),Be===null?_e=et:Be.sibling=et,Be=et);return n&&ve.forEach(function(QR){return r(U,QR)}),tt&&_a(U,Ce),_e}function ht(U,O,B,$){if(typeof B=="object"&&B!==null&&B.type===k&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case S:e:{for(var _e=B.key;O!==null;){if(O.key===_e){if(_e=B.type,_e===k){if(O.tag===7){o(U,O.sibling),$=d(O,B.props.children),$.return=U,U=$;break e}}else if(O.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===R&&vy(_e)===O.type){o(U,O.sibling),$=d(O,B.props),tu($,B),$.return=U,U=$;break e}o(U,O);break}else r(U,O);O=O.sibling}B.type===k?($=pa(B.props.children,U.mode,$,B.key),$.return=U,U=$):($=Yc(B.type,B.key,B.props,null,U.mode,$),tu($,B),$.return=U,U=$)}return E(U);case P:e:{for(_e=B.key;O!==null;){if(O.key===_e)if(O.tag===4&&O.stateNode.containerInfo===B.containerInfo&&O.stateNode.implementation===B.implementation){o(U,O.sibling),$=d(O,B.children||[]),$.return=U,U=$;break e}else{o(U,O);break}else r(U,O);O=O.sibling}$=Hf(B,U.mode,$),$.return=U,U=$}return E(U);case R:return _e=B._init,B=_e(B._payload),ht(U,O,B,$)}if(oe(B))return De(U,O,B,$);if(L(B)){if(_e=L(B),typeof _e!="function")throw Error(s(150));return B=_e.call(B),Ae(U,O,B,$)}if(typeof B.then=="function")return ht(U,O,ch(B),$);if(B.$$typeof===ce)return ht(U,O,Xc(U,B),$);hh(U,B)}return typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint"?(B=""+B,O!==null&&O.tag===6?(o(U,O.sibling),$=d(O,B),$.return=U,U=$):(o(U,O),$=qf(B,U.mode,$),$.return=U,U=$),E(U)):o(U,O)}return function(U,O,B,$){try{eu=0;var _e=ht(U,O,B,$);return Ao=null,_e}catch(ve){if(ve===Gl||ve===Zc)throw ve;var Be=Fn(29,ve,null,U.mode);return Be.lanes=$,Be.return=U,Be}finally{}}}var Ro=Ey(!0),Ty=Ey(!1),ai=X(null),zi=null;function cr(n){var r=n.alternate;ne(Yt,Yt.current&1),ne(ai,n),zi===null&&(r===null||To.current!==null||r.memoizedState!==null)&&(zi=n)}function by(n){if(n.tag===22){if(ne(Yt,Yt.current),ne(ai,n),zi===null){var r=n.alternate;r!==null&&r.memoizedState!==null&&(zi=n)}}else hr()}function hr(){ne(Yt,Yt.current),ne(ai,ai.current)}function Ns(n){re(ai),zi===n&&(zi=null),re(Yt)}var Yt=X(0);function dh(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||dp(o)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function wm(n,r,o,u){r=n.memoizedState,o=o(u,r),o=o==null?r:y({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Sm={enqueueSetState:function(n,r,o){n=n._reactInternals;var u=Gn(),d=or(u);d.payload=r,o!=null&&(d.callback=o),r=lr(n,d,u),r!==null&&(Kn(r,n,u),Yl(r,n,u))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var u=Gn(),d=or(u);d.tag=1,d.payload=r,o!=null&&(d.callback=o),r=lr(n,d,u),r!==null&&(Kn(r,n,u),Yl(r,n,u))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Gn(),u=or(o);u.tag=2,r!=null&&(u.callback=r),r=lr(n,u,o),r!==null&&(Kn(r,n,o),Yl(r,n,o))}};function wy(n,r,o,u,d,m,E){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,m,E):r.prototype&&r.prototype.isPureReactComponent?!Ll(o,u)||!Ll(d,m):!0}function Sy(n,r,o,u){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,u),r.state!==n&&Sm.enqueueReplaceState(r,r.state,null)}function Sa(n,r){var o=r;if("ref"in r){o={};for(var u in r)u!=="ref"&&(o[u]=r[u])}if(n=n.defaultProps){o===r&&(o=y({},o));for(var d in n)o[d]===void 0&&(o[d]=n[d])}return o}var fh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function Ay(n){fh(n)}function Ry(n){console.error(n)}function Cy(n){fh(n)}function mh(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function Iy(n,r,o){try{var u=n.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Am(n,r,o){return o=or(o),o.tag=3,o.payload={element:null},o.callback=function(){mh(n,r)},o}function xy(n){return n=or(n),n.tag=3,n}function Ny(n,r,o,u){var d=o.type.getDerivedStateFromError;if(typeof d=="function"){var m=u.value;n.payload=function(){return d(m)},n.callback=function(){Iy(r,o,u)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(n.callback=function(){Iy(r,o,u),typeof d!="function"&&(_r===null?_r=new Set([this]):_r.add(this));var w=u.stack;this.componentDidCatch(u.value,{componentStack:w!==null?w:""})})}function QA(n,r,o,u,d){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=o.alternate,r!==null&&zl(r,o,d,!0),o=ai.current,o!==null){switch(o.tag){case 13:return zi===null?$m():o.alternate===null&&Ct===0&&(Ct=3),o.flags&=-257,o.flags|=65536,o.lanes=d,u===em?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([u]):r.add(u),Xm(n,u,d)),!1;case 22:return o.flags|=65536,u===em?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([u]):o.add(u)),Xm(n,u,d)),!1}throw Error(s(435,o.tag))}return Xm(n,u,d),$m(),!1}if(tt)return r=ai.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=d,u!==Yf&&(n=Error(s(422),{cause:u}),Fl(ni(n,o)))):(u!==Yf&&(r=Error(s(423),{cause:u}),Fl(ni(r,o))),n=n.current.alternate,n.flags|=65536,d&=-d,n.lanes|=d,u=ni(u,o),d=Am(n.stateNode,u,d),im(n,d),Ct!==4&&(Ct=2)),!1;var m=Error(s(520),{cause:u});if(m=ni(m,o),lu===null?lu=[m]:lu.push(m),Ct!==4&&(Ct=2),r===null)return!0;u=ni(u,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=d&-d,o.lanes|=n,n=Am(o.stateNode,u,n),im(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(_r===null||!_r.has(m))))return o.flags|=65536,d&=-d,o.lanes|=d,d=xy(d),Ny(d,n,o,u),im(o,d),!1}o=o.return}while(o!==null);return!1}var Dy=Error(s(461)),Jt=!1;function ln(n,r,o,u){r.child=n===null?Ty(r,null,o,u):Ro(r,n.child,o,u)}function Oy(n,r,o,u,d){o=o.render;var m=r.ref;if("ref"in u){var E={};for(var w in u)w!=="ref"&&(E[w]=u[w])}else E=u;return Ta(r),u=lm(n,r,o,E,m,d),w=um(),n!==null&&!Jt?(cm(n,r,d),Ds(n,r,d)):(tt&&w&&Gf(r),r.flags|=1,ln(n,r,u,d),r.child)}function ky(n,r,o,u,d){if(n===null){var m=o.type;return typeof m=="function"&&!zf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,My(n,r,m,u,d)):(n=Yc(o.type,null,u,r,r.mode,d),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!km(n,d)){var E=m.memoizedProps;if(o=o.compare,o=o!==null?o:Ll,o(E,u)&&n.ref===r.ref)return Ds(n,r,d)}return r.flags|=1,n=Ss(m,u),n.ref=r.ref,n.return=r,r.child=n}function My(n,r,o,u,d){if(n!==null){var m=n.memoizedProps;if(Ll(m,u)&&n.ref===r.ref)if(Jt=!1,r.pendingProps=u=m,km(n,d))(n.flags&131072)!==0&&(Jt=!0);else return r.lanes=n.lanes,Ds(n,r,d)}return Rm(n,r,o,u,d)}function Py(n,r,o){var u=r.pendingProps,d=u.children,m=n!==null?n.memoizedState:null;if(u.mode==="hidden"){if((r.flags&128)!==0){if(u=m!==null?m.baseLanes|o:o,n!==null){for(d=r.child=n.child,m=0;d!==null;)m=m|d.lanes|d.childLanes,d=d.sibling;r.childLanes=m&~u}else r.childLanes=0,r.child=null;return Vy(n,r,u,o)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&Jc(r,m!==null?m.cachePool:null),m!==null?M0(r,m):rm(),by(r);else return r.lanes=r.childLanes=536870912,Vy(n,r,m!==null?m.baseLanes|o:o,o)}else m!==null?(Jc(r,m.cachePool),M0(r,m),hr(),r.memoizedState=null):(n!==null&&Jc(r,null),rm(),hr());return ln(n,r,d,o),r.child}function Vy(n,r,o,u){var d=Zf();return d=d===null?null:{parent:Kt._currentValue,pool:d},r.memoizedState={baseLanes:o,cachePool:d},n!==null&&Jc(r,null),rm(),by(r),n!==null&&zl(n,r,u,!0),null}function ph(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(s(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Rm(n,r,o,u,d){return Ta(r),o=lm(n,r,o,u,void 0,d),u=um(),n!==null&&!Jt?(cm(n,r,d),Ds(n,r,d)):(tt&&u&&Gf(r),r.flags|=1,ln(n,r,o,d),r.child)}function Ly(n,r,o,u,d,m){return Ta(r),r.updateQueue=null,o=V0(r,u,o,d),P0(n),u=um(),n!==null&&!Jt?(cm(n,r,m),Ds(n,r,m)):(tt&&u&&Gf(r),r.flags|=1,ln(n,r,o,m),r.child)}function Uy(n,r,o,u,d){if(Ta(r),r.stateNode===null){var m=go,E=o.contextType;typeof E=="object"&&E!==null&&(m=pn(E)),m=new o(u,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Sm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=u,m.state=r.memoizedState,m.refs={},tm(r),E=o.contextType,m.context=typeof E=="object"&&E!==null?pn(E):go,m.state=r.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(wm(r,o,E,u),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(E=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),E!==m.state&&Sm.enqueueReplaceState(m,m.state,null),$l(r,u,m,d),Ql(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(n===null){m=r.stateNode;var w=r.memoizedProps,C=Sa(o,w);m.props=C;var F=m.context,Q=o.contextType;E=go,typeof Q=="object"&&Q!==null&&(E=pn(Q));var J=o.getDerivedStateFromProps;Q=typeof J=="function"||typeof m.getSnapshotBeforeUpdate=="function",w=r.pendingProps!==w,Q||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(w||F!==E)&&Sy(r,m,u,E),ar=!1;var H=r.memoizedState;m.state=H,$l(r,u,m,d),Ql(),F=r.memoizedState,w||H!==F||ar?(typeof J=="function"&&(wm(r,o,J,u),F=r.memoizedState),(C=ar||wy(r,o,C,u,H,F,E))?(Q||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=F),m.props=u,m.state=F,m.context=E,u=C):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{m=r.stateNode,nm(n,r),E=r.memoizedProps,Q=Sa(o,E),m.props=Q,J=r.pendingProps,H=m.context,F=o.contextType,C=go,typeof F=="object"&&F!==null&&(C=pn(F)),w=o.getDerivedStateFromProps,(F=typeof w=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(E!==J||H!==C)&&Sy(r,m,u,C),ar=!1,H=r.memoizedState,m.state=H,$l(r,u,m,d),Ql();var G=r.memoizedState;E!==J||H!==G||ar||n!==null&&n.dependencies!==null&&Wc(n.dependencies)?(typeof w=="function"&&(wm(r,o,w,u),G=r.memoizedState),(Q=ar||wy(r,o,Q,u,H,G,C)||n!==null&&n.dependencies!==null&&Wc(n.dependencies))?(F||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(u,G,C),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(u,G,C)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||E===n.memoizedProps&&H===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&H===n.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=G),m.props=u,m.state=G,m.context=C,u=Q):(typeof m.componentDidUpdate!="function"||E===n.memoizedProps&&H===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&H===n.memoizedState||(r.flags|=1024),u=!1)}return m=u,ph(n,r),u=(r.flags&128)!==0,m||u?(m=r.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&u?(r.child=Ro(r,n.child,null,d),r.child=Ro(r,null,o,d)):ln(n,r,o,d),r.memoizedState=m.state,n=r.child):n=Ds(n,r,d),n}function jy(n,r,o,u){return Bl(),r.flags|=256,ln(n,r,o,u),r.child}var Cm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(n){return{baseLanes:n,cachePool:R0()}}function xm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=oi),n}function By(n,r,o){var u=r.pendingProps,d=!1,m=(r.flags&128)!==0,E;if((E=m)||(E=n!==null&&n.memoizedState===null?!1:(Yt.current&2)!==0),E&&(d=!0,r.flags&=-129),E=(r.flags&32)!==0,r.flags&=-33,n===null){if(tt){if(d?cr(r):hr(),tt){var w=Rt,C;if(C=w){e:{for(C=w,w=Fi;C.nodeType!==8;){if(!w){w=null;break e}if(C=Ti(C.nextSibling),C===null){w=null;break e}}w=C}w!==null?(r.memoizedState={dehydrated:w,treeContext:ga!==null?{id:As,overflow:Rs}:null,retryLane:536870912,hydrationErrors:null},C=Fn(18,null,null,0),C.stateNode=w,C.return=r,r.child=C,Nn=r,Rt=null,C=!0):C=!1}C||va(r)}if(w=r.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return dp(w)?r.lanes=32:r.lanes=536870912,null;Ns(r)}return w=u.children,u=u.fallback,d?(hr(),d=r.mode,w=gh({mode:"hidden",children:w},d),u=pa(u,d,o,null),w.return=r,u.return=r,w.sibling=u,r.child=w,d=r.child,d.memoizedState=Im(o),d.childLanes=xm(n,E,o),r.memoizedState=Cm,u):(cr(r),Nm(r,w))}if(C=n.memoizedState,C!==null&&(w=C.dehydrated,w!==null)){if(m)r.flags&256?(cr(r),r.flags&=-257,r=Dm(n,r,o)):r.memoizedState!==null?(hr(),r.child=n.child,r.flags|=128,r=null):(hr(),d=u.fallback,w=r.mode,u=gh({mode:"visible",children:u.children},w),d=pa(d,w,o,null),d.flags|=2,u.return=r,d.return=r,u.sibling=d,r.child=u,Ro(r,n.child,null,o),u=r.child,u.memoizedState=Im(o),u.childLanes=xm(n,E,o),r.memoizedState=Cm,r=d);else if(cr(r),dp(w)){if(E=w.nextSibling&&w.nextSibling.dataset,E)var F=E.dgst;E=F,u=Error(s(419)),u.stack="",u.digest=E,Fl({value:u,source:null,stack:null}),r=Dm(n,r,o)}else if(Jt||zl(n,r,o,!1),E=(o&n.childLanes)!==0,Jt||E){if(E=mt,E!==null&&(u=o&-o,u=(u&42)!==0?1:xt(u),u=(u&(E.suspendedLanes|o))!==0?0:u,u!==0&&u!==C.retryLane))throw C.retryLane=u,po(n,u),Kn(E,n,u),Dy;w.data==="$?"||$m(),r=Dm(n,r,o)}else w.data==="$?"?(r.flags|=192,r.child=n.child,r=null):(n=C.treeContext,Rt=Ti(w.nextSibling),Nn=r,tt=!0,ya=null,Fi=!1,n!==null&&(si[ri++]=As,si[ri++]=Rs,si[ri++]=ga,As=n.id,Rs=n.overflow,ga=r),r=Nm(r,u.children),r.flags|=4096);return r}return d?(hr(),d=u.fallback,w=r.mode,C=n.child,F=C.sibling,u=Ss(C,{mode:"hidden",children:u.children}),u.subtreeFlags=C.subtreeFlags&65011712,F!==null?d=Ss(F,d):(d=pa(d,w,o,null),d.flags|=2),d.return=r,u.return=r,u.sibling=d,r.child=u,u=d,d=r.child,w=n.child.memoizedState,w===null?w=Im(o):(C=w.cachePool,C!==null?(F=Kt._currentValue,C=C.parent!==F?{parent:F,pool:F}:C):C=R0(),w={baseLanes:w.baseLanes|o,cachePool:C}),d.memoizedState=w,d.childLanes=xm(n,E,o),r.memoizedState=Cm,u):(cr(r),o=n.child,n=o.sibling,o=Ss(o,{mode:"visible",children:u.children}),o.return=r,o.sibling=null,n!==null&&(E=r.deletions,E===null?(r.deletions=[n],r.flags|=16):E.push(n)),r.child=o,r.memoizedState=null,o)}function Nm(n,r){return r=gh({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function gh(n,r){return n=Fn(22,n,null,r),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function Dm(n,r,o){return Ro(r,n.child,null,o),n=Nm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function Fy(n,r,o){n.lanes|=r;var u=n.alternate;u!==null&&(u.lanes|=r),$f(n.return,r,o)}function Om(n,r,o,u,d){var m=n.memoizedState;m===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:d}:(m.isBackwards=r,m.rendering=null,m.renderingStartTime=0,m.last=u,m.tail=o,m.tailMode=d)}function zy(n,r,o){var u=r.pendingProps,d=u.revealOrder,m=u.tail;if(ln(n,r,u.children,o),u=Yt.current,(u&2)!==0)u=u&1|2,r.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Fy(n,o,r);else if(n.tag===19)Fy(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}u&=1}switch(ne(Yt,u),d){case"forwards":for(o=r.child,d=null;o!==null;)n=o.alternate,n!==null&&dh(n)===null&&(d=o),o=o.sibling;o=d,o===null?(d=r.child,r.child=null):(d=o.sibling,o.sibling=null),Om(r,!1,d,o,m);break;case"backwards":for(o=null,d=r.child,r.child=null;d!==null;){if(n=d.alternate,n!==null&&dh(n)===null){r.child=d;break}n=d.sibling,d.sibling=o,o=d,d=n}Om(r,!0,o,null,m);break;case"together":Om(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Ds(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),gr|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(zl(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(s(153));if(r.child!==null){for(n=r.child,o=Ss(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=Ss(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function km(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&Wc(n)))}function $A(n,r,o){switch(r.tag){case 3:ot(r,r.stateNode.containerInfo),rr(r,Kt,n.memoizedState.cache),Bl();break;case 27:case 5:xi(r);break;case 4:ot(r,r.stateNode.containerInfo);break;case 10:rr(r,r.type,r.memoizedProps.value);break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(cr(r),r.flags|=128,null):(o&r.child.childLanes)!==0?By(n,r,o):(cr(r),n=Ds(n,r,o),n!==null?n.sibling:null);cr(r);break;case 19:var d=(n.flags&128)!==0;if(u=(o&r.childLanes)!==0,u||(zl(n,r,o,!1),u=(o&r.childLanes)!==0),d){if(u)return zy(n,r,o);r.flags|=128}if(d=r.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),ne(Yt,Yt.current),u)break;return null;case 22:case 23:return r.lanes=0,Py(n,r,o);case 24:rr(r,Kt,n.memoizedState.cache)}return Ds(n,r,o)}function qy(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)Jt=!0;else{if(!km(n,o)&&(r.flags&128)===0)return Jt=!1,$A(n,r,o);Jt=(n.flags&131072)!==0}else Jt=!1,tt&&(r.flags&1048576)!==0&&v0(r,$c,r.index);switch(r.lanes=0,r.tag){case 16:e:{n=r.pendingProps;var u=r.elementType,d=u._init;if(u=d(u._payload),r.type=u,typeof u=="function")zf(u)?(n=Sa(u,n),r.tag=1,r=Uy(null,r,u,n,o)):(r.tag=0,r=Rm(null,r,u,n,o));else{if(u!=null){if(d=u.$$typeof,d===Te){r.tag=11,r=Oy(null,r,u,n,o);break e}else if(d===M){r.tag=14,r=ky(null,r,u,n,o);break e}}throw r=ue(u)||u,Error(s(306,r,""))}}return r;case 0:return Rm(n,r,r.type,r.pendingProps,o);case 1:return u=r.type,d=Sa(u,r.pendingProps),Uy(n,r,u,d,o);case 3:e:{if(ot(r,r.stateNode.containerInfo),n===null)throw Error(s(387));u=r.pendingProps;var m=r.memoizedState;d=m.element,nm(n,r),$l(r,u,null,o);var E=r.memoizedState;if(u=E.cache,rr(r,Kt,u),u!==m.cache&&Wf(r,[Kt],o,!0),Ql(),u=E.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:E.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=jy(n,r,u,o);break e}else if(u!==d){d=ni(Error(s(424)),r),Fl(d),r=jy(n,r,u,o);break e}else{switch(n=r.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Rt=Ti(n.firstChild),Nn=r,tt=!0,ya=null,Fi=!0,o=Ty(r,null,u,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Bl(),u===d){r=Ds(n,r,o);break e}ln(n,r,u,o)}r=r.child}return r;case 26:return ph(n,r),n===null?(o=Yv(r.type,null,r.pendingProps,null))?r.memoizedState=o:tt||(o=r.type,n=r.pendingProps,u=Nh(Ne.current).createElement(o),u[qt]=r,u[Pt]=n,cn(u,o,n),Nt(u),r.stateNode=u):r.memoizedState=Yv(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return xi(r),n===null&&tt&&(u=r.stateNode=Hv(r.type,r.pendingProps,Ne.current),Nn=r,Fi=!0,d=Rt,Er(r.type)?(fp=d,Rt=Ti(u.firstChild)):Rt=d),ln(n,r,r.pendingProps.children,o),ph(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&tt&&((d=u=Rt)&&(u=wR(u,r.type,r.pendingProps,Fi),u!==null?(r.stateNode=u,Nn=r,Rt=Ti(u.firstChild),Fi=!1,d=!0):d=!1),d||va(r)),xi(r),d=r.type,m=r.pendingProps,E=n!==null?n.memoizedProps:null,u=m.children,up(d,m)?u=null:E!==null&&up(d,E)&&(r.flags|=32),r.memoizedState!==null&&(d=lm(n,r,FA,null,null,o),_u._currentValue=d),ph(n,r),ln(n,r,u,o),r.child;case 6:return n===null&&tt&&((n=o=Rt)&&(o=SR(o,r.pendingProps,Fi),o!==null?(r.stateNode=o,Nn=r,Rt=null,n=!0):n=!1),n||va(r)),null;case 13:return By(n,r,o);case 4:return ot(r,r.stateNode.containerInfo),u=r.pendingProps,n===null?r.child=Ro(r,null,u,o):ln(n,r,u,o),r.child;case 11:return Oy(n,r,r.type,r.pendingProps,o);case 7:return ln(n,r,r.pendingProps,o),r.child;case 8:return ln(n,r,r.pendingProps.children,o),r.child;case 12:return ln(n,r,r.pendingProps.children,o),r.child;case 10:return u=r.pendingProps,rr(r,r.type,u.value),ln(n,r,u.children,o),r.child;case 9:return d=r.type._context,u=r.pendingProps.children,Ta(r),d=pn(d),u=u(d),r.flags|=1,ln(n,r,u,o),r.child;case 14:return ky(n,r,r.type,r.pendingProps,o);case 15:return My(n,r,r.type,r.pendingProps,o);case 19:return zy(n,r,o);case 31:return u=r.pendingProps,o=r.mode,u={mode:u.mode,children:u.children},n===null?(o=gh(u,o),o.ref=r.ref,r.child=o,o.return=r,r=o):(o=Ss(n.child,u),o.ref=r.ref,r.child=o,o.return=r,r=o),r;case 22:return Py(n,r,o);case 24:return Ta(r),u=pn(Kt),n===null?(d=Zf(),d===null&&(d=mt,m=Xf(),d.pooledCache=m,m.refCount++,m!==null&&(d.pooledCacheLanes|=o),d=m),r.memoizedState={parent:u,cache:d},tm(r),rr(r,Kt,d)):((n.lanes&o)!==0&&(nm(n,r),$l(r,null,null,o),Ql()),d=n.memoizedState,m=r.memoizedState,d.parent!==u?(d={parent:u,cache:u},r.memoizedState=d,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=d),rr(r,Kt,u)):(u=m.cache,rr(r,Kt,u),u!==d.cache&&Wf(r,[Kt],o,!0))),ln(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(s(156,r.tag))}function Os(n){n.flags|=4}function Hy(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Jv(r)){if(r=ai.current,r!==null&&((We&4194048)===We?zi!==null:(We&62914560)!==We&&(We&536870912)===0||r!==zi))throw Kl=em,C0;n.flags|=8192}}function _h(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?ge():536870912,n.lanes|=r,No|=r)}function nu(n,r){if(!tt)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function wt(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,u=0;if(r)for(var d=n.child;d!==null;)o|=d.lanes|d.childLanes,u|=d.subtreeFlags&65011712,u|=d.flags&65011712,d.return=n,d=d.sibling;else for(d=n.child;d!==null;)o|=d.lanes|d.childLanes,u|=d.subtreeFlags,u|=d.flags,d.return=n,d=d.sibling;return n.subtreeFlags|=u,n.childLanes=o,r}function WA(n,r,o){var u=r.pendingProps;switch(Kf(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(r),null;case 1:return wt(r),null;case 3:return o=r.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),Is(Kt),Wn(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(jl(r)?Os(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,b0())),wt(r),null;case 26:return o=r.memoizedState,n===null?(Os(r),o!==null?(wt(r),Hy(r,o)):(wt(r),r.flags&=-16777217)):o?o!==n.memoizedState?(Os(r),wt(r),Hy(r,o)):(wt(r),r.flags&=-16777217):(n.memoizedProps!==u&&Os(r),wt(r),r.flags&=-16777217),null;case 27:mi(r),o=Ne.current;var d=r.type;if(n!==null&&r.stateNode!=null)n.memoizedProps!==u&&Os(r);else{if(!u){if(r.stateNode===null)throw Error(s(166));return wt(r),null}n=ye.current,jl(r)?E0(r):(n=Hv(d,u,o),r.stateNode=n,Os(r))}return wt(r),null;case 5:if(mi(r),o=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==u&&Os(r);else{if(!u){if(r.stateNode===null)throw Error(s(166));return wt(r),null}if(n=ye.current,jl(r))E0(r);else{switch(d=Nh(Ne.current),n){case 1:n=d.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:n=d.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":n=d.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":n=d.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":n=d.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof u.is=="string"?d.createElement("select",{is:u.is}):d.createElement("select"),u.multiple?n.multiple=!0:u.size&&(n.size=u.size);break;default:n=typeof u.is=="string"?d.createElement(o,{is:u.is}):d.createElement(o)}}n[qt]=r,n[Pt]=u;e:for(d=r.child;d!==null;){if(d.tag===5||d.tag===6)n.appendChild(d.stateNode);else if(d.tag!==4&&d.tag!==27&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===r)break e;for(;d.sibling===null;){if(d.return===null||d.return===r)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}r.stateNode=n;e:switch(cn(n,o,u),o){case"button":case"input":case"select":case"textarea":n=!!u.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&Os(r)}}return wt(r),r.flags&=-16777217,null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==u&&Os(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(s(166));if(n=Ne.current,jl(r)){if(n=r.stateNode,o=r.memoizedProps,u=null,d=Nn,d!==null)switch(d.tag){case 27:case 5:u=d.memoizedProps}n[qt]=r,n=!!(n.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Lv(n.nodeValue,o)),n||va(r)}else n=Nh(n).createTextNode(u),n[qt]=r,r.stateNode=n}return wt(r),null;case 13:if(u=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(d=jl(r),u!==null&&u.dehydrated!==null){if(n===null){if(!d)throw Error(s(318));if(d=r.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));d[qt]=r}else Bl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;wt(r),d=!1}else d=b0(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=d),d=!0;if(!d)return r.flags&256?(Ns(r),r):(Ns(r),null)}if(Ns(r),(r.flags&128)!==0)return r.lanes=o,r;if(o=u!==null,n=n!==null&&n.memoizedState!==null,o){u=r.child,d=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(d=u.alternate.memoizedState.cachePool.pool);var m=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),m!==d&&(u.flags|=2048)}return o!==n&&o&&(r.child.flags|=8192),_h(r,r.updateQueue),wt(r),null;case 4:return Wn(),n===null&&sp(r.stateNode.containerInfo),wt(r),null;case 10:return Is(r.type),wt(r),null;case 19:if(re(Yt),d=r.memoizedState,d===null)return wt(r),null;if(u=(r.flags&128)!==0,m=d.rendering,m===null)if(u)nu(d,!1);else{if(Ct!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=dh(n),m!==null){for(r.flags|=128,nu(d,!1),n=m.updateQueue,r.updateQueue=n,_h(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)y0(o,n),o=o.sibling;return ne(Yt,Yt.current&1|2),r.child}n=n.sibling}d.tail!==null&&An()>Eh&&(r.flags|=128,u=!0,nu(d,!1),r.lanes=4194304)}else{if(!u)if(n=dh(m),n!==null){if(r.flags|=128,u=!0,n=n.updateQueue,r.updateQueue=n,_h(r,n),nu(d,!0),d.tail===null&&d.tailMode==="hidden"&&!m.alternate&&!tt)return wt(r),null}else 2*An()-d.renderingStartTime>Eh&&o!==536870912&&(r.flags|=128,u=!0,nu(d,!1),r.lanes=4194304);d.isBackwards?(m.sibling=r.child,r.child=m):(n=d.last,n!==null?n.sibling=m:r.child=m,d.last=m)}return d.tail!==null?(r=d.tail,d.rendering=r,d.tail=r.sibling,d.renderingStartTime=An(),r.sibling=null,n=Yt.current,ne(Yt,u?n&1|2:n&1),r):(wt(r),null);case 22:case 23:return Ns(r),am(),u=r.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(o&536870912)!==0&&(r.flags&128)===0&&(wt(r),r.subtreeFlags&6&&(r.flags|=8192)):wt(r),o=r.updateQueue,o!==null&&_h(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==o&&(r.flags|=2048),n!==null&&re(ba),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Is(Kt),wt(r),null;case 25:return null;case 30:return null}throw Error(s(156,r.tag))}function XA(n,r){switch(Kf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Is(Kt),Wn(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return mi(r),null;case 13:if(Ns(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(s(340));Bl()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return re(Yt),null;case 4:return Wn(),null;case 10:return Is(r.type),null;case 22:case 23:return Ns(r),am(),n!==null&&re(ba),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Is(Kt),null;case 25:return null;default:return null}}function Gy(n,r){switch(Kf(r),r.tag){case 3:Is(Kt),Wn();break;case 26:case 27:case 5:mi(r);break;case 4:Wn();break;case 13:Ns(r);break;case 19:re(Yt);break;case 10:Is(r.type);break;case 22:case 23:Ns(r),am(),n!==null&&re(ba);break;case 24:Is(Kt)}}function iu(n,r){try{var o=r.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var d=u.next;o=d;do{if((o.tag&n)===n){u=void 0;var m=o.create,E=o.inst;u=m(),E.destroy=u}o=o.next}while(o!==d)}}catch(w){ft(r,r.return,w)}}function dr(n,r,o){try{var u=r.updateQueue,d=u!==null?u.lastEffect:null;if(d!==null){var m=d.next;u=m;do{if((u.tag&n)===n){var E=u.inst,w=E.destroy;if(w!==void 0){E.destroy=void 0,d=r;var C=o,F=w;try{F()}catch(Q){ft(d,C,Q)}}}u=u.next}while(u!==m)}}catch(Q){ft(r,r.return,Q)}}function Ky(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{k0(r,o)}catch(u){ft(n,n.return,u)}}}function Yy(n,r,o){o.props=Sa(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(u){ft(n,r,u)}}function su(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof o=="function"?n.refCleanup=o(u):o.current=u}}catch(d){ft(n,r,d)}}function qi(n,r){var o=n.ref,u=n.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(d){ft(n,r,d)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(d){ft(n,r,d)}else o.current=null}function Qy(n){var r=n.type,o=n.memoizedProps,u=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(d){ft(n,n.return,d)}}function Mm(n,r,o){try{var u=n.stateNode;yR(u,n.type,o,r),u[Pt]=r}catch(d){ft(n,n.return,d)}}function $y(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Er(n.type)||n.tag===4}function Pm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||$y(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Er(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Vm(n,r,o){var u=n.tag;if(u===5||u===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=xh));else if(u!==4&&(u===27&&Er(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(Vm(n,r,o),n=n.sibling;n!==null;)Vm(n,r,o),n=n.sibling}function yh(n,r,o){var u=n.tag;if(u===5||u===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(u!==4&&(u===27&&Er(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(yh(n,r,o),n=n.sibling;n!==null;)yh(n,r,o),n=n.sibling}function Wy(n){var r=n.stateNode,o=n.memoizedProps;try{for(var u=n.type,d=r.attributes;d.length;)r.removeAttributeNode(d[0]);cn(r,u,o),r[qt]=n,r[Pt]=o}catch(m){ft(n,n.return,m)}}var ks=!1,Ot=!1,Lm=!1,Xy=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function JA(n,r){if(n=n.containerInfo,op=Vh,n=l0(n),Pf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var d=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var E=0,w=-1,C=-1,F=0,Q=0,J=n,H=null;t:for(;;){for(var G;J!==o||d!==0&&J.nodeType!==3||(w=E+d),J!==m||u!==0&&J.nodeType!==3||(C=E+u),J.nodeType===3&&(E+=J.nodeValue.length),(G=J.firstChild)!==null;)H=J,J=G;for(;;){if(J===n)break t;if(H===o&&++F===d&&(w=E),H===m&&++Q===u&&(C=E),(G=J.nextSibling)!==null)break;J=H,H=J.parentNode}J=G}o=w===-1||C===-1?null:{start:w,end:C}}else o=null}o=o||{start:0,end:0}}else o=null;for(lp={focusedElem:n,selectionRange:o},Vh=!1,Zt=r;Zt!==null;)if(r=Zt,n=r.child,(r.subtreeFlags&1024)!==0&&n!==null)n.return=r,Zt=n;else for(;Zt!==null;){switch(r=Zt,m=r.alternate,n=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,d=m.memoizedProps,m=m.memoizedState,u=o.stateNode;try{var De=Sa(o.type,d,o.elementType===o.type);n=u.getSnapshotBeforeUpdate(De,m),u.__reactInternalSnapshotBeforeUpdate=n}catch(Ae){ft(o,o.return,Ae)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)hp(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":hp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(s(163))}if(n=r.sibling,n!==null){n.return=r.return,Zt=n;break}Zt=r.return}}function Jy(n,r,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:fr(n,o),u&4&&iu(5,o);break;case 1:if(fr(n,o),u&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(E){ft(o,o.return,E)}else{var d=Sa(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(d,r,n.__reactInternalSnapshotBeforeUpdate)}catch(E){ft(o,o.return,E)}}u&64&&Ky(o),u&512&&su(o,o.return);break;case 3:if(fr(n,o),u&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{k0(n,r)}catch(E){ft(o,o.return,E)}}break;case 27:r===null&&u&4&&Wy(o);case 26:case 5:fr(n,o),r===null&&u&4&&Qy(o),u&512&&su(o,o.return);break;case 12:fr(n,o);break;case 13:fr(n,o),u&4&&tv(n,o),u&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=oR.bind(null,o),AR(n,o))));break;case 22:if(u=o.memoizedState!==null||ks,!u){r=r!==null&&r.memoizedState!==null||Ot,d=ks;var m=Ot;ks=u,(Ot=r)&&!m?mr(n,o,(o.subtreeFlags&8772)!==0):fr(n,o),ks=d,Ot=m}break;case 30:break;default:fr(n,o)}}function Zy(n){var r=n.alternate;r!==null&&(n.alternate=null,Zy(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&tr(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var bt=null,On=!1;function Ms(n,r,o){for(o=o.child;o!==null;)ev(n,r,o),o=o.sibling}function ev(n,r,o){if(Pe&&typeof Pe.onCommitFiberUnmount=="function")try{Pe.onCommitFiberUnmount(Et,o)}catch{}switch(o.tag){case 26:Ot||qi(o,r),Ms(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Ot||qi(o,r);var u=bt,d=On;Er(o.type)&&(bt=o.stateNode,On=!1),Ms(n,r,o),fu(o.stateNode),bt=u,On=d;break;case 5:Ot||qi(o,r);case 6:if(u=bt,d=On,bt=null,Ms(n,r,o),bt=u,On=d,bt!==null)if(On)try{(bt.nodeType===9?bt.body:bt.nodeName==="HTML"?bt.ownerDocument.body:bt).removeChild(o.stateNode)}catch(m){ft(o,r,m)}else try{bt.removeChild(o.stateNode)}catch(m){ft(o,r,m)}break;case 18:bt!==null&&(On?(n=bt,zv(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Tu(n)):zv(bt,o.stateNode));break;case 4:u=bt,d=On,bt=o.stateNode.containerInfo,On=!0,Ms(n,r,o),bt=u,On=d;break;case 0:case 11:case 14:case 15:Ot||dr(2,o,r),Ot||dr(4,o,r),Ms(n,r,o);break;case 1:Ot||(qi(o,r),u=o.stateNode,typeof u.componentWillUnmount=="function"&&Yy(o,r,u)),Ms(n,r,o);break;case 21:Ms(n,r,o);break;case 22:Ot=(u=Ot)||o.memoizedState!==null,Ms(n,r,o),Ot=u;break;default:Ms(n,r,o)}}function tv(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Tu(n)}catch(o){ft(r,r.return,o)}}function ZA(n){switch(n.tag){case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new Xy),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new Xy),r;default:throw Error(s(435,n.tag))}}function Um(n,r){var o=ZA(n);r.forEach(function(u){var d=lR.bind(null,n,u);o.has(u)||(o.add(u),u.then(d,d))})}function zn(n,r){var o=r.deletions;if(o!==null)for(var u=0;u<o.length;u++){var d=o[u],m=n,E=r,w=E;e:for(;w!==null;){switch(w.tag){case 27:if(Er(w.type)){bt=w.stateNode,On=!1;break e}break;case 5:bt=w.stateNode,On=!1;break e;case 3:case 4:bt=w.stateNode.containerInfo,On=!0;break e}w=w.return}if(bt===null)throw Error(s(160));ev(m,E,d),bt=null,On=!1,m=d.alternate,m!==null&&(m.return=null),d.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)nv(r,n),r=r.sibling}var Ei=null;function nv(n,r){var o=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:zn(r,n),qn(n),u&4&&(dr(3,n,n.return),iu(3,n),dr(5,n,n.return));break;case 1:zn(r,n),qn(n),u&512&&(Ot||o===null||qi(o,o.return)),u&64&&ks&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var d=Ei;if(zn(r,n),qn(n),u&512&&(Ot||o===null||qi(o,o.return)),u&4){var m=o!==null?o.memoizedState:null;if(u=n.memoizedState,o===null)if(u===null)if(n.stateNode===null){e:{u=n.type,o=n.memoizedProps,d=d.ownerDocument||d;t:switch(u){case"title":m=d.getElementsByTagName("title")[0],(!m||m[Zr]||m[qt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=d.createElement(u),d.head.insertBefore(m,d.querySelector("head > title"))),cn(m,u,o),m[qt]=n,Nt(m),u=m;break e;case"link":var E=Wv("link","href",d).get(u+(o.href||""));if(E){for(var w=0;w<E.length;w++)if(m=E[w],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(w,1);break t}}m=d.createElement(u),cn(m,u,o),d.head.appendChild(m);break;case"meta":if(E=Wv("meta","content",d).get(u+(o.content||""))){for(w=0;w<E.length;w++)if(m=E[w],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(w,1);break t}}m=d.createElement(u),cn(m,u,o),d.head.appendChild(m);break;default:throw Error(s(468,u))}m[qt]=n,Nt(m),u=m}n.stateNode=u}else Xv(d,n.type,n.stateNode);else n.stateNode=$v(d,u,n.memoizedProps);else m!==u?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,u===null?Xv(d,n.type,n.stateNode):$v(d,u,n.memoizedProps)):u===null&&n.stateNode!==null&&Mm(n,n.memoizedProps,o.memoizedProps)}break;case 27:zn(r,n),qn(n),u&512&&(Ot||o===null||qi(o,o.return)),o!==null&&u&4&&Mm(n,n.memoizedProps,o.memoizedProps);break;case 5:if(zn(r,n),qn(n),u&512&&(Ot||o===null||qi(o,o.return)),n.flags&32){d=n.stateNode;try{Jn(d,"")}catch(G){ft(n,n.return,G)}}u&4&&n.stateNode!=null&&(d=n.memoizedProps,Mm(n,d,o!==null?o.memoizedProps:d)),u&1024&&(Lm=!0);break;case 6:if(zn(r,n),qn(n),u&4){if(n.stateNode===null)throw Error(s(162));u=n.memoizedProps,o=n.stateNode;try{o.nodeValue=u}catch(G){ft(n,n.return,G)}}break;case 3:if(kh=null,d=Ei,Ei=Dh(r.containerInfo),zn(r,n),Ei=d,qn(n),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Tu(r.containerInfo)}catch(G){ft(n,n.return,G)}Lm&&(Lm=!1,iv(n));break;case 4:u=Ei,Ei=Dh(n.stateNode.containerInfo),zn(r,n),qn(n),Ei=u;break;case 12:zn(r,n),qn(n);break;case 13:zn(r,n),qn(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Hm=An()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Um(n,u)));break;case 22:d=n.memoizedState!==null;var C=o!==null&&o.memoizedState!==null,F=ks,Q=Ot;if(ks=F||d,Ot=Q||C,zn(r,n),Ot=Q,ks=F,qn(n),u&8192)e:for(r=n.stateNode,r._visibility=d?r._visibility&-2:r._visibility|1,d&&(o===null||C||ks||Ot||Aa(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){C=o=r;try{if(m=C.stateNode,d)E=m.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{w=C.stateNode;var J=C.memoizedProps.style,H=J!=null&&J.hasOwnProperty("display")?J.display:null;w.style.display=H==null||typeof H=="boolean"?"":(""+H).trim()}}catch(G){ft(C,C.return,G)}}}else if(r.tag===6){if(o===null){C=r;try{C.stateNode.nodeValue=d?"":C.memoizedProps}catch(G){ft(C,C.return,G)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=n.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Um(n,o))));break;case 19:zn(r,n),qn(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Um(n,u)));break;case 30:break;case 21:break;default:zn(r,n),qn(n)}}function qn(n){var r=n.flags;if(r&2){try{for(var o,u=n.return;u!==null;){if($y(u)){o=u;break}u=u.return}if(o==null)throw Error(s(160));switch(o.tag){case 27:var d=o.stateNode,m=Pm(n);yh(n,m,d);break;case 5:var E=o.stateNode;o.flags&32&&(Jn(E,""),o.flags&=-33);var w=Pm(n);yh(n,w,E);break;case 3:case 4:var C=o.stateNode.containerInfo,F=Pm(n);Vm(n,F,C);break;default:throw Error(s(161))}}catch(Q){ft(n,n.return,Q)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function iv(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;iv(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function fr(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Jy(n,r.alternate,r),r=r.sibling}function Aa(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:dr(4,r,r.return),Aa(r);break;case 1:qi(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&Yy(r,r.return,o),Aa(r);break;case 27:fu(r.stateNode);case 26:case 5:qi(r,r.return),Aa(r);break;case 22:r.memoizedState===null&&Aa(r);break;case 30:Aa(r);break;default:Aa(r)}n=n.sibling}}function mr(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,d=n,m=r,E=m.flags;switch(m.tag){case 0:case 11:case 15:mr(d,m,o),iu(4,m);break;case 1:if(mr(d,m,o),u=m,d=u.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(F){ft(u,u.return,F)}if(u=m,d=u.updateQueue,d!==null){var w=u.stateNode;try{var C=d.shared.hiddenCallbacks;if(C!==null)for(d.shared.hiddenCallbacks=null,d=0;d<C.length;d++)O0(C[d],w)}catch(F){ft(u,u.return,F)}}o&&E&64&&Ky(m),su(m,m.return);break;case 27:Wy(m);case 26:case 5:mr(d,m,o),o&&u===null&&E&4&&Qy(m),su(m,m.return);break;case 12:mr(d,m,o);break;case 13:mr(d,m,o),o&&E&4&&tv(d,m);break;case 22:m.memoizedState===null&&mr(d,m,o),su(m,m.return);break;case 30:break;default:mr(d,m,o)}r=r.sibling}}function jm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&ql(o))}function Bm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&ql(n))}function Hi(n,r,o,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)sv(n,r,o,u),r=r.sibling}function sv(n,r,o,u){var d=r.flags;switch(r.tag){case 0:case 11:case 15:Hi(n,r,o,u),d&2048&&iu(9,r);break;case 1:Hi(n,r,o,u);break;case 3:Hi(n,r,o,u),d&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&ql(n)));break;case 12:if(d&2048){Hi(n,r,o,u),n=r.stateNode;try{var m=r.memoizedProps,E=m.id,w=m.onPostCommit;typeof w=="function"&&w(E,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(C){ft(r,r.return,C)}}else Hi(n,r,o,u);break;case 13:Hi(n,r,o,u);break;case 23:break;case 22:m=r.stateNode,E=r.alternate,r.memoizedState!==null?m._visibility&2?Hi(n,r,o,u):ru(n,r):m._visibility&2?Hi(n,r,o,u):(m._visibility|=2,Co(n,r,o,u,(r.subtreeFlags&10256)!==0)),d&2048&&jm(E,r);break;case 24:Hi(n,r,o,u),d&2048&&Bm(r.alternate,r);break;default:Hi(n,r,o,u)}}function Co(n,r,o,u,d){for(d=d&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var m=n,E=r,w=o,C=u,F=E.flags;switch(E.tag){case 0:case 11:case 15:Co(m,E,w,C,d),iu(8,E);break;case 23:break;case 22:var Q=E.stateNode;E.memoizedState!==null?Q._visibility&2?Co(m,E,w,C,d):ru(m,E):(Q._visibility|=2,Co(m,E,w,C,d)),d&&F&2048&&jm(E.alternate,E);break;case 24:Co(m,E,w,C,d),d&&F&2048&&Bm(E.alternate,E);break;default:Co(m,E,w,C,d)}r=r.sibling}}function ru(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,u=r,d=u.flags;switch(u.tag){case 22:ru(o,u),d&2048&&jm(u.alternate,u);break;case 24:ru(o,u),d&2048&&Bm(u.alternate,u);break;default:ru(o,u)}r=r.sibling}}var au=8192;function Io(n){if(n.subtreeFlags&au)for(n=n.child;n!==null;)rv(n),n=n.sibling}function rv(n){switch(n.tag){case 26:Io(n),n.flags&au&&n.memoizedState!==null&&UR(Ei,n.memoizedState,n.memoizedProps);break;case 5:Io(n);break;case 3:case 4:var r=Ei;Ei=Dh(n.stateNode.containerInfo),Io(n),Ei=r;break;case 22:n.memoizedState===null&&(r=n.alternate,r!==null&&r.memoizedState!==null?(r=au,au=16777216,Io(n),au=r):Io(n));break;default:Io(n)}}function av(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function ou(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Zt=u,lv(u,n)}av(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)ov(n),n=n.sibling}function ov(n){switch(n.tag){case 0:case 11:case 15:ou(n),n.flags&2048&&dr(9,n,n.return);break;case 3:ou(n);break;case 12:ou(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,vh(n)):ou(n);break;default:ou(n)}}function vh(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Zt=u,lv(u,n)}av(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:dr(8,r,r.return),vh(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,vh(r));break;default:vh(r)}n=n.sibling}}function lv(n,r){for(;Zt!==null;){var o=Zt;switch(o.tag){case 0:case 11:case 15:dr(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:ql(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Zt=u;else e:for(o=n;Zt!==null;){u=Zt;var d=u.sibling,m=u.return;if(Zy(u),u===o){Zt=null;break e}if(d!==null){d.return=m,Zt=d;break e}Zt=m}}}var eR={getCacheForType:function(n){var r=pn(Kt),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o}},tR=typeof WeakMap=="function"?WeakMap:Map,rt=0,mt=null,qe=null,We=0,at=0,Hn=null,pr=!1,xo=!1,Fm=!1,Ps=0,Ct=0,gr=0,Ra=0,zm=0,oi=0,No=0,lu=null,kn=null,qm=!1,Hm=0,Eh=1/0,Th=null,_r=null,un=0,yr=null,Do=null,Oo=0,Gm=0,Km=null,uv=null,uu=0,Ym=null;function Gn(){if((rt&2)!==0&&We!==0)return We&-We;if(z.T!==null){var n=vo;return n!==0?n:ep()}return gi()}function cv(){oi===0&&(oi=(We&536870912)===0||tt?me():536870912);var n=ai.current;return n!==null&&(n.flags|=32),oi}function Kn(n,r,o){(n===mt&&(at===2||at===9)||n.cancelPendingCommit!==null)&&(ko(n,0),vr(n,We,oi,!1)),Fe(n,o),((rt&2)===0||n!==mt)&&(n===mt&&((rt&2)===0&&(Ra|=o),Ct===4&&vr(n,We,oi,!1)),Gi(n))}function hv(n,r,o){if((rt&6)!==0)throw Error(s(327));var u=!o&&(r&124)===0&&(r&n.expiredLanes)===0||fs(n,r),d=u?sR(n,r):Wm(n,r,!0),m=u;do{if(d===0){xo&&!u&&vr(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!nR(o)){d=Wm(n,r,!1),m=!1;continue}if(d===2){if(m=r,n.errorRecoveryDisabledLanes&m)var E=0;else E=n.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){r=E;e:{var w=n;d=lu;var C=w.current.memoizedState.isDehydrated;if(C&&(ko(w,E).flags|=256),E=Wm(w,E,!1),E!==2){if(Fm&&!C){w.errorRecoveryDisabledLanes|=m,Ra|=m,d=4;break e}m=kn,kn=d,m!==null&&(kn===null?kn=m:kn.push.apply(kn,m))}d=E}if(m=!1,d!==2)continue}}if(d===1){ko(n,0),vr(n,r,0,!0);break}e:{switch(u=n,m=d,m){case 0:case 1:throw Error(s(345));case 4:if((r&4194048)!==r)break;case 6:vr(u,r,oi,!pr);break e;case 2:kn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((r&62914560)===r&&(d=Hm+300-An(),10<d)){if(vr(u,r,oi,!pr),Zs(u,0,!0)!==0)break e;u.timeoutHandle=Bv(dv.bind(null,u,o,kn,Th,qm,r,oi,Ra,No,pr,m,2,-0,0),d);break e}dv(u,o,kn,Th,qm,r,oi,Ra,No,pr,m,0,-0,0)}}break}while(!0);Gi(n)}function dv(n,r,o,u,d,m,E,w,C,F,Q,J,H,G){if(n.timeoutHandle=-1,J=r.subtreeFlags,(J&8192||(J&16785408)===16785408)&&(gu={stylesheets:null,count:0,unsuspend:LR},rv(r),J=jR(),J!==null)){n.cancelPendingCommit=J(vv.bind(null,n,r,m,o,u,d,E,w,C,Q,1,H,G)),vr(n,m,E,!F);return}vv(n,r,m,o,u,d,E,w,C)}function nR(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var d=o[u],m=d.getSnapshot;d=d.value;try{if(!Bn(m(),d))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function vr(n,r,o,u){r&=~zm,r&=~Ra,n.suspendedLanes|=r,n.pingedLanes&=~r,u&&(n.warmLanes|=r),u=n.expirationTimes;for(var d=r;0<d;){var m=31-$t(d),E=1<<m;u[m]=-1,d&=~E}o!==0&&Ve(n,o,r)}function bh(){return(rt&6)===0?(cu(0),!1):!0}function Qm(){if(qe!==null){if(at===0)var n=qe.return;else n=qe,Cs=Ea=null,hm(n),Ao=null,eu=0,n=qe;for(;n!==null;)Gy(n.alternate,n),n=n.return;qe=null}}function ko(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,ER(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Qm(),mt=n,qe=o=Ss(n.current,null),We=r,at=0,Hn=null,pr=!1,xo=fs(n,r),Fm=!1,No=oi=zm=Ra=gr=Ct=0,kn=lu=null,qm=!1,(r&8)!==0&&(r|=r&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=r;0<u;){var d=31-$t(u),m=1<<d;r|=n[d],u&=~m}return Ps=r,Hc(),o}function fv(n,r){Ue=null,z.H=uh,r===Gl||r===Zc?(r=N0(),at=3):r===C0?(r=N0(),at=4):at=r===Dy?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Hn=r,qe===null&&(Ct=1,mh(n,ni(r,n.current)))}function mv(){var n=z.H;return z.H=uh,n===null?uh:n}function pv(){var n=z.A;return z.A=eR,n}function $m(){Ct=4,pr||(We&4194048)!==We&&ai.current!==null||(xo=!0),(gr&134217727)===0&&(Ra&134217727)===0||mt===null||vr(mt,We,oi,!1)}function Wm(n,r,o){var u=rt;rt|=2;var d=mv(),m=pv();(mt!==n||We!==r)&&(Th=null,ko(n,r)),r=!1;var E=Ct;e:do try{if(at!==0&&qe!==null){var w=qe,C=Hn;switch(at){case 8:Qm(),E=6;break e;case 3:case 2:case 9:case 6:ai.current===null&&(r=!0);var F=at;if(at=0,Hn=null,Mo(n,w,C,F),o&&xo){E=0;break e}break;default:F=at,at=0,Hn=null,Mo(n,w,C,F)}}iR(),E=Ct;break}catch(Q){fv(n,Q)}while(!0);return r&&n.shellSuspendCounter++,Cs=Ea=null,rt=u,z.H=d,z.A=m,qe===null&&(mt=null,We=0,Hc()),E}function iR(){for(;qe!==null;)gv(qe)}function sR(n,r){var o=rt;rt|=2;var u=mv(),d=pv();mt!==n||We!==r?(Th=null,Eh=An()+500,ko(n,r)):xo=fs(n,r);e:do try{if(at!==0&&qe!==null){r=qe;var m=Hn;t:switch(at){case 1:at=0,Hn=null,Mo(n,r,m,1);break;case 2:case 9:if(I0(m)){at=0,Hn=null,_v(r);break}r=function(){at!==2&&at!==9||mt!==n||(at=7),Gi(n)},m.then(r,r);break e;case 3:at=7;break e;case 4:at=5;break e;case 7:I0(m)?(at=0,Hn=null,_v(r)):(at=0,Hn=null,Mo(n,r,m,7));break;case 5:var E=null;switch(qe.tag){case 26:E=qe.memoizedState;case 5:case 27:var w=qe;if(!E||Jv(E)){at=0,Hn=null;var C=w.sibling;if(C!==null)qe=C;else{var F=w.return;F!==null?(qe=F,wh(F)):qe=null}break t}}at=0,Hn=null,Mo(n,r,m,5);break;case 6:at=0,Hn=null,Mo(n,r,m,6);break;case 8:Qm(),Ct=6;break e;default:throw Error(s(462))}}rR();break}catch(Q){fv(n,Q)}while(!0);return Cs=Ea=null,z.H=u,z.A=d,rt=o,qe!==null?0:(mt=null,We=0,Hc(),Ct)}function rR(){for(;qe!==null&&!Xs();)gv(qe)}function gv(n){var r=qy(n.alternate,n,Ps);n.memoizedProps=n.pendingProps,r===null?wh(n):qe=r}function _v(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=Ly(o,r,r.pendingProps,r.type,void 0,We);break;case 11:r=Ly(o,r,r.pendingProps,r.type.render,r.ref,We);break;case 5:hm(r);default:Gy(o,r),r=qe=y0(r,Ps),r=qy(o,r,Ps)}n.memoizedProps=n.pendingProps,r===null?wh(n):qe=r}function Mo(n,r,o,u){Cs=Ea=null,hm(r),Ao=null,eu=0;var d=r.return;try{if(QA(n,d,r,o,We)){Ct=1,mh(n,ni(o,n.current)),qe=null;return}}catch(m){if(d!==null)throw qe=d,m;Ct=1,mh(n,ni(o,n.current)),qe=null;return}r.flags&32768?(tt||u===1?n=!0:xo||(We&536870912)!==0?n=!1:(pr=n=!0,(u===2||u===9||u===3||u===6)&&(u=ai.current,u!==null&&u.tag===13&&(u.flags|=16384))),yv(r,n)):wh(r)}function wh(n){var r=n;do{if((r.flags&32768)!==0){yv(r,pr);return}n=r.return;var o=WA(r.alternate,r,Ps);if(o!==null){qe=o;return}if(r=r.sibling,r!==null){qe=r;return}qe=r=n}while(r!==null);Ct===0&&(Ct=5)}function yv(n,r){do{var o=XA(n.alternate,n);if(o!==null){o.flags&=32767,qe=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){qe=n;return}qe=n=o}while(n!==null);Ct=6,qe=null}function vv(n,r,o,u,d,m,E,w,C){n.cancelPendingCommit=null;do Sh();while(un!==0);if((rt&6)!==0)throw Error(s(327));if(r!==null){if(r===n.current)throw Error(s(177));if(m=r.lanes|r.childLanes,m|=Bf,ze(n,o,m,E,w,C),n===mt&&(qe=mt=null,We=0),Do=r,yr=n,Oo=o,Gm=m,Km=d,uv=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,uR(pi,function(){return Sv(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=z.T,z.T=null,d=te.p,te.p=2,E=rt,rt|=4;try{JA(n,r,o)}finally{rt=E,te.p=d,z.T=u}}un=1,Ev(),Tv(),bv()}}function Ev(){if(un===1){un=0;var n=yr,r=Do,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=z.T,z.T=null;var u=te.p;te.p=2;var d=rt;rt|=4;try{nv(r,n);var m=lp,E=l0(n.containerInfo),w=m.focusedElem,C=m.selectionRange;if(E!==w&&w&&w.ownerDocument&&o0(w.ownerDocument.documentElement,w)){if(C!==null&&Pf(w)){var F=C.start,Q=C.end;if(Q===void 0&&(Q=F),"selectionStart"in w)w.selectionStart=F,w.selectionEnd=Math.min(Q,w.value.length);else{var J=w.ownerDocument||document,H=J&&J.defaultView||window;if(H.getSelection){var G=H.getSelection(),De=w.textContent.length,Ae=Math.min(C.start,De),ht=C.end===void 0?Ae:Math.min(C.end,De);!G.extend&&Ae>ht&&(E=ht,ht=Ae,Ae=E);var U=a0(w,Ae),O=a0(w,ht);if(U&&O&&(G.rangeCount!==1||G.anchorNode!==U.node||G.anchorOffset!==U.offset||G.focusNode!==O.node||G.focusOffset!==O.offset)){var B=J.createRange();B.setStart(U.node,U.offset),G.removeAllRanges(),Ae>ht?(G.addRange(B),G.extend(O.node,O.offset)):(B.setEnd(O.node,O.offset),G.addRange(B))}}}}for(J=[],G=w;G=G.parentNode;)G.nodeType===1&&J.push({element:G,left:G.scrollLeft,top:G.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<J.length;w++){var $=J[w];$.element.scrollLeft=$.left,$.element.scrollTop=$.top}}Vh=!!op,lp=op=null}finally{rt=d,te.p=u,z.T=o}}n.current=r,un=2}}function Tv(){if(un===2){un=0;var n=yr,r=Do,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=z.T,z.T=null;var u=te.p;te.p=2;var d=rt;rt|=4;try{Jy(n,r.alternate,r)}finally{rt=d,te.p=u,z.T=o}}un=3}}function bv(){if(un===4||un===3){un=0,ls();var n=yr,r=Do,o=Oo,u=uv;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?un=5:(un=0,Do=yr=null,wv(n,n.pendingLanes));var d=n.pendingLanes;if(d===0&&(_r=null),rn(o),r=r.stateNode,Pe&&typeof Pe.onCommitFiberRoot=="function")try{Pe.onCommitFiberRoot(Et,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=z.T,d=te.p,te.p=2,z.T=null;try{for(var m=n.onRecoverableError,E=0;E<u.length;E++){var w=u[E];m(w.value,{componentStack:w.stack})}}finally{z.T=r,te.p=d}}(Oo&3)!==0&&Sh(),Gi(n),d=n.pendingLanes,(o&4194090)!==0&&(d&42)!==0?n===Ym?uu++:(uu=0,Ym=n):uu=0,cu(0)}}function wv(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,ql(r)))}function Sh(n){return Ev(),Tv(),bv(),Sv()}function Sv(){if(un!==5)return!1;var n=yr,r=Gm;Gm=0;var o=rn(Oo),u=z.T,d=te.p;try{te.p=32>o?32:o,z.T=null,o=Km,Km=null;var m=yr,E=Oo;if(un=0,Do=yr=null,Oo=0,(rt&6)!==0)throw Error(s(331));var w=rt;if(rt|=4,ov(m.current),sv(m,m.current,E,o),rt=w,cu(0,!1),Pe&&typeof Pe.onPostCommitFiberRoot=="function")try{Pe.onPostCommitFiberRoot(Et,m)}catch{}return!0}finally{te.p=d,z.T=u,wv(n,r)}}function Av(n,r,o){r=ni(o,r),r=Am(n.stateNode,r,2),n=lr(n,r,2),n!==null&&(Fe(n,2),Gi(n))}function ft(n,r,o){if(n.tag===3)Av(n,n,o);else for(;r!==null;){if(r.tag===3){Av(r,n,o);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(_r===null||!_r.has(u))){n=ni(o,n),o=xy(2),u=lr(r,o,2),u!==null&&(Ny(o,u,r,n),Fe(u,2),Gi(u));break}}r=r.return}}function Xm(n,r,o){var u=n.pingCache;if(u===null){u=n.pingCache=new tR;var d=new Set;u.set(r,d)}else d=u.get(r),d===void 0&&(d=new Set,u.set(r,d));d.has(o)||(Fm=!0,d.add(o),n=aR.bind(null,n,r,o),r.then(n,n))}function aR(n,r,o){var u=n.pingCache;u!==null&&u.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,mt===n&&(We&o)===o&&(Ct===4||Ct===3&&(We&62914560)===We&&300>An()-Hm?(rt&2)===0&&ko(n,0):zm|=o,No===We&&(No=0)),Gi(n)}function Rv(n,r){r===0&&(r=ge()),n=po(n,r),n!==null&&(Fe(n,r),Gi(n))}function oR(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),Rv(n,o)}function lR(n,r){var o=0;switch(n.tag){case 13:var u=n.stateNode,d=n.memoizedState;d!==null&&(o=d.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(r),Rv(n,o)}function uR(n,r){return as(n,r)}var Ah=null,Po=null,Jm=!1,Rh=!1,Zm=!1,Ca=0;function Gi(n){n!==Po&&n.next===null&&(Po===null?Ah=Po=n:Po=Po.next=n),Rh=!0,Jm||(Jm=!0,hR())}function cu(n,r){if(!Zm&&Rh){Zm=!0;do for(var o=!1,u=Ah;u!==null;){if(n!==0){var d=u.pendingLanes;if(d===0)var m=0;else{var E=u.suspendedLanes,w=u.pingedLanes;m=(1<<31-$t(42|n)+1)-1,m&=d&~(E&~w),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,Nv(u,m))}else m=We,m=Zs(u,u===mt?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(m&3)===0||fs(u,m)||(o=!0,Nv(u,m));u=u.next}while(o);Zm=!1}}function cR(){Cv()}function Cv(){Rh=Jm=!1;var n=0;Ca!==0&&(vR()&&(n=Ca),Ca=0);for(var r=An(),o=null,u=Ah;u!==null;){var d=u.next,m=Iv(u,r);m===0?(u.next=null,o===null?Ah=d:o.next=d,d===null&&(Po=o)):(o=u,(n!==0||(m&3)!==0)&&(Rh=!0)),u=d}cu(n)}function Iv(n,r){for(var o=n.suspendedLanes,u=n.pingedLanes,d=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var E=31-$t(m),w=1<<E,C=d[E];C===-1?((w&o)===0||(w&u)!==0)&&(d[E]=ie(w,r)):C<=r&&(n.expiredLanes|=w),m&=~w}if(r=mt,o=We,o=Zs(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,o===0||n===r&&(at===2||at===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&os(u),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||fs(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(u!==null&&os(u),rn(o)){case 2:case 8:o=Ni;break;case 32:o=pi;break;case 268435456:o=us;break;default:o=pi}return u=xv.bind(null,n),o=as(o,u),n.callbackPriority=r,n.callbackNode=o,r}return u!==null&&u!==null&&os(u),n.callbackPriority=2,n.callbackNode=null,2}function xv(n,r){if(un!==0&&un!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Sh()&&n.callbackNode!==o)return null;var u=We;return u=Zs(n,n===mt?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:(hv(n,u,r),Iv(n,An()),n.callbackNode!=null&&n.callbackNode===o?xv.bind(null,n):null)}function Nv(n,r){if(Sh())return null;hv(n,r,!0)}function hR(){TR(function(){(rt&6)!==0?as(Jr,cR):Cv()})}function ep(){return Ca===0&&(Ca=me()),Ca}function Dv(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:no(""+n)}function Ov(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function dR(n,r,o,u,d){if(r==="submit"&&o&&o.stateNode===d){var m=Dv((d[Pt]||null).action),E=u.submitter;E&&(r=(r=E[Pt]||null)?Dv(r.formAction):E.getAttribute("formAction"),r!==null&&(m=r,E=null));var w=new io("action","action",null,u,d);n.push({event:w,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Ca!==0){var C=E?Ov(d,E):new FormData(d);Em(o,{pending:!0,data:C,method:d.method,action:m},null,C)}}else typeof m=="function"&&(w.preventDefault(),C=E?Ov(d,E):new FormData(d),Em(o,{pending:!0,data:C,method:d.method,action:m},m,C))},currentTarget:d}]})}}for(var tp=0;tp<jf.length;tp++){var np=jf[tp],fR=np.toLowerCase(),mR=np[0].toUpperCase()+np.slice(1);vi(fR,"on"+mR)}vi(h0,"onAnimationEnd"),vi(d0,"onAnimationIteration"),vi(f0,"onAnimationStart"),vi("dblclick","onDoubleClick"),vi("focusin","onFocus"),vi("focusout","onBlur"),vi(DA,"onTransitionRun"),vi(OA,"onTransitionStart"),vi(kA,"onTransitionCancel"),vi(m0,"onTransitionEnd"),ps("onMouseEnter",["mouseout","mouseover"]),ps("onMouseLeave",["mouseout","mouseover"]),ps("onPointerEnter",["pointerout","pointerover"]),ps("onPointerLeave",["pointerout","pointerover"]),_i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_i("onBeforeInput",["compositionend","keypress","textInput","paste"]),_i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hu));function kv(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var u=n[o],d=u.event;u=u.listeners;e:{var m=void 0;if(r)for(var E=u.length-1;0<=E;E--){var w=u[E],C=w.instance,F=w.currentTarget;if(w=w.listener,C!==m&&d.isPropagationStopped())break e;m=w,d.currentTarget=F;try{m(d)}catch(Q){fh(Q)}d.currentTarget=null,m=C}else for(E=0;E<u.length;E++){if(w=u[E],C=w.instance,F=w.currentTarget,w=w.listener,C!==m&&d.isPropagationStopped())break e;m=w,d.currentTarget=F;try{m(d)}catch(Q){fh(Q)}d.currentTarget=null,m=C}}}}function He(n,r){var o=r[bl];o===void 0&&(o=r[bl]=new Set);var u=n+"__bubble";o.has(u)||(Mv(r,n,2,!1),o.add(u))}function ip(n,r,o){var u=0;r&&(u|=4),Mv(o,n,u,r)}var Ch="_reactListening"+Math.random().toString(36).slice(2);function sp(n){if(!n[Ch]){n[Ch]=!0,wl.forEach(function(o){o!=="selectionchange"&&(pR.has(o)||ip(o,!1,n),ip(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Ch]||(r[Ch]=!0,ip("selectionchange",!1,r))}}function Mv(n,r,o,u){switch(sE(r)){case 2:var d=zR;break;case 8:d=qR;break;default:d=yp}o=d.bind(null,r,o,n),d=void 0,!ei||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(d=!0),u?d!==void 0?n.addEventListener(r,o,{capture:!0,passive:d}):n.addEventListener(r,o,!0):d!==void 0?n.addEventListener(r,o,{passive:d}):n.addEventListener(r,o,!1)}function rp(n,r,o,u,d){var m=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var E=u.tag;if(E===3||E===4){var w=u.stateNode.containerInfo;if(w===d)break;if(E===4)for(E=u.return;E!==null;){var C=E.tag;if((C===3||C===4)&&E.stateNode.containerInfo===d)return;E=E.return}for(;w!==null;){if(E=ms(w),E===null)return;if(C=E.tag,C===5||C===6||C===26||C===27){u=m=E;continue e}w=w.parentNode}}u=u.return}xc(function(){var F=m,Q=Zn(o),J=[];e:{var H=p0.get(n);if(H!==void 0){var G=io,De=n;switch(n){case"keypress":if(Vi(o)===0)break e;case"keydown":case"keyup":G=uo;break;case"focusin":De="focus",G=ao;break;case"focusout":De="blur",G=ao;break;case"beforeblur":case"afterblur":G=ao;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":G=ti;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":G=Df;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":G=Lc;break;case h0:case d0:case f0:G=oo;break;case m0:G=jc;break;case"scroll":case"scrollend":G=Nc;break;case"wheel":G=co;break;case"copy":case"cut":case"paste":G=lo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":G=Pl;break;case"toggle":case"beforetoggle":G=Fc}var Ae=(r&4)!==0,ht=!Ae&&(n==="scroll"||n==="scrollend"),U=Ae?H!==null?H+"Capture":null:H;Ae=[];for(var O=F,B;O!==null;){var $=O;if(B=$.stateNode,$=$.tag,$!==5&&$!==26&&$!==27||B===null||U===null||($=aa(O,U),$!=null&&Ae.push(du(O,$,B))),ht)break;O=O.return}0<Ae.length&&(H=new G(H,De,null,o,Q),J.push({event:H,listeners:Ae}))}}if((r&7)===0){e:{if(H=n==="mouseover"||n==="pointerover",G=n==="mouseout"||n==="pointerout",H&&o!==ys&&(De=o.relatedTarget||o.fromElement)&&(ms(De)||De[Xn]))break e;if((G||H)&&(H=Q.window===Q?Q:(H=Q.ownerDocument)?H.defaultView||H.parentWindow:window,G?(De=o.relatedTarget||o.toElement,G=F,De=De?ms(De):null,De!==null&&(ht=l(De),Ae=De.tag,De!==ht||Ae!==5&&Ae!==27&&Ae!==6)&&(De=null)):(G=null,De=F),G!==De)){if(Ae=ti,$="onMouseLeave",U="onMouseEnter",O="mouse",(n==="pointerout"||n==="pointerover")&&(Ae=Pl,$="onPointerLeave",U="onPointerEnter",O="pointer"),ht=G==null?H:Oi(G),B=De==null?H:Oi(De),H=new Ae($,O+"leave",G,o,Q),H.target=ht,H.relatedTarget=B,$=null,ms(Q)===F&&(Ae=new Ae(U,O+"enter",De,o,Q),Ae.target=B,Ae.relatedTarget=ht,$=Ae),ht=$,G&&De)t:{for(Ae=G,U=De,O=0,B=Ae;B;B=Vo(B))O++;for(B=0,$=U;$;$=Vo($))B++;for(;0<O-B;)Ae=Vo(Ae),O--;for(;0<B-O;)U=Vo(U),B--;for(;O--;){if(Ae===U||U!==null&&Ae===U.alternate)break t;Ae=Vo(Ae),U=Vo(U)}Ae=null}else Ae=null;G!==null&&Pv(J,H,G,Ae,!1),De!==null&&ht!==null&&Pv(J,ht,De,Ae,!0)}}e:{if(H=F?Oi(F):window,G=H.nodeName&&H.nodeName.toLowerCase(),G==="select"||G==="input"&&H.type==="file")var _e=e0;else if(Gt(H))if(t0)_e=IA;else{_e=RA;var Be=AA}else G=H.nodeName,!G||G.toLowerCase()!=="input"||H.type!=="checkbox"&&H.type!=="radio"?F&&Il(F.elementType)&&(_e=e0):_e=CA;if(_e&&(_e=_e(n,F))){ws(J,_e,o,Q);break e}Be&&Be(n,H,F),n==="focusout"&&F&&H.type==="number"&&F.memoizedProps.value!=null&&ir(H,"number",H.value)}switch(Be=F?Oi(F):window,n){case"focusin":(Gt(Be)||Be.contentEditable==="true")&&(ho=Be,Vf=F,Ul=null);break;case"focusout":Ul=Vf=ho=null;break;case"mousedown":Lf=!0;break;case"contextmenu":case"mouseup":case"dragend":Lf=!1,u0(J,o,Q);break;case"selectionchange":if(NA)break;case"keydown":case"keyup":u0(J,o,Q)}var ve;if(ji)e:{switch(n){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else Qe?Y(n,o)&&(Ce="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Ce="onCompositionStart");Ce&&(v&&o.locale!=="ko"&&(Qe||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&Qe&&(ve=Nl()):(Pi=Q,sr="value"in Pi?Pi.value:Pi.textContent,Qe=!0)),Be=Ih(F,Ce),0<Be.length&&(Ce=new kl(Ce,n,null,o,Q),J.push({event:Ce,listeners:Be}),ve?Ce.data=ve:(ve=se(o),ve!==null&&(Ce.data=ve)))),(ve=_?Ht(n,o):$e(n,o))&&(Ce=Ih(F,"onBeforeInput"),0<Ce.length&&(Be=new kl("onBeforeInput","beforeinput",null,o,Q),J.push({event:Be,listeners:Ce}),Be.data=ve)),dR(J,n,F,o,Q)}kv(J,r)})}function du(n,r,o){return{instance:n,listener:r,currentTarget:o}}function Ih(n,r){for(var o=r+"Capture",u=[];n!==null;){var d=n,m=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||m===null||(d=aa(n,o),d!=null&&u.unshift(du(n,d,m)),d=aa(n,r),d!=null&&u.push(du(n,d,m))),n.tag===3)return u;n=n.return}return[]}function Vo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Pv(n,r,o,u,d){for(var m=r._reactName,E=[];o!==null&&o!==u;){var w=o,C=w.alternate,F=w.stateNode;if(w=w.tag,C!==null&&C===u)break;w!==5&&w!==26&&w!==27||F===null||(C=F,d?(F=aa(o,m),F!=null&&E.unshift(du(o,F,C))):d||(F=aa(o,m),F!=null&&E.push(du(o,F,C)))),o=o.return}E.length!==0&&n.push({event:r,listeners:E})}var gR=/\r\n?/g,_R=/\u0000|\uFFFD/g;function Vv(n){return(typeof n=="string"?n:""+n).replace(gR,`
`).replace(_R,"")}function Lv(n,r){return r=Vv(r),Vv(n)===r}function xh(){}function ct(n,r,o,u,d,m){switch(o){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||Jn(n,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&Jn(n,""+u);break;case"className":ki(n,"class",u);break;case"tabIndex":ki(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":ki(n,o,u);break;case"style":Cl(n,u,m);break;case"data":if(r!=="object"){ki(n,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(o);break}u=no(""+u),n.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&ct(n,r,"name",d.name,d,null),ct(n,r,"formEncType",d.formEncType,d,null),ct(n,r,"formMethod",d.formMethod,d,null),ct(n,r,"formTarget",d.formTarget,d,null)):(ct(n,r,"encType",d.encType,d,null),ct(n,r,"method",d.method,d,null),ct(n,r,"target",d.target,d,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(o);break}u=no(""+u),n.setAttribute(o,u);break;case"onClick":u!=null&&(n.onclick=xh);break;case"onScroll":u!=null&&He("scroll",n);break;case"onScrollEnd":u!=null&&He("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(o=u.__html,o!=null){if(d.children!=null)throw Error(s(60));n.innerHTML=o}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}o=no(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(o,""+u):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":u===!0?n.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(o,u):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(o,u):n.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(o):n.setAttribute(o,u);break;case"popover":He("beforetoggle",n),He("toggle",n),nr(n,"popover",u);break;case"xlinkActuate":an(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":an(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":an(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":an(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":an(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":an(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":an(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":an(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":an(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":nr(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=xf.get(o)||o,nr(n,o,u))}}function ap(n,r,o,u,d,m){switch(o){case"style":Cl(n,u,m);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(o=u.__html,o!=null){if(d.children!=null)throw Error(s(60));n.innerHTML=o}}break;case"children":typeof u=="string"?Jn(n,u):(typeof u=="number"||typeof u=="bigint")&&Jn(n,""+u);break;case"onScroll":u!=null&&He("scroll",n);break;case"onScrollEnd":u!=null&&He("scrollend",n);break;case"onClick":u!=null&&(n.onclick=xh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Xa.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(d=o.endsWith("Capture"),r=o.slice(2,d?o.length-7:void 0),m=n[Pt]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,d),typeof u=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,u,d);break e}o in n?n[o]=u:u===!0?n.setAttribute(o,""):nr(n,o,u)}}}function cn(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":He("error",n),He("load",n);var u=!1,d=!1,m;for(m in o)if(o.hasOwnProperty(m)){var E=o[m];if(E!=null)switch(m){case"src":u=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:ct(n,r,m,E,o,null)}}d&&ct(n,r,"srcSet",o.srcSet,o,null),u&&ct(n,r,"src",o.src,o,null);return;case"input":He("invalid",n);var w=m=E=d=null,C=null,F=null;for(u in o)if(o.hasOwnProperty(u)){var Q=o[u];if(Q!=null)switch(u){case"name":d=Q;break;case"type":E=Q;break;case"checked":C=Q;break;case"defaultChecked":F=Q;break;case"value":m=Q;break;case"defaultValue":w=Q;break;case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(s(137,r));break;default:ct(n,r,u,Q,o,null)}}ia(n,m,w,C,F,E,d,!1),to(n);return;case"select":He("invalid",n),u=E=m=null;for(d in o)if(o.hasOwnProperty(d)&&(w=o[d],w!=null))switch(d){case"value":m=w;break;case"defaultValue":E=w;break;case"multiple":u=w;default:ct(n,r,d,w,o,null)}r=m,o=E,n.multiple=!!u,r!=null?_s(n,!!u,r,!1):o!=null&&_s(n,!!u,o,!0);return;case"textarea":He("invalid",n),m=d=u=null;for(E in o)if(o.hasOwnProperty(E)&&(w=o[E],w!=null))switch(E){case"value":u=w;break;case"defaultValue":d=w;break;case"children":m=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(s(91));break;default:ct(n,r,E,w,o,null)}sa(n,u,d,m),to(n);return;case"option":for(C in o)if(o.hasOwnProperty(C)&&(u=o[C],u!=null))switch(C){case"selected":n.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ct(n,r,C,u,o,null)}return;case"dialog":He("beforetoggle",n),He("toggle",n),He("cancel",n),He("close",n);break;case"iframe":case"object":He("load",n);break;case"video":case"audio":for(u=0;u<hu.length;u++)He(hu[u],n);break;case"image":He("error",n),He("load",n);break;case"details":He("toggle",n);break;case"embed":case"source":case"link":He("error",n),He("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in o)if(o.hasOwnProperty(F)&&(u=o[F],u!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:ct(n,r,F,u,o,null)}return;default:if(Il(r)){for(Q in o)o.hasOwnProperty(Q)&&(u=o[Q],u!==void 0&&ap(n,r,Q,u,o,void 0));return}}for(w in o)o.hasOwnProperty(w)&&(u=o[w],u!=null&&ct(n,r,w,u,o,null))}function yR(n,r,o,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,m=null,E=null,w=null,C=null,F=null,Q=null;for(G in o){var J=o[G];if(o.hasOwnProperty(G)&&J!=null)switch(G){case"checked":break;case"value":break;case"defaultValue":C=J;default:u.hasOwnProperty(G)||ct(n,r,G,null,u,J)}}for(var H in u){var G=u[H];if(J=o[H],u.hasOwnProperty(H)&&(G!=null||J!=null))switch(H){case"type":m=G;break;case"name":d=G;break;case"checked":F=G;break;case"defaultChecked":Q=G;break;case"value":E=G;break;case"defaultValue":w=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(s(137,r));break;default:G!==J&&ct(n,r,H,G,u,J)}}jn(n,E,w,C,F,Q,m,d);return;case"select":G=E=w=H=null;for(m in o)if(C=o[m],o.hasOwnProperty(m)&&C!=null)switch(m){case"value":break;case"multiple":G=C;default:u.hasOwnProperty(m)||ct(n,r,m,null,u,C)}for(d in u)if(m=u[d],C=o[d],u.hasOwnProperty(d)&&(m!=null||C!=null))switch(d){case"value":H=m;break;case"defaultValue":w=m;break;case"multiple":E=m;default:m!==C&&ct(n,r,d,m,u,C)}r=w,o=E,u=G,H!=null?_s(n,!!o,H,!1):!!u!=!!o&&(r!=null?_s(n,!!o,r,!0):_s(n,!!o,o?[]:"",!1));return;case"textarea":G=H=null;for(w in o)if(d=o[w],o.hasOwnProperty(w)&&d!=null&&!u.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:ct(n,r,w,null,u,d)}for(E in u)if(d=u[E],m=o[E],u.hasOwnProperty(E)&&(d!=null||m!=null))switch(E){case"value":H=d;break;case"defaultValue":G=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(s(91));break;default:d!==m&&ct(n,r,E,d,u,m)}lt(n,H,G);return;case"option":for(var De in o)if(H=o[De],o.hasOwnProperty(De)&&H!=null&&!u.hasOwnProperty(De))switch(De){case"selected":n.selected=!1;break;default:ct(n,r,De,null,u,H)}for(C in u)if(H=u[C],G=o[C],u.hasOwnProperty(C)&&H!==G&&(H!=null||G!=null))switch(C){case"selected":n.selected=H&&typeof H!="function"&&typeof H!="symbol";break;default:ct(n,r,C,H,u,G)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in o)H=o[Ae],o.hasOwnProperty(Ae)&&H!=null&&!u.hasOwnProperty(Ae)&&ct(n,r,Ae,null,u,H);for(F in u)if(H=u[F],G=o[F],u.hasOwnProperty(F)&&H!==G&&(H!=null||G!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(s(137,r));break;default:ct(n,r,F,H,u,G)}return;default:if(Il(r)){for(var ht in o)H=o[ht],o.hasOwnProperty(ht)&&H!==void 0&&!u.hasOwnProperty(ht)&&ap(n,r,ht,void 0,u,H);for(Q in u)H=u[Q],G=o[Q],!u.hasOwnProperty(Q)||H===G||H===void 0&&G===void 0||ap(n,r,Q,H,u,G);return}}for(var U in o)H=o[U],o.hasOwnProperty(U)&&H!=null&&!u.hasOwnProperty(U)&&ct(n,r,U,null,u,H);for(J in u)H=u[J],G=o[J],!u.hasOwnProperty(J)||H===G||H==null&&G==null||ct(n,r,J,H,u,G)}var op=null,lp=null;function Nh(n){return n.nodeType===9?n:n.ownerDocument}function Uv(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jv(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function up(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var cp=null;function vR(){var n=window.event;return n&&n.type==="popstate"?n===cp?!1:(cp=n,!0):(cp=null,!1)}var Bv=typeof setTimeout=="function"?setTimeout:void 0,ER=typeof clearTimeout=="function"?clearTimeout:void 0,Fv=typeof Promise=="function"?Promise:void 0,TR=typeof queueMicrotask=="function"?queueMicrotask:typeof Fv<"u"?function(n){return Fv.resolve(null).then(n).catch(bR)}:Bv;function bR(n){setTimeout(function(){throw n})}function Er(n){return n==="head"}function zv(n,r){var o=r,u=0,d=0;do{var m=o.nextSibling;if(n.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"){if(0<u&&8>u){o=u;var E=n.ownerDocument;if(o&1&&fu(E.documentElement),o&2&&fu(E.body),o&4)for(o=E.head,fu(o),E=o.firstChild;E;){var w=E.nextSibling,C=E.nodeName;E[Zr]||C==="SCRIPT"||C==="STYLE"||C==="LINK"&&E.rel.toLowerCase()==="stylesheet"||o.removeChild(E),E=w}}if(d===0){n.removeChild(m),Tu(r);return}d--}else o==="$"||o==="$?"||o==="$!"?d++:u=o.charCodeAt(0)-48;else u=0;o=m}while(o);Tu(r)}function hp(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":hp(o),tr(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function wR(n,r,o,u){for(;n.nodeType===1;){var d=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[Zr])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==d.rel||n.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||n.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||n.getAttribute("title")!==(d.title==null?null:d.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(d.src==null?null:d.src)||n.getAttribute("type")!==(d.type==null?null:d.type)||n.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=d.name==null?null:""+d.name;if(d.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Ti(n.nextSibling),n===null)break}return null}function SR(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Ti(n.nextSibling),n===null))return null;return n}function dp(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function AR(n,r){var o=n.ownerDocument;if(n.data!=="$?"||o.readyState==="complete")r();else{var u=function(){r(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function Ti(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return n}var fp=null;function qv(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"){if(r===0)return n;r--}else o==="/$"&&r++}n=n.previousSibling}return null}function Hv(n,r,o){switch(r=Nh(o),n){case"html":if(n=r.documentElement,!n)throw Error(s(452));return n;case"head":if(n=r.head,!n)throw Error(s(453));return n;case"body":if(n=r.body,!n)throw Error(s(454));return n;default:throw Error(s(451))}}function fu(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);tr(n)}var li=new Map,Gv=new Set;function Dh(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Vs=te.d;te.d={f:RR,r:CR,D:IR,C:xR,L:NR,m:DR,X:kR,S:OR,M:MR};function RR(){var n=Vs.f(),r=bh();return n||r}function CR(n){var r=Di(n);r!==null&&r.tag===5&&r.type==="form"?hy(r):Vs.r(n)}var Lo=typeof document>"u"?null:document;function Kv(n,r,o){var u=Lo;if(u&&typeof r=="string"&&r){var d=Vt(r);d='link[rel="'+n+'"][href="'+d+'"]',typeof o=="string"&&(d+='[crossorigin="'+o+'"]'),Gv.has(d)||(Gv.add(d),n={rel:n,crossOrigin:o,href:r},u.querySelector(d)===null&&(r=u.createElement("link"),cn(r,"link",n),Nt(r),u.head.appendChild(r)))}}function IR(n){Vs.D(n),Kv("dns-prefetch",n,null)}function xR(n,r){Vs.C(n,r),Kv("preconnect",n,r)}function NR(n,r,o){Vs.L(n,r,o);var u=Lo;if(u&&n&&r){var d='link[rel="preload"][as="'+Vt(r)+'"]';r==="image"&&o&&o.imageSrcSet?(d+='[imagesrcset="'+Vt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(d+='[imagesizes="'+Vt(o.imageSizes)+'"]')):d+='[href="'+Vt(n)+'"]';var m=d;switch(r){case"style":m=Uo(n);break;case"script":m=jo(n)}li.has(m)||(n=y({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),li.set(m,n),u.querySelector(d)!==null||r==="style"&&u.querySelector(mu(m))||r==="script"&&u.querySelector(pu(m))||(r=u.createElement("link"),cn(r,"link",n),Nt(r),u.head.appendChild(r)))}}function DR(n,r){Vs.m(n,r);var o=Lo;if(o&&n){var u=r&&typeof r.as=="string"?r.as:"script",d='link[rel="modulepreload"][as="'+Vt(u)+'"][href="'+Vt(n)+'"]',m=d;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=jo(n)}if(!li.has(m)&&(n=y({rel:"modulepreload",href:n},r),li.set(m,n),o.querySelector(d)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(pu(m)))return}u=o.createElement("link"),cn(u,"link",n),Nt(u),o.head.appendChild(u)}}}function OR(n,r,o){Vs.S(n,r,o);var u=Lo;if(u&&n){var d=Cn(u).hoistableStyles,m=Uo(n);r=r||"default";var E=d.get(m);if(!E){var w={loading:0,preload:null};if(E=u.querySelector(mu(m)))w.loading=5;else{n=y({rel:"stylesheet",href:n,"data-precedence":r},o),(o=li.get(m))&&mp(n,o);var C=E=u.createElement("link");Nt(C),cn(C,"link",n),C._p=new Promise(function(F,Q){C.onload=F,C.onerror=Q}),C.addEventListener("load",function(){w.loading|=1}),C.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Oh(E,r,u)}E={type:"stylesheet",instance:E,count:1,state:w},d.set(m,E)}}}function kR(n,r){Vs.X(n,r);var o=Lo;if(o&&n){var u=Cn(o).hoistableScripts,d=jo(n),m=u.get(d);m||(m=o.querySelector(pu(d)),m||(n=y({src:n,async:!0},r),(r=li.get(d))&&pp(n,r),m=o.createElement("script"),Nt(m),cn(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(d,m))}}function MR(n,r){Vs.M(n,r);var o=Lo;if(o&&n){var u=Cn(o).hoistableScripts,d=jo(n),m=u.get(d);m||(m=o.querySelector(pu(d)),m||(n=y({src:n,async:!0,type:"module"},r),(r=li.get(d))&&pp(n,r),m=o.createElement("script"),Nt(m),cn(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(d,m))}}function Yv(n,r,o,u){var d=(d=Ne.current)?Dh(d):null;if(!d)throw Error(s(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Uo(o.href),o=Cn(d).hoistableStyles,u=o.get(r),u||(u={type:"style",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Uo(o.href);var m=Cn(d).hoistableStyles,E=m.get(n);if(E||(d=d.ownerDocument||d,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,E),(m=d.querySelector(mu(n)))&&!m._p&&(E.instance=m,E.state.loading=5),li.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},li.set(n,o),m||PR(d,n,o,E.state))),r&&u===null)throw Error(s(528,""));return E}if(r&&u!==null)throw Error(s(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=jo(o),o=Cn(d).hoistableScripts,u=o.get(r),u||(u={type:"script",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,n))}}function Uo(n){return'href="'+Vt(n)+'"'}function mu(n){return'link[rel="stylesheet"]['+n+"]"}function Qv(n){return y({},n,{"data-precedence":n.precedence,precedence:null})}function PR(n,r,o,u){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=n.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),cn(r,"link",o),Nt(r),n.head.appendChild(r))}function jo(n){return'[src="'+Vt(n)+'"]'}function pu(n){return"script[async]"+n}function $v(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var u=n.querySelector('style[data-href~="'+Vt(o.href)+'"]');if(u)return r.instance=u,Nt(u),u;var d=y({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),Nt(u),cn(u,"style",d),Oh(u,o.precedence,n),r.instance=u;case"stylesheet":d=Uo(o.href);var m=n.querySelector(mu(d));if(m)return r.state.loading|=4,r.instance=m,Nt(m),m;u=Qv(o),(d=li.get(d))&&mp(u,d),m=(n.ownerDocument||n).createElement("link"),Nt(m);var E=m;return E._p=new Promise(function(w,C){E.onload=w,E.onerror=C}),cn(m,"link",u),r.state.loading|=4,Oh(m,o.precedence,n),r.instance=m;case"script":return m=jo(o.src),(d=n.querySelector(pu(m)))?(r.instance=d,Nt(d),d):(u=o,(d=li.get(m))&&(u=y({},o),pp(u,d)),n=n.ownerDocument||n,d=n.createElement("script"),Nt(d),cn(d,"link",u),n.head.appendChild(d),r.instance=d);case"void":return null;default:throw Error(s(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Oh(u,o.precedence,n));return r.instance}function Oh(n,r,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=u.length?u[u.length-1]:null,m=d,E=0;E<u.length;E++){var w=u[E];if(w.dataset.precedence===r)m=w;else if(m!==d)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function mp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function pp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var kh=null;function Wv(n,r,o){if(kh===null){var u=new Map,d=kh=new Map;d.set(o,u)}else d=kh,u=d.get(o),u||(u=new Map,d.set(o,u));if(u.has(n))return u;for(u.set(n,null),o=o.getElementsByTagName(n),d=0;d<o.length;d++){var m=o[d];if(!(m[Zr]||m[qt]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var E=m.getAttribute(r)||"";E=n+E;var w=u.get(E);w?w.push(m):u.set(E,[m])}}return u}function Xv(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function VR(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return n=r.disabled,typeof r.precedence=="string"&&n==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Jv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var gu=null;function LR(){}function UR(n,r,o){if(gu===null)throw Error(s(475));var u=gu;if(r.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var d=Uo(o.href),m=n.querySelector(mu(d));if(m){n=m._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(u.count++,u=Mh.bind(u),n.then(u,u)),r.state.loading|=4,r.instance=m,Nt(m);return}m=n.ownerDocument||n,o=Qv(o),(d=li.get(d))&&mp(o,d),m=m.createElement("link"),Nt(m);var E=m;E._p=new Promise(function(w,C){E.onload=w,E.onerror=C}),cn(m,"link",o),r.instance=m}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(r,n),(n=r.state.preload)&&(r.state.loading&3)===0&&(u.count++,r=Mh.bind(u),n.addEventListener("load",r),n.addEventListener("error",r))}}function jR(){if(gu===null)throw Error(s(475));var n=gu;return n.stylesheets&&n.count===0&&gp(n,n.stylesheets),0<n.count?function(r){var o=setTimeout(function(){if(n.stylesheets&&gp(n,n.stylesheets),n.unsuspend){var u=n.unsuspend;n.unsuspend=null,u()}},6e4);return n.unsuspend=r,function(){n.unsuspend=null,clearTimeout(o)}}:null}function Mh(){if(this.count--,this.count===0){if(this.stylesheets)gp(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Ph=null;function gp(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Ph=new Map,r.forEach(BR,n),Ph=null,Mh.call(n))}function BR(n,r){if(!(r.state.loading&4)){var o=Ph.get(n);if(o)var u=o.get(null);else{o=new Map,Ph.set(n,o);for(var d=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<d.length;m++){var E=d[m];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),u=E)}u&&o.set(null,u)}d=r.instance,E=d.getAttribute("data-precedence"),m=o.get(E)||u,m===u&&o.set(null,d),o.set(E,d),this.count++,u=Mh.bind(this),d.addEventListener("load",u),d.addEventListener("error",u),m?m.parentNode.insertBefore(d,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(d,n.firstChild)),r.state.loading|=4}}var _u={$$typeof:ce,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function FR(n,r,o,u,d,m,E,w){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ee(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ee(0),this.hiddenUpdates=Ee(null),this.identifierPrefix=u,this.onUncaughtError=d,this.onCaughtError=m,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function Zv(n,r,o,u,d,m,E,w,C,F,Q,J){return n=new FR(n,r,o,E,w,C,F,J),r=1,m===!0&&(r|=24),m=Fn(3,null,null,r),n.current=m,m.stateNode=n,r=Xf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:u,isDehydrated:o,cache:r},tm(m),n}function eE(n){return n?(n=go,n):go}function tE(n,r,o,u,d,m){d=eE(d),u.context===null?u.context=d:u.pendingContext=d,u=or(r),u.payload={element:o},m=m===void 0?null:m,m!==null&&(u.callback=m),o=lr(n,u,r),o!==null&&(Kn(o,n,r),Yl(o,n,r))}function nE(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function _p(n,r){nE(n,r),(n=n.alternate)&&nE(n,r)}function iE(n){if(n.tag===13){var r=po(n,67108864);r!==null&&Kn(r,n,67108864),_p(n,67108864)}}var Vh=!0;function zR(n,r,o,u){var d=z.T;z.T=null;var m=te.p;try{te.p=2,yp(n,r,o,u)}finally{te.p=m,z.T=d}}function qR(n,r,o,u){var d=z.T;z.T=null;var m=te.p;try{te.p=8,yp(n,r,o,u)}finally{te.p=m,z.T=d}}function yp(n,r,o,u){if(Vh){var d=vp(u);if(d===null)rp(n,r,u,Lh,o),rE(n,u);else if(GR(d,n,r,o,u))u.stopPropagation();else if(rE(n,u),r&4&&-1<HR.indexOf(n)){for(;d!==null;){var m=Di(d);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var E=Un(m.pendingLanes);if(E!==0){var w=m;for(w.pendingLanes|=2,w.entangledLanes|=2;E;){var C=1<<31-$t(E);w.entanglements[1]|=C,E&=~C}Gi(m),(rt&6)===0&&(Eh=An()+500,cu(0))}}break;case 13:w=po(m,2),w!==null&&Kn(w,m,2),bh(),_p(m,2)}if(m=vp(u),m===null&&rp(n,r,u,Lh,o),m===d)break;d=m}d!==null&&u.stopPropagation()}else rp(n,r,u,null,o)}}function vp(n){return n=Zn(n),Ep(n)}var Lh=null;function Ep(n){if(Lh=null,n=ms(n),n!==null){var r=l(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=c(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Lh=n,null}function sE(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(vl()){case Jr:return 2;case Ni:return 8;case pi:case El:return 32;case us:return 268435456;default:return 32}default:return 32}}var Tp=!1,Tr=null,br=null,wr=null,yu=new Map,vu=new Map,Sr=[],HR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rE(n,r){switch(n){case"focusin":case"focusout":Tr=null;break;case"dragenter":case"dragleave":br=null;break;case"mouseover":case"mouseout":wr=null;break;case"pointerover":case"pointerout":yu.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":vu.delete(r.pointerId)}}function Eu(n,r,o,u,d,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:u,nativeEvent:m,targetContainers:[d]},r!==null&&(r=Di(r),r!==null&&iE(r)),n):(n.eventSystemFlags|=u,r=n.targetContainers,d!==null&&r.indexOf(d)===-1&&r.push(d),n)}function GR(n,r,o,u,d){switch(r){case"focusin":return Tr=Eu(Tr,n,r,o,u,d),!0;case"dragenter":return br=Eu(br,n,r,o,u,d),!0;case"mouseover":return wr=Eu(wr,n,r,o,u,d),!0;case"pointerover":var m=d.pointerId;return yu.set(m,Eu(yu.get(m)||null,n,r,o,u,d)),!0;case"gotpointercapture":return m=d.pointerId,vu.set(m,Eu(vu.get(m)||null,n,r,o,u,d)),!0}return!1}function aE(n){var r=ms(n.target);if(r!==null){var o=l(r);if(o!==null){if(r=o.tag,r===13){if(r=c(o),r!==null){n.blockedOn=r,bc(n.priority,function(){if(o.tag===13){var u=Gn();u=xt(u);var d=po(o,u);d!==null&&Kn(d,o,u),_p(o,u)}});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Uh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=vp(n.nativeEvent);if(o===null){o=n.nativeEvent;var u=new o.constructor(o.type,o);ys=u,o.target.dispatchEvent(u),ys=null}else return r=Di(o),r!==null&&iE(r),n.blockedOn=o,!1;r.shift()}return!0}function oE(n,r,o){Uh(n)&&o.delete(r)}function KR(){Tp=!1,Tr!==null&&Uh(Tr)&&(Tr=null),br!==null&&Uh(br)&&(br=null),wr!==null&&Uh(wr)&&(wr=null),yu.forEach(oE),vu.forEach(oE)}function jh(n,r){n.blockedOn===r&&(n.blockedOn=null,Tp||(Tp=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,KR)))}var Bh=null;function lE(n){Bh!==n&&(Bh=n,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Bh===n&&(Bh=null);for(var r=0;r<n.length;r+=3){var o=n[r],u=n[r+1],d=n[r+2];if(typeof u!="function"){if(Ep(u||o)===null)continue;break}var m=Di(o);m!==null&&(n.splice(r,3),r-=3,Em(m,{pending:!0,data:d,method:o.method,action:u},u,d))}}))}function Tu(n){function r(C){return jh(C,n)}Tr!==null&&jh(Tr,n),br!==null&&jh(br,n),wr!==null&&jh(wr,n),yu.forEach(r),vu.forEach(r);for(var o=0;o<Sr.length;o++){var u=Sr[o];u.blockedOn===n&&(u.blockedOn=null)}for(;0<Sr.length&&(o=Sr[0],o.blockedOn===null);)aE(o),o.blockedOn===null&&Sr.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var d=o[u],m=o[u+1],E=d[Pt]||null;if(typeof m=="function")E||lE(o);else if(E){var w=null;if(m&&m.hasAttribute("formAction")){if(d=m,E=m[Pt]||null)w=E.formAction;else if(Ep(d)!==null)continue}else w=E.action;typeof w=="function"?o[u+1]=w:(o.splice(u,3),u-=3),lE(o)}}}function bp(n){this._internalRoot=n}Fh.prototype.render=bp.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(s(409));var o=r.current,u=Gn();tE(o,u,n,r,null,null)},Fh.prototype.unmount=bp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;tE(n.current,2,null,n,null,null),bh(),r[Xn]=null}};function Fh(n){this._internalRoot=n}Fh.prototype.unstable_scheduleHydration=function(n){if(n){var r=gi();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Sr.length&&r!==0&&r<Sr[o].priority;o++);Sr.splice(o,0,n),o===0&&aE(n)}};var uE=e.version;if(uE!=="19.1.0")throw Error(s(527,uE,"19.1.0"));te.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(s(188)):(n=Object.keys(n).join(","),Error(s(268,n)));return n=p(r),n=n!==null?g(n):null,n=n===null?null:n.stateNode,n};var YR={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zh.isDisabled&&zh.supportsFiber)try{Et=zh.inject(YR),Pe=zh}catch{}}return wu.createRoot=function(n,r){if(!a(n))throw Error(s(299));var o=!1,u="",d=Ay,m=Ry,E=Cy,w=null;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(d=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(w=r.unstable_transitionCallbacks)),r=Zv(n,1,!1,null,null,o,u,d,m,E,w,null),n[Xn]=r.current,sp(n),new bp(r)},wu.hydrateRoot=function(n,r,o){if(!a(n))throw Error(s(299));var u=!1,d="",m=Ay,E=Ry,w=Cy,C=null,F=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(w=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(C=o.unstable_transitionCallbacks),o.formState!==void 0&&(F=o.formState)),r=Zv(n,1,!0,r,o??null,u,d,m,E,w,C,F),r.context=eE(null),o=r.current,u=Gn(),u=xt(u),d=or(u),d.callback=null,lr(o,d,u),o=u,r.current.lanes=o,Fe(r,o),Gi(r),n[Xn]=r.current,sp(n),new Fh(r)},wu.version="19.1.0",wu}var EE;function sC(){if(EE)return Ap.exports;EE=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Ap.exports=iC(),Ap.exports}var rC=sC();const aC=()=>{};var TE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jb={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le=function(i,e){if(!i)throw ul(e)},ul=function(i){return new Error("Firebase Database ("+jb.SDK_VERSION+") INTERNAL ASSERT FAILED: "+i)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bb=function(i){const e=[];let t=0;for(let s=0;s<i.length;s++){let a=i.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<i.length&&(i.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(i.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},oC=function(i){const e=[];let t=0,s=0;for(;t<i.length;){const a=i[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=i[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=i[t++],c=i[t++],f=i[t++],p=((a&7)<<18|(l&63)<<12|(c&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(p>>10)),e[s++]=String.fromCharCode(56320+(p&1023))}else{const l=i[t++],c=i[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},Pg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<i.length;a+=3){const l=i[a],c=a+1<i.length,f=c?i[a+1]:0,p=a+2<i.length,g=p?i[a+2]:0,y=l>>2,b=(l&3)<<4|f>>4;let S=(f&15)<<2|g>>6,P=g&63;p||(P=64,c||(S=64)),s.push(t[y],t[b],t[S],t[P])}return s.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(Bb(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):oC(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<i.length;){const l=t[i.charAt(a++)],f=a<i.length?t[i.charAt(a)]:0;++a;const g=a<i.length?t[i.charAt(a)]:64;++a;const b=a<i.length?t[i.charAt(a)]:64;if(++a,l==null||f==null||g==null||b==null)throw new lC;const S=l<<2|f>>4;if(s.push(S),g!==64){const P=f<<4&240|g>>2;if(s.push(P),b!==64){const k=g<<6&192|b;s.push(k)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class lC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Fb=function(i){const e=Bb(i);return Pg.encodeByteArray(e,!0)},cd=function(i){return Fb(i).replace(/\./g,"")},hd=function(i){try{return Pg.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uC(i){return zb(void 0,i)}function zb(i,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:i===void 0&&(i={});break;case Array:i=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!cC(t)||(i[t]=zb(i[t],e[t]));return i}function cC(i){return i!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=()=>hC().__FIREBASE_DEFAULTS__,fC=()=>{if(typeof process>"u"||typeof TE>"u")return;const i=TE.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},mC=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&hd(i[1]);return e&&JSON.parse(e)},Hd=()=>{try{return aC()||dC()||fC()||mC()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},qb=i=>{var e,t;return(t=(e=Hd())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[i]},Vg=i=>{const e=qb(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},Hb=()=>{var i;return(i=Hd())===null||i===void 0?void 0:i.config},Gb=i=>{var e;return(e=Hd())===null||e===void 0?void 0:e[`_${i}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $s(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Gd(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kb(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=i.iat||0,l=i.sub||i.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},i);return[cd(JSON.stringify(t)),cd(JSON.stringify(c)),""].join(".")}const Pu={};function pC(){const i={prod:[],emulator:[]};for(const e of Object.keys(Pu))Pu[e]?i.emulator.push(e):i.prod.push(e);return i}function gC(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let bE=!1;function Kd(i,e){if(typeof window>"u"||typeof document>"u"||!$s(window.location.host)||Pu[i]===e||Pu[i]||bE)return;Pu[i]=e;function t(S){return`__firebase__banner__${S}`}const s="__firebase__banner",l=pC().prod.length>0;function c(){const S=document.getElementById(s);S&&S.remove()}function f(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function p(S,P){S.setAttribute("width","24"),S.setAttribute("id",P),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function g(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{bE=!0,c()},S}function y(S,P){S.setAttribute("id",P),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function b(){const S=gC(s),P=t("text"),k=document.getElementById(P)||document.createElement("span"),q=t("learnmore"),K=document.getElementById(q)||document.createElement("a"),pe=t("preprendIcon"),ae=document.getElementById(pe)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const ce=S.element;f(ce),y(K,q);const Te=g();p(ae,pe),ce.append(ae,k,K,Te),document.body.appendChild(ce)}l?(k.innerText="Preview backend disconnected.",ae.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ae.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",P)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ug(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Sn())}function _C(){var i;const e=(i=Hd())===null||i===void 0?void 0:i.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vC(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function Yb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function EC(){const i=Sn();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function TC(){return jb.NODE_ADMIN===!0}function bC(){return!_C()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function wC(){try{return typeof indexedDB=="object"}catch{return!1}}function SC(){return new Promise((i,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),i(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC="FirebaseError";class ss extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=AC,Object.setPrototypeOf(this,ss.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,sc.prototype.create)}}class sc{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?RC(l,s):"Error",f=`${this.serviceName}: ${c} (${a}).`;return new ss(a,f,s)}}function RC(i,e){return i.replace(CC,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const CC=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gu(i){return JSON.parse(i)}function dn(i){return JSON.stringify(i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb=function(i){let e={},t={},s={},a="";try{const l=i.split(".");e=Gu(hd(l[0])||""),t=Gu(hd(l[1])||""),a=l[2],s=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:s,signature:a}},IC=function(i){const e=Qb(i),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},xC=function(i){const e=Qb(i).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(i,e){return Object.prototype.hasOwnProperty.call(i,e)}function el(i,e){if(Object.prototype.hasOwnProperty.call(i,e))return i[e]}function Yp(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function dd(i,e,t){const s={};for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&(s[a]=e.call(t,i[a],a,i));return s}function Ur(i,e){if(i===e)return!0;const t=Object.keys(i),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=i[a],c=e[a];if(wE(l)&&wE(c)){if(!Ur(l,c))return!1}else if(l!==c)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function wE(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cl(i){const e=[];for(const[t,s]of Object.entries(i))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Iu(i){const e={};return i.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function xu(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const s=this.W_;if(typeof e=="string")for(let b=0;b<16;b++)s[b]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let b=0;b<16;b++)s[b]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let b=16;b<80;b++){const S=s[b-3]^s[b-8]^s[b-14]^s[b-16];s[b]=(S<<1|S>>>31)&4294967295}let a=this.chain_[0],l=this.chain_[1],c=this.chain_[2],f=this.chain_[3],p=this.chain_[4],g,y;for(let b=0;b<80;b++){b<40?b<20?(g=f^l&(c^f),y=1518500249):(g=l^c^f,y=1859775393):b<60?(g=l&c|f&(l|c),y=2400959708):(g=l^c^f,y=3395469782);const S=(a<<5|a>>>27)+g+p+y+s[b]&4294967295;p=f,f=c,c=(l<<30|l>>>2)&4294967295,l=a,a=S}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+p&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const s=t-this.blockSize;let a=0;const l=this.buf_;let c=this.inbuf_;for(;a<t;){if(c===0)for(;a<=s;)this.compress_(e,a),a+=this.blockSize;if(typeof e=="string"){for(;a<t;)if(l[c]=e.charCodeAt(a),++c,++a,c===this.blockSize){this.compress_(l),c=0;break}}else for(;a<t;)if(l[c]=e[a],++c,++a,c===this.blockSize){this.compress_(l),c=0;break}}this.inbuf_=c,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let a=this.blockSize-1;a>=56;a--)this.buf_[a]=t&255,t/=256;this.compress_(this.buf_);let s=0;for(let a=0;a<5;a++)for(let l=24;l>=0;l-=8)e[s]=this.chain_[a]>>l&255,++s;return e}}function DC(i,e){const t=new OC(i,e);return t.subscribe.bind(t)}class OC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");kC(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=xp),a.error===void 0&&(a.error=xp),a.complete===void 0&&(a.complete=xp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kC(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function xp(){}function MC(i,e){return`${i} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PC=function(i){const e=[];let t=0;for(let s=0;s<i.length;s++){let a=i.charCodeAt(s);if(a>=55296&&a<=56319){const l=a-55296;s++,le(s<i.length,"Surrogate pair missing trail surrogate.");const c=i.charCodeAt(s)-56320;a=65536+(l<<10)+c}a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):a<65536?(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},Yd=function(i){let e=0;for(let t=0;t<i.length;t++){const s=i.charCodeAt(t);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(i){return i&&i._delegate?i._delegate:i}class qs{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new Lg;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e?.identifier),a=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(UC(e))try{this.getOrInitializeService({instanceIdentifier:Ia})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=Ia){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ia){return this.instances.has(e)}getOptions(e=Ia){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,c]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&c.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const c=this.instances.get(a);return c&&e(c,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:LC(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Ia){return this.component?this.component.multipleInstances?e:Ia:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function LC(i){return i===Ia?void 0:i}function UC(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new VC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ge;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Ge||(Ge={}));const BC={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},FC=Ge.INFO,zC={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},qC=(i,e,...t)=>{if(e<i.logLevel)return;const s=new Date().toISOString(),a=zC[e];if(a)console[a](`[${s}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Qd{constructor(e){this.name=e,this._logLevel=FC,this._logHandler=qC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?BC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...e),this._logHandler(this,Ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...e),this._logHandler(this,Ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...e),this._logHandler(this,Ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...e),this._logHandler(this,Ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...e),this._logHandler(this,Ge.ERROR,...e)}}const HC=(i,e)=>e.some(t=>i instanceof t);let SE,AE;function GC(){return SE||(SE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function KC(){return AE||(AE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $b=new WeakMap,Qp=new WeakMap,Wb=new WeakMap,Np=new WeakMap,jg=new WeakMap;function YC(i){const e=new Promise((t,s)=>{const a=()=>{i.removeEventListener("success",l),i.removeEventListener("error",c)},l=()=>{t(kr(i.result)),a()},c=()=>{s(i.error),a()};i.addEventListener("success",l),i.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&$b.set(t,i)}).catch(()=>{}),jg.set(e,i),e}function QC(i){if(Qp.has(i))return;const e=new Promise((t,s)=>{const a=()=>{i.removeEventListener("complete",l),i.removeEventListener("error",c),i.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{s(i.error||new DOMException("AbortError","AbortError")),a()};i.addEventListener("complete",l),i.addEventListener("error",c),i.addEventListener("abort",c)});Qp.set(i,e)}let $p={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return Qp.get(i);if(e==="objectStoreNames")return i.objectStoreNames||Wb.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return kr(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function $C(i){$p=i($p)}function WC(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=i.call(Dp(this),e,...t);return Wb.set(s,e.sort?e.sort():[e]),kr(s)}:KC().includes(i)?function(...e){return i.apply(Dp(this),e),kr($b.get(this))}:function(...e){return kr(i.apply(Dp(this),e))}}function XC(i){return typeof i=="function"?WC(i):(i instanceof IDBTransaction&&QC(i),HC(i,GC())?new Proxy(i,$p):i)}function kr(i){if(i instanceof IDBRequest)return YC(i);if(Np.has(i))return Np.get(i);const e=XC(i);return e!==i&&(Np.set(i,e),jg.set(e,i)),e}const Dp=i=>jg.get(i);function JC(i,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const c=indexedDB.open(i,e),f=kr(c);return s&&c.addEventListener("upgradeneeded",p=>{s(kr(c.result),p.oldVersion,p.newVersion,kr(c.transaction),p)}),t&&c.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{l&&p.addEventListener("close",()=>l()),a&&p.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),f}const ZC=["get","getKey","getAll","getAllKeys","count"],eI=["put","add","delete","clear"],Op=new Map;function RE(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(Op.get(e))return Op.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=eI.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||ZC.includes(t)))return;const l=async function(c,...f){const p=this.transaction(c,a?"readwrite":"readonly");let g=p.store;return s&&(g=g.index(f.shift())),(await Promise.all([g[t](...f),a&&p.done]))[0]};return Op.set(e,l),l}$C(i=>({...i,get:(e,t,s)=>RE(e,t)||i.get(e,t,s),has:(e,t)=>!!RE(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(nI(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function nI(i){const e=i.getComponent();return e?.type==="VERSION"}const Wp="@firebase/app",CE="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs=new Qd("@firebase/app"),iI="@firebase/app-compat",sI="@firebase/analytics-compat",rI="@firebase/analytics",aI="@firebase/app-check-compat",oI="@firebase/app-check",lI="@firebase/auth",uI="@firebase/auth-compat",cI="@firebase/database",hI="@firebase/data-connect",dI="@firebase/database-compat",fI="@firebase/functions",mI="@firebase/functions-compat",pI="@firebase/installations",gI="@firebase/installations-compat",_I="@firebase/messaging",yI="@firebase/messaging-compat",vI="@firebase/performance",EI="@firebase/performance-compat",TI="@firebase/remote-config",bI="@firebase/remote-config-compat",wI="@firebase/storage",SI="@firebase/storage-compat",AI="@firebase/firestore",RI="@firebase/ai",CI="@firebase/firestore-compat",II="firebase",xI="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp="[DEFAULT]",NI={[Wp]:"fire-core",[iI]:"fire-core-compat",[rI]:"fire-analytics",[sI]:"fire-analytics-compat",[oI]:"fire-app-check",[aI]:"fire-app-check-compat",[lI]:"fire-auth",[uI]:"fire-auth-compat",[cI]:"fire-rtdb",[hI]:"fire-data-connect",[dI]:"fire-rtdb-compat",[fI]:"fire-fn",[mI]:"fire-fn-compat",[pI]:"fire-iid",[gI]:"fire-iid-compat",[_I]:"fire-fcm",[yI]:"fire-fcm-compat",[vI]:"fire-perf",[EI]:"fire-perf-compat",[TI]:"fire-rc",[bI]:"fire-rc-compat",[wI]:"fire-gcs",[SI]:"fire-gcs-compat",[AI]:"fire-fst",[CI]:"fire-fst-compat",[RI]:"fire-vertex","fire-js":"fire-js",[II]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd=new Map,DI=new Map,Jp=new Map;function IE(i,e){try{i.container.addComponent(e)}catch(t){Hs.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function jr(i){const e=i.name;if(Jp.has(e))return Hs.debug(`There were multiple attempts to register component ${e}.`),!1;Jp.set(e,i);for(const t of fd.values())IE(t,i);for(const t of DI.values())IE(t,i);return!0}function rc(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Pn(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mr=new sc("app","Firebase",OI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new qs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const za=xI;function Xb(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Xp,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Mr.create("bad-app-name",{appName:String(a)});if(t||(t=Hb()),!t)throw Mr.create("no-options");const l=fd.get(a);if(l){if(Ur(t,l.options)&&Ur(s,l.config))return l;throw Mr.create("duplicate-app",{appName:a})}const c=new jC(a);for(const p of Jp.values())c.addComponent(p);const f=new kI(t,s,c);return fd.set(a,f),f}function $d(i=Xp){const e=fd.get(i);if(!e&&i===Xp&&Hb())return Xb();if(!e)throw Mr.create("no-app",{appName:i});return e}function hi(i,e,t){var s;let a=(s=NI[i])!==null&&s!==void 0?s:i;t&&(a+=`-${t}`);const l=a.match(/\s|\//),c=e.match(/\s|\//);if(l||c){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&c&&f.push("and"),c&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hs.warn(f.join(" "));return}jr(new qs(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI="firebase-heartbeat-database",PI=1,Ku="firebase-heartbeat-store";let kp=null;function Jb(){return kp||(kp=JC(MI,PI,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Ku)}catch(t){console.warn(t)}}}}).catch(i=>{throw Mr.create("idb-open",{originalErrorMessage:i.message})})),kp}async function VI(i){try{const t=(await Jb()).transaction(Ku),s=await t.objectStore(Ku).get(Zb(i));return await t.done,s}catch(e){if(e instanceof ss)Hs.warn(e.message);else{const t=Mr.create("idb-get",{originalErrorMessage:e?.message});Hs.warn(t.message)}}}async function xE(i,e){try{const s=(await Jb()).transaction(Ku,"readwrite");await s.objectStore(Ku).put(e,Zb(i)),await s.done}catch(t){if(t instanceof ss)Hs.warn(t.message);else{const s=Mr.create("idb-set",{originalErrorMessage:t?.message});Hs.warn(s.message)}}}function Zb(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI=1024,UI=30;class jI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new FI(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=NE();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>UI){const c=zI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Hs.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=NE(),{heartbeatsToSend:s,unsentEntries:a}=BI(this._heartbeatsCache.heartbeats),l=cd(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Hs.warn(t),""}}}function NE(){return new Date().toISOString().substring(0,10)}function BI(i,e=LI){const t=[];let s=i.slice();for(const a of i){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),DE(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),DE(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class FI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wC()?SC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await VI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return xE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return xE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function DE(i){return cd(JSON.stringify({version:2,heartbeats:i})).length}function zI(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let s=1;s<i.length;s++)i[s].date<t&&(t=i[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qI(i){jr(new qs("platform-logger",e=>new tI(e),"PRIVATE")),jr(new qs("heartbeat",e=>new jI(e),"PRIVATE")),hi(Wp,CE,i),hi(Wp,CE,"esm2017"),hi("fire-js","")}qI("");var HI="firebase",GI="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hi(HI,GI,"app");var OE={};const kE="@firebase/database",ME="1.0.20";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ew="";function KI(i){ew=i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),dn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:Gu(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Ws(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=function(i){try{if(typeof window<"u"&&typeof window[i]<"u"){const e=window[i];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new YI(e)}}catch{}return new QI},Na=tw("localStorage"),$I=tw("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo=new Qd("@firebase/database"),WI=function(){let i=1;return function(){return i++}}(),nw=function(i){const e=PC(i),t=new NC;t.update(e);const s=t.digest();return Pg.encodeByteArray(s)},ac=function(...i){let e="";for(let t=0;t<i.length;t++){const s=i[t];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=ac.apply(null,s):typeof s=="object"?e+=dn(s):e+=s,e+=" "}return e};let Vu=null,PE=!0;const XI=function(i,e){le(!0,"Can't turn on custom loggers persistently."),Qo.logLevel=Ge.VERBOSE,Vu=Qo.log.bind(Qo)},En=function(...i){if(PE===!0&&(PE=!1,Vu===null&&$I.get("logging_enabled")===!0&&XI()),Vu){const e=ac.apply(null,i);Vu(e)}},oc=function(i){return function(...e){En(i,...e)}},Zp=function(...i){const e="FIREBASE INTERNAL ERROR: "+ac(...i);Qo.error(e)},Gs=function(...i){const e=`FIREBASE FATAL ERROR: ${ac(...i)}`;throw Qo.error(e),new Error(e)},$n=function(...i){const e="FIREBASE WARNING: "+ac(...i);Qo.warn(e)},JI=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&$n("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},iw=function(i){return typeof i=="number"&&(i!==i||i===Number.POSITIVE_INFINITY||i===Number.NEGATIVE_INFINITY)},ZI=function(i){if(document.readyState==="complete")i();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,i())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},tl="[MIN_NAME]",Ma="[MAX_NAME]",hl=function(i,e){if(i===e)return 0;if(i===tl||e===Ma)return-1;if(e===tl||i===Ma)return 1;{const t=VE(i),s=VE(e);return t!==null?s!==null?t-s===0?i.length-e.length:t-s:-1:s!==null?1:i<e?-1:1}},ex=function(i,e){return i===e?0:i<e?-1:1},Su=function(i,e){if(e&&i in e)return e[i];throw new Error("Missing required key ("+i+") in object: "+dn(e))},Bg=function(i){if(typeof i!="object"||i===null)return dn(i);const e=[];for(const s in i)e.push(s);e.sort();let t="{";for(let s=0;s<e.length;s++)s!==0&&(t+=","),t+=dn(e[s]),t+=":",t+=Bg(i[e[s]]);return t+="}",t},sw=function(i,e){const t=i.length;if(t<=e)return[i];const s=[];for(let a=0;a<t;a+=e)a+e>t?s.push(i.substring(a,t)):s.push(i.substring(a,a+e));return s};function fi(i,e){for(const t in i)i.hasOwnProperty(t)&&e(t,i[t])}const rw=function(i){le(!iw(i),"Invalid JSON number");const e=11,t=52,s=(1<<e-1)-1;let a,l,c,f,p;i===0?(l=0,c=0,a=1/i===-1/0?1:0):(a=i<0,i=Math.abs(i),i>=Math.pow(2,1-s)?(f=Math.min(Math.floor(Math.log(i)/Math.LN2),s),l=f+s,c=Math.round(i*Math.pow(2,t-f)-Math.pow(2,t))):(l=0,c=Math.round(i/Math.pow(2,1-s-t))));const g=[];for(p=t;p;p-=1)g.push(c%2?1:0),c=Math.floor(c/2);for(p=e;p;p-=1)g.push(l%2?1:0),l=Math.floor(l/2);g.push(a?1:0),g.reverse();const y=g.join("");let b="";for(p=0;p<64;p+=8){let S=parseInt(y.substr(p,8),2).toString(16);S.length===1&&(S="0"+S),b=b+S}return b.toLowerCase()},tx=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},nx=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},ix=new RegExp("^-?(0*)\\d{1,10}$"),sx=-2147483648,rx=2147483647,VE=function(i){if(ix.test(i)){const e=Number(i);if(e>=sx&&e<=rx)return e}return null},lc=function(i){try{i()}catch(e){setTimeout(()=>{const t=e.stack||"";throw $n("Exception was thrown by user callback.",t),e},Math.floor(0))}},ax=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Lu=function(i,e){const t=setTimeout(i,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Pn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){$n(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(e,t,s){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(a=>this.auth_=a)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(En("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',$n(e)}}class Jh{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Jh.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg="5",aw="v",ow="s",lw="r",uw="f",cw=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,hw="ls",dw="p",eg="ac",fw="websocket",mw="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,t,s,a,l=!1,c="",f=!1,p=!1,g=null){this.secure=t,this.namespace=s,this.webSocketOnly=a,this.nodeAdmin=l,this.persistenceKey=c,this.includeNamespaceInQueryParams=f,this.isUsingEmulator=p,this.emulatorOptions=g,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Na.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Na.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function ux(i){return i.host!==i.internalHost||i.isCustomHost()||i.includeNamespaceInQueryParams}function gw(i,e,t){le(typeof e=="string","typeof type must == string"),le(typeof t=="object","typeof params must == object");let s;if(e===fw)s=(i.secure?"wss://":"ws://")+i.internalHost+"/.ws?";else if(e===mw)s=(i.secure?"https://":"http://")+i.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);ux(i)&&(t.ns=i.namespace);const a=[];return fi(t,(l,c)=>{a.push(l+"="+c)}),s+a.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(){this.counters_={}}incrementCounter(e,t=1){Ws(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return uC(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp={},Pp={};function zg(i){const e=i.toString();return Mp[e]||(Mp[e]=new cx),Mp[e]}function hx(i,e){const t=i.toString();return Pp[t]||(Pp[t]=e()),Pp[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let a=0;a<s.length;++a)s[a]&&lc(()=>{this.onMessage_(s[a])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="start",fx="close",mx="pLPCommand",px="pRTLPCB",_w="id",yw="pw",vw="ser",gx="cb",_x="seg",yx="ts",vx="d",Ex="dframe",Ew=1870,Tw=30,Tx=Ew-Tw,bx=25e3,wx=3e4;class Go{constructor(e,t,s,a,l,c,f){this.connId=e,this.repoInfo=t,this.applicationId=s,this.appCheckToken=a,this.authToken=l,this.transportSessionId=c,this.lastSessionId=f,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=oc(e),this.stats_=zg(t),this.urlFn=p=>(this.appCheckToken&&(p[eg]=this.appCheckToken),gw(t,mw,p))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new dx(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(wx)),ZI(()=>{if(this.isClosed_)return;this.scriptTagHolder=new qg((...l)=>{const[c,f,p,g,y]=l;if(this.incrementIncomingBytes_(l),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,c===LE)this.id=f,this.password=p;else if(c===fx)f?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(f,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+c)},(...l)=>{const[c,f]=l;this.incrementIncomingBytes_(l),this.myPacketOrderer.handleResponse(c,f)},()=>{this.onClosed_()},this.urlFn);const s={};s[LE]="t",s[vw]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[gx]=this.scriptTagHolder.uniqueCallbackIdentifier),s[aw]=Fg,this.transportSessionId&&(s[ow]=this.transportSessionId),this.lastSessionId&&(s[hw]=this.lastSessionId),this.applicationId&&(s[dw]=this.applicationId),this.appCheckToken&&(s[eg]=this.appCheckToken),typeof location<"u"&&location.hostname&&cw.test(location.hostname)&&(s[lw]=uw);const a=this.urlFn(s);this.log_("Connecting via long-poll to "+a),this.scriptTagHolder.addTag(a,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Go.forceAllow_=!0}static forceDisallow(){Go.forceDisallow_=!0}static isAvailable(){return Go.forceAllow_?!0:!Go.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!tx()&&!nx()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=dn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=Fb(t),a=sw(s,Tx);for(let l=0;l<a.length;l++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,a.length,a[l]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const s={};s[Ex]="t",s[_w]=e,s[yw]=t,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=dn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class qg{constructor(e,t,s,a){this.onDisconnect=s,this.urlFn=a,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=WI(),window[mx+this.uniqueCallbackIdentifier]=e,window[px+this.uniqueCallbackIdentifier]=t,this.myIFrame=qg.createIFrame_();let l="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(l='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+l+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(f){En("frame writing exception"),f.stack&&En(f.stack),En(f)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||En("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[_w]=this.myID,e[yw]=this.myPW,e[vw]=this.currentSerial;let t=this.urlFn(e),s="",a=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Tw+s.length<=Ew;){const c=this.pendingSegs.shift();s=s+"&"+_x+a+"="+c.seg+"&"+yx+a+"="+c.ts+"&"+vx+a+"="+c.d,a++}return t=t+s,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,s){this.pendingSegs.push({seg:e,ts:t,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const s=()=>{this.outstandingRequests.delete(t),this.newRequest_()},a=setTimeout(s,Math.floor(bx)),l=()=>{clearTimeout(a),s()};this.addTag(e,l)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const a=s.readyState;(!a||a==="loaded"||a==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),t())},s.onerror=()=>{En("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sx=16384,Ax=45e3;let md=null;typeof MozWebSocket<"u"?md=MozWebSocket:typeof WebSocket<"u"&&(md=WebSocket);class wi{constructor(e,t,s,a,l,c,f){this.connId=e,this.applicationId=s,this.appCheckToken=a,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=oc(this.connId),this.stats_=zg(t),this.connURL=wi.connectionURL_(t,c,f,a,s),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,s,a,l){const c={};return c[aw]=Fg,typeof location<"u"&&location.hostname&&cw.test(location.hostname)&&(c[lw]=uw),t&&(c[ow]=t),s&&(c[hw]=s),a&&(c[eg]=a),l&&(c[dw]=l),gw(e,fw,c)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Na.set("previous_websocket_failure",!0);try{let s;TC(),this.mySock=new md(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const a=s.message||s.data;a&&this.log_(a),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const a=s.message||s.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){wi.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(t);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&md!==null&&!wi.forceDisallow_}static previouslyFailed(){return Na.isInMemoryStorage||Na.get("previous_websocket_failure")===!0}markConnectionHealthy(){Na.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const s=Gu(t);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(le(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const s=this.extractFrameCount_(t);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const t=dn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=sw(t,Sx);s.length>1&&this.sendString_(String(s.length));for(let a=0;a<s.length;a++)this.sendString_(s[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Ax))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}wi.responsesRequiredToBeHealthy=2;wi.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{static get ALL_TRANSPORTS(){return[Go,wi]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=wi&&wi.isAvailable();let s=t&&!wi.previouslyFailed();if(e.webSocketOnly&&(t||$n("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[wi];else{const a=this.transports_=[];for(const l of Yu.ALL_TRANSPORTS)l&&l.isAvailable()&&a.push(l);Yu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Yu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rx=6e4,Cx=5e3,Ix=10*1024,xx=100*1024,Vp="t",UE="d",Nx="s",jE="r",Dx="e",BE="o",FE="a",zE="n",qE="p",Ox="h";class kx{constructor(e,t,s,a,l,c,f,p,g,y){this.id=e,this.repoInfo_=t,this.applicationId_=s,this.appCheckToken_=a,this.authToken_=l,this.onMessage_=c,this.onReady_=f,this.onDisconnect_=p,this.onKill_=g,this.lastSessionId=y,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=oc("c:"+this.id+":"),this.transportManager_=new Yu(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,s)},Math.floor(0));const a=e.healthyTimeout||0;a>0&&(this.healthyTimeout_=Lu(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>xx?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Ix?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(a)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Vp in e){const t=e[Vp];t===FE?this.upgradeIfSecondaryHealthy_():t===jE?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===BE&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Su("t",e),s=Su("d",e);if(t==="c")this.onSecondaryControl_(s);else if(t==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:qE,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:FE,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:zE,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Su("t",e),s=Su("d",e);t==="c"?this.onControl_(s):t==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Su(Vp,e);if(UE in e){const s=e[UE];if(t===Ox){const a=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(a.h=this.repoInfo_.host),this.onHandshake_(a)}else if(t===zE){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let a=0;a<this.pendingDataMessages.length;++a)this.onDataMessage_(this.pendingDataMessages[a]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Nx?this.onConnectionShutdown_(s):t===jE?this.onReset_(s):t===Dx?Zp("Server Error: "+s):t===BE?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Zp("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,s=e.v,a=e.h;this.sessionId=e.s,this.repoInfo_.host=a,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Fg!==s&&$n("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,s),Lu(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Rx))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Lu(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Cx))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:qE,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Na.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{put(e,t,s,a){}merge(e,t,s,a){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,s){}onDisconnectMerge(e,t,s){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e){this.allowedEvents_=e,this.listeners_={},le(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let a=0;a<s.length;a++)s[a].callback.apply(s[a].context,t)}}on(e,t,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:s});const a=this.getInitialEvent(e);a&&t.apply(s,a)}off(e,t,s){this.validateEventType_(e);const a=this.listeners_[e]||[];for(let l=0;l<a.length;l++)if(a[l].callback===t&&(!s||s===a[l].context)){a.splice(l,1);return}}validateEventType_(e){le(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd extends ww{static getInstance(){return new pd}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ug()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return le(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE=32,GE=768;class vt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let s=0;for(let a=0;a<this.pieces_.length;a++)this.pieces_[a].length>0&&(this.pieces_[s]=this.pieces_[a],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function dt(){return new vt("")}function Je(i){return i.pieceNum_>=i.pieces_.length?null:i.pieces_[i.pieceNum_]}function Br(i){return i.pieces_.length-i.pieceNum_}function _t(i){let e=i.pieceNum_;return e<i.pieces_.length&&e++,new vt(i.pieces_,e)}function Sw(i){return i.pieceNum_<i.pieces_.length?i.pieces_[i.pieces_.length-1]:null}function Mx(i){let e="";for(let t=i.pieceNum_;t<i.pieces_.length;t++)i.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(i.pieces_[t])));return e||"/"}function Aw(i,e=0){return i.pieces_.slice(i.pieceNum_+e)}function Rw(i){if(i.pieceNum_>=i.pieces_.length)return null;const e=[];for(let t=i.pieceNum_;t<i.pieces_.length-1;t++)e.push(i.pieces_[t]);return new vt(e,0)}function sn(i,e){const t=[];for(let s=i.pieceNum_;s<i.pieces_.length;s++)t.push(i.pieces_[s]);if(e instanceof vt)for(let s=e.pieceNum_;s<e.pieces_.length;s++)t.push(e.pieces_[s]);else{const s=e.split("/");for(let a=0;a<s.length;a++)s[a].length>0&&t.push(s[a])}return new vt(t,0)}function Ye(i){return i.pieceNum_>=i.pieces_.length}function ci(i,e){const t=Je(i),s=Je(e);if(t===null)return e;if(t===s)return ci(_t(i),_t(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+i+")")}function Cw(i,e){if(Br(i)!==Br(e))return!1;for(let t=i.pieceNum_,s=e.pieceNum_;t<=i.pieces_.length;t++,s++)if(i.pieces_[t]!==e.pieces_[s])return!1;return!0}function Si(i,e){let t=i.pieceNum_,s=e.pieceNum_;if(Br(i)>Br(e))return!1;for(;t<i.pieces_.length;){if(i.pieces_[t]!==e.pieces_[s])return!1;++t,++s}return!0}class Px{constructor(e,t){this.errorPrefix_=t,this.parts_=Aw(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Yd(this.parts_[s]);Iw(this)}}function Vx(i,e){i.parts_.length>0&&(i.byteLength_+=1),i.parts_.push(e),i.byteLength_+=Yd(e),Iw(i)}function Lx(i){const e=i.parts_.pop();i.byteLength_-=Yd(e),i.parts_.length>0&&(i.byteLength_-=1)}function Iw(i){if(i.byteLength_>GE)throw new Error(i.errorPrefix_+"has a key path longer than "+GE+" bytes ("+i.byteLength_+").");if(i.parts_.length>HE)throw new Error(i.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+HE+") or object contains a cycle "+xa(i))}function xa(i){return i.parts_.length===0?"":"in property '"+i.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg extends ww{static getInstance(){return new Hg}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return le(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Au=1e3,Ux=60*5*1e3,KE=30*1e3,jx=1.3,Bx=3e4,Fx="server_kill",YE=3;class Bs extends bw{constructor(e,t,s,a,l,c,f,p){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=s,this.onConnectStatus_=a,this.onServerInfoUpdate_=l,this.authTokenProvider_=c,this.appCheckTokenProvider_=f,this.authOverride_=p,this.id=Bs.nextPersistentConnectionId_++,this.log_=oc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Au,this.maxReconnectDelay_=Ux,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,p)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Hg.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&pd.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,s){const a=++this.requestNumber_,l={r:a,a:e,b:t};this.log_(dn(l)),le(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),s&&(this.requestCBHash_[a]=s)}get(e){this.initConnection_();const t=new Lg,a={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:c=>{const f=c.d;c.s==="ok"?t.resolve(f):t.reject(f)}};this.outstandingGets_.push(a),this.outstandingGetCount_++;const l=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(l),t.promise}listen(e,t,s,a){this.initConnection_();const l=e._queryIdentifier,c=e._path.toString();this.log_("Listen called for "+c+" "+l),this.listens.has(c)||this.listens.set(c,new Map),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),le(!this.listens.get(c).has(l),"listen() called twice for same path/queryId.");const f={onComplete:a,hashFn:t,query:e,tag:s};this.listens.get(c).set(l,f),this.connected_&&this.sendListen_(f)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(s)})}sendListen_(e){const t=e.query,s=t._path.toString(),a=t._queryIdentifier;this.log_("Listen on "+s+" for "+a);const l={p:s},c="q";e.tag&&(l.q=t._queryObject,l.t=e.tag),l.h=e.hashFn(),this.sendRequest(c,l,f=>{const p=f.d,g=f.s;Bs.warnOnListenWarnings_(p,t),(this.listens.get(s)&&this.listens.get(s).get(a))===e&&(this.log_("listen response",f),g!=="ok"&&this.removeListen_(s,a),e.onComplete&&e.onComplete(g,p))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Ws(e,"w")){const s=el(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const a='".indexOn": "'+t._queryParams.getIndex().toString()+'"',l=t._path.toString();$n(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||xC(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=KE)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=IC(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(t,s,a=>{const l=a.s,c=a.d||"error";this.authToken_===e&&(l==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,s=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,s)})}unlisten(e,t){const s=e._path.toString(),a=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+a),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,a)&&this.connected_&&this.sendUnlisten_(s,a,e._queryObject,t)}sendUnlisten_(e,t,s,a){this.log_("Unlisten on "+e+" for "+t);const l={p:e},c="n";a&&(l.q=s,l.t=a),this.sendRequest(c,l)}onDisconnectPut(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:s})}onDisconnectMerge(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:s})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,s,a){const l={p:t,d:s};this.log_("onDisconnect "+e,l),this.sendRequest(e,l,c=>{a&&setTimeout(()=>{a(c.s,c.d)},Math.floor(0))})}put(e,t,s,a){this.putInternal("p",e,t,s,a)}merge(e,t,s,a){this.putInternal("m",e,t,s,a)}putInternal(e,t,s,a,l){this.initConnection_();const c={p:t,d:s};l!==void 0&&(c.h=l),this.outstandingPuts_.push({action:e,request:c,onComplete:a}),this.outstandingPutCount_++;const f=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(f):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,a=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,s,l=>{this.log_(t+" response",l),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),a&&a(l.s,l.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,s=>{if(s.s!=="ok"){const l=s.d;this.log_("reportStats","Error sending stats: "+l)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+dn(e));const t=e.r,s=this.requestCBHash_[t];s&&(delete this.requestCBHash_[t],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Zp("Unrecognized action received from server: "+dn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){le(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Au,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Au,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Bx&&(this.reconnectDelay_=Au),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*jx)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+Bs.nextConnectionId_++,l=this.lastSessionId;let c=!1,f=null;const p=function(){f?f.close():(c=!0,s())},g=function(b){le(f,"sendRequest call when we're not connected not allowed."),f.sendRequest(b)};this.realtime_={close:p,sendRequest:g};const y=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[b,S]=await Promise.all([this.authTokenProvider_.getToken(y),this.appCheckTokenProvider_.getToken(y)]);c?En("getToken() completed but was canceled"):(En("getToken() completed. Creating connection."),this.authToken_=b&&b.accessToken,this.appCheckToken_=S&&S.token,f=new kx(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,s,P=>{$n(P+" ("+this.repoInfo_.toString()+")"),this.interrupt(Fx)},l))}catch(b){this.log_("Failed to get token: "+b),c||(this.repoInfo_.nodeAdmin&&$n(b),p())}}}interrupt(e){En("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){En("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Yp(this.interruptReasons_)&&(this.reconnectDelay_=Au,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let s;t?s=t.map(l=>Bg(l)).join("$"):s="default";const a=this.removeListen_(e,s);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(e,t){const s=new vt(e).toString();let a;if(this.listens.has(s)){const l=this.listens.get(s);a=l.get(t),l.delete(t),l.size===0&&this.listens.delete(s)}else a=void 0;return a}onAuthRevoked_(e,t){En("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=YE&&(this.reconnectDelay_=KE,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){En("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=YE&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+ew.replace(/\./g,"-")]=1,Ug()?e["framework.cordova"]=1:Yb()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=pd.getInstance().currentlyOnline();return Yp(this.interruptReasons_)&&e}}Bs.nextPersistentConnectionId_=0;Bs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ze(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const s=new Ze(tl,e),a=new Ze(tl,t);return this.compare(s,a)!==0}minPost(){return Ze.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qh;class xw extends Wd{static get __EMPTY_NODE(){return qh}static set __EMPTY_NODE(e){qh=e}compare(e,t){return hl(e.name,t.name)}isDefinedOn(e){throw ul("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ze.MIN}maxPost(){return new Ze(Ma,qh)}makePost(e,t){return le(typeof e=="string","KeyIndex indexValue must always be a string."),new Ze(e,qh)}toString(){return".key"}}const $o=new xw;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hh=class{constructor(e,t,s,a,l=null){this.isReverse_=a,this.resultGenerator_=l,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(e=e,c=t?s(e.key,t):1,a&&(c*=-1),c<0)this.isReverse_?e=e.left:e=e.right;else if(c===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Yn=class Nu{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Nu.RED,this.left=a??Qi.EMPTY_NODE,this.right=l??Qi.EMPTY_NODE}copy(e,t,s,a,l){return new Nu(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return l<0?a=a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a=a.copy(null,t,null,null,null):a=a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return Qi.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let s,a;if(s=this,t(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),t(e,s.key)===0){if(s.right.isEmpty())return Qi.EMPTY_NODE;a=s.right.min_(),s=s.copy(a.key,a.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Nu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Nu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};Yn.RED=!0;Yn.BLACK=!1;class zx{copy(e,t,s,a,l){return this}insert(e,t,s){return new Yn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let Qi=class Zh{constructor(e,t=Zh.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Zh(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Yn.BLACK,null,null))}remove(e){return new Zh(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Yn.BLACK,null,null))}get(e){let t,s=this.root_;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),t===0)return s.value;t<0?s=s.left:t>0&&(s=s.right)}return null}getPredecessorKey(e){let t,s=this.root_,a=null;for(;!s.isEmpty();)if(t=this.comparator_(e,s.key),t===0){if(s.left.isEmpty())return a?a.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else t<0?s=s.left:t>0&&(a=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Hh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Hh(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Hh(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Hh(this.root_,null,this.comparator_,!0,e)}};Qi.EMPTY_NODE=new zx;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(i,e){return hl(i.name,e.name)}function Gg(i,e){return hl(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tg;function Hx(i){tg=i}const Nw=function(i){return typeof i=="number"?"number:"+rw(i):"string:"+i},Dw=function(i){if(i.isLeafNode()){const e=i.val();le(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ws(e,".sv"),"Priority must be a string or number.")}else le(i===tg||i.isEmpty(),"priority of unexpected type.");le(i===tg||i.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QE;class tn{static set __childrenNodeConstructor(e){QE=e}static get __childrenNodeConstructor(){return QE}constructor(e,t=tn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,le(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Dw(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new tn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:tn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ye(e)?this:Je(e)===".priority"?this.priorityNode_:tn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:tn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const s=Je(e);return s===null?t:t.isEmpty()&&s!==".priority"?this:(le(s!==".priority"||Br(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,tn.__childrenNodeConstructor.EMPTY_NODE.updateChild(_t(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Nw(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=rw(this.value_):e+=this.value_,this.lazyHash_=nw(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===tn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof tn.__childrenNodeConstructor?-1:(le(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,s=typeof this.value_,a=tn.VALUE_TYPE_ORDER.indexOf(t),l=tn.VALUE_TYPE_ORDER.indexOf(s);return le(a>=0,"Unknown leaf type: "+t),le(l>=0,"Unknown leaf type: "+s),a===l?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:l-a}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}tn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ow,kw;function Gx(i){Ow=i}function Kx(i){kw=i}class Yx extends Wd{compare(e,t){const s=e.node.getPriority(),a=t.node.getPriority(),l=s.compareTo(a);return l===0?hl(e.name,t.name):l}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ze.MIN}maxPost(){return new Ze(Ma,new tn("[PRIORITY-POST]",kw))}makePost(e,t){const s=Ow(e);return new Ze(t,new tn("[PRIORITY-POST]",s))}toString(){return".priority"}}const wn=new Yx;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qx=Math.log(2);class $x{constructor(e){const t=l=>parseInt(Math.log(l)/Qx,10),s=l=>parseInt(Array(l+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const a=s(this.count);this.bits_=e+1&a}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const gd=function(i,e,t,s){i.sort(e);const a=function(p,g){const y=g-p;let b,S;if(y===0)return null;if(y===1)return b=i[p],S=t?t(b):b,new Yn(S,b.node,Yn.BLACK,null,null);{const P=parseInt(y/2,10)+p,k=a(p,P),q=a(P+1,g);return b=i[P],S=t?t(b):b,new Yn(S,b.node,Yn.BLACK,k,q)}},l=function(p){let g=null,y=null,b=i.length;const S=function(k,q){const K=b-k,pe=b;b-=k;const ae=a(K+1,pe),ce=i[K],Te=t?t(ce):ce;P(new Yn(Te,ce.node,q,null,ae))},P=function(k){g?(g.left=k,g=k):(y=k,g=k)};for(let k=0;k<p.count;++k){const q=p.nextBitIsOne(),K=Math.pow(2,p.count-(k+1));q?S(K,Yn.BLACK):(S(K,Yn.BLACK),S(K,Yn.RED))}return y},c=new $x(i.length),f=l(c);return new Qi(s||e,f)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lp;const Bo={};class Ls{static get Default(){return le(Bo&&wn,"ChildrenNode.ts has not been loaded"),Lp=Lp||new Ls({".priority":Bo},{".priority":wn}),Lp}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=el(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Qi?t:null}hasIndex(e){return Ws(this.indexSet_,e.toString())}addIndex(e,t){le(e!==$o,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let a=!1;const l=t.getIterator(Ze.Wrap);let c=l.getNext();for(;c;)a=a||e.isDefinedOn(c.node),s.push(c),c=l.getNext();let f;a?f=gd(s,e.getCompare()):f=Bo;const p=e.toString(),g=Object.assign({},this.indexSet_);g[p]=e;const y=Object.assign({},this.indexes_);return y[p]=f,new Ls(y,g)}addToIndexes(e,t){const s=dd(this.indexes_,(a,l)=>{const c=el(this.indexSet_,l);if(le(c,"Missing index implementation for "+l),a===Bo)if(c.isDefinedOn(e.node)){const f=[],p=t.getIterator(Ze.Wrap);let g=p.getNext();for(;g;)g.name!==e.name&&f.push(g),g=p.getNext();return f.push(e),gd(f,c.getCompare())}else return Bo;else{const f=t.get(e.name);let p=a;return f&&(p=p.remove(new Ze(e.name,f))),p.insert(e,e.node)}});return new Ls(s,this.indexSet_)}removeFromIndexes(e,t){const s=dd(this.indexes_,a=>{if(a===Bo)return a;{const l=t.get(e.name);return l?a.remove(new Ze(e.name,l)):a}});return new Ls(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ru;class it{static get EMPTY_NODE(){return Ru||(Ru=new it(new Qi(Gg),null,Ls.Default))}constructor(e,t,s){this.children_=e,this.priorityNode_=t,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Dw(this.priorityNode_),this.children_.isEmpty()&&le(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ru}updatePriority(e){return this.children_.isEmpty()?this:new it(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Ru:t}}getChild(e){const t=Je(e);return t===null?this:this.getImmediateChild(t).getChild(_t(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(le(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const s=new Ze(e,t);let a,l;t.isEmpty()?(a=this.children_.remove(e),l=this.indexMap_.removeFromIndexes(s,this.children_)):(a=this.children_.insert(e,t),l=this.indexMap_.addToIndexes(s,this.children_));const c=a.isEmpty()?Ru:this.priorityNode_;return new it(a,c,l)}}updateChild(e,t){const s=Je(e);if(s===null)return t;{le(Je(e)!==".priority"||Br(e)===1,".priority must be the last token in a path");const a=this.getImmediateChild(s).updateChild(_t(e),t);return this.updateImmediateChild(s,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let s=0,a=0,l=!0;if(this.forEachChild(wn,(c,f)=>{t[c]=f.val(e),s++,l&&it.INTEGER_REGEXP_.test(c)?a=Math.max(a,Number(c)):l=!1}),!e&&l&&a<2*s){const c=[];for(const f in t)c[f]=t[f];return c}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Nw(this.getPriority().val())+":"),this.forEachChild(wn,(t,s)=>{const a=s.hash();a!==""&&(e+=":"+t+":"+a)}),this.lazyHash_=e===""?"":nw(e)}return this.lazyHash_}getPredecessorChildName(e,t,s){const a=this.resolveIndex_(s);if(a){const l=a.getPredecessorKey(new Ze(e,t));return l?l.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ze(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ze(t,this.children_.get(t)):null}forEachChild(e,t){const s=this.resolveIndex_(e);return s?s.inorderTraversal(a=>t(a.name,a.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getIteratorFrom(e,a=>a);{const a=this.children_.getIteratorFrom(e.name,Ze.Wrap);let l=a.peek();for(;l!=null&&t.compare(l,e)<0;)a.getNext(),l=a.peek();return a}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getReverseIteratorFrom(e,a=>a);{const a=this.children_.getReverseIteratorFrom(e.name,Ze.Wrap);let l=a.peek();for(;l!=null&&t.compare(l,e)>0;)a.getNext(),l=a.peek();return a}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===uc?-1:0}withIndex(e){if(e===$o||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new it(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===$o||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const s=this.getIterator(wn),a=t.getIterator(wn);let l=s.getNext(),c=a.getNext();for(;l&&c;){if(l.name!==c.name||!l.node.equals(c.node))return!1;l=s.getNext(),c=a.getNext()}return l===null&&c===null}else return!1;else return!1}}resolveIndex_(e){return e===$o?null:this.indexMap_.get(e.toString())}}it.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Wx extends it{constructor(){super(new Qi(Gg),it.EMPTY_NODE,Ls.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return it.EMPTY_NODE}isEmpty(){return!1}}const uc=new Wx;Object.defineProperties(Ze,{MIN:{value:new Ze(tl,it.EMPTY_NODE)},MAX:{value:new Ze(Ma,uc)}});xw.__EMPTY_NODE=it.EMPTY_NODE;tn.__childrenNodeConstructor=it;Hx(uc);Kx(uc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx=!0;function Tn(i,e=null){if(i===null)return it.EMPTY_NODE;if(typeof i=="object"&&".priority"in i&&(e=i[".priority"]),le(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof i=="object"&&".value"in i&&i[".value"]!==null&&(i=i[".value"]),typeof i!="object"||".sv"in i){const t=i;return new tn(t,Tn(e))}if(!(i instanceof Array)&&Xx){const t=[];let s=!1;if(fi(i,(c,f)=>{if(c.substring(0,1)!=="."){const p=Tn(f);p.isEmpty()||(s=s||!p.getPriority().isEmpty(),t.push(new Ze(c,p)))}}),t.length===0)return it.EMPTY_NODE;const l=gd(t,qx,c=>c.name,Gg);if(s){const c=gd(t,wn.getCompare());return new it(l,Tn(e),new Ls({".priority":c},{".priority":wn}))}else return new it(l,Tn(e),Ls.Default)}else{let t=it.EMPTY_NODE;return fi(i,(s,a)=>{if(Ws(i,s)&&s.substring(0,1)!=="."){const l=Tn(a);(l.isLeafNode()||!l.isEmpty())&&(t=t.updateImmediateChild(s,l))}}),t.updatePriority(Tn(e))}}Gx(Tn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx extends Wd{constructor(e){super(),this.indexPath_=e,le(!Ye(e)&&Je(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const s=this.extractChild(e.node),a=this.extractChild(t.node),l=s.compareTo(a);return l===0?hl(e.name,t.name):l}makePost(e,t){const s=Tn(e),a=it.EMPTY_NODE.updateChild(this.indexPath_,s);return new Ze(t,a)}maxPost(){const e=it.EMPTY_NODE.updateChild(this.indexPath_,uc);return new Ze(Ma,e)}toString(){return Aw(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx extends Wd{compare(e,t){const s=e.node.compareTo(t.node);return s===0?hl(e.name,t.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ze.MIN}maxPost(){return Ze.MAX}makePost(e,t){const s=Tn(e);return new Ze(t,s)}toString(){return".value"}}const eN=new Zx;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(i){return{type:"value",snapshotNode:i}}function nN(i,e){return{type:"child_added",snapshotNode:e,childName:i}}function iN(i,e){return{type:"child_removed",snapshotNode:e,childName:i}}function $E(i,e,t){return{type:"child_changed",snapshotNode:e,childName:i,oldSnap:t}}function sN(i,e){return{type:"child_moved",snapshotNode:e,childName:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=wn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return le(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return le(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:tl}hasEnd(){return this.endSet_}getIndexEndValue(){return le(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return le(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ma}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return le(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===wn}copy(){const e=new Kg;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function WE(i){const e={};if(i.isDefault())return e;let t;if(i.index_===wn?t="$priority":i.index_===eN?t="$value":i.index_===$o?t="$key":(le(i.index_ instanceof Jx,"Unrecognized index type!"),t=i.index_.toString()),e.orderBy=dn(t),i.startSet_){const s=i.startAfterSet_?"startAfter":"startAt";e[s]=dn(i.indexStartValue_),i.startNameSet_&&(e[s]+=","+dn(i.indexStartName_))}if(i.endSet_){const s=i.endBeforeSet_?"endBefore":"endAt";e[s]=dn(i.indexEndValue_),i.endNameSet_&&(e[s]+=","+dn(i.indexEndName_))}return i.limitSet_&&(i.isViewFromLeft()?e.limitToFirst=i.limit_:e.limitToLast=i.limit_),e}function XE(i){const e={};if(i.startSet_&&(e.sp=i.indexStartValue_,i.startNameSet_&&(e.sn=i.indexStartName_),e.sin=!i.startAfterSet_),i.endSet_&&(e.ep=i.indexEndValue_,i.endNameSet_&&(e.en=i.indexEndName_),e.ein=!i.endBeforeSet_),i.limitSet_){e.l=i.limit_;let t=i.viewFrom_;t===""&&(i.isViewFromLeft()?t="l":t="r"),e.vf=t}return i.index_!==wn&&(e.i=i.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d extends bw{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(le(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,s,a){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=s,this.appCheckTokenProvider_=a,this.log_=oc("p:rest:"),this.listens_={}}listen(e,t,s,a){const l=e._path.toString();this.log_("Listen called for "+l+" "+e._queryIdentifier);const c=_d.getListenId_(e,s),f={};this.listens_[c]=f;const p=WE(e._queryParams);this.restRequest_(l+".json",p,(g,y)=>{let b=y;if(g===404&&(b=null,g=null),g===null&&this.onDataUpdate_(l,b,!1,s),el(this.listens_,c)===f){let S;g?g===401?S="permission_denied":S="rest_error:"+g:S="ok",a(S,null)}})}unlisten(e,t){const s=_d.getListenId_(e,t);delete this.listens_[s]}get(e){const t=WE(e._queryParams),s=e._path.toString(),a=new Lg;return this.restRequest_(s+".json",t,(l,c)=>{let f=c;l===404&&(f=null,l=null),l===null?(this.onDataUpdate_(s,f,!1,null),a.resolve(f)):a.reject(new Error(f))}),a.promise}refreshAuthToken(e){}restRequest_(e,t={},s){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([a,l])=>{a&&a.accessToken&&(t.auth=a.accessToken),l&&l.token&&(t.ac=l.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+cl(t);this.log_("Sending REST request for "+c);const f=new XMLHttpRequest;f.onreadystatechange=()=>{if(s&&f.readyState===4){this.log_("REST Response for "+c+" received. status:",f.status,"response:",f.responseText);let p=null;if(f.status>=200&&f.status<300){try{p=Gu(f.responseText)}catch{$n("Failed to parse JSON response for "+c+": "+f.responseText)}s(null,p)}else f.status!==401&&f.status!==404&&$n("Got unsuccessful REST response for "+c+" Status: "+f.status),s(f.status);s=null}},f.open("GET",c,!0),f.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(){this.rootNode_=it.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd(){return{value:null,children:new Map}}function Mw(i,e,t){if(Ye(e))i.value=t,i.children.clear();else if(i.value!==null)i.value=i.value.updateChild(e,t);else{const s=Je(e);i.children.has(s)||i.children.set(s,yd());const a=i.children.get(s);e=_t(e),Mw(a,e,t)}}function ng(i,e,t){i.value!==null?t(e,i.value):aN(i,(s,a)=>{const l=new vt(e.toString()+"/"+s);ng(a,l,t)})}function aN(i,e){i.children.forEach((t,s)=>{e(s,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&fi(this.last_,(s,a)=>{t[s]=t[s]-a}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE=10*1e3,lN=30*1e3,uN=5*60*1e3;class cN{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new oN(e);const s=JE+(lN-JE)*Math.random();Lu(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),t={};let s=!1;fi(e,(a,l)=>{l>0&&Ws(this.statsToReport_,a)&&(t[a]=l,s=!0)}),s&&this.server_.reportStats(t),Lu(this.reportStats_.bind(this),Math.floor(Math.random()*2*uN))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $i;(function(i){i[i.OVERWRITE=0]="OVERWRITE",i[i.MERGE=1]="MERGE",i[i.ACK_USER_WRITE=2]="ACK_USER_WRITE",i[i.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})($i||($i={}));function Pw(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Vw(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Lw(i){return{fromUser:!1,fromServer:!0,queryId:i,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e,t,s){this.path=e,this.affectedTree=t,this.revert=s,this.type=$i.ACK_USER_WRITE,this.source=Pw()}operationForChild(e){if(Ye(this.path)){if(this.affectedTree.value!=null)return le(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new vt(e));return new vd(dt(),t,this.revert)}}else return le(Je(this.path)===e,"operationForChild called for unrelated child."),new vd(_t(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,t,s){this.source=e,this.path=t,this.snap=s,this.type=$i.OVERWRITE}operationForChild(e){return Ye(this.path)?new Pa(this.source,dt(),this.snap.getImmediateChild(e)):new Pa(this.source,_t(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,t,s){this.source=e,this.path=t,this.children=s,this.type=$i.MERGE}operationForChild(e){if(Ye(this.path)){const t=this.children.subtree(new vt(e));return t.isEmpty()?null:t.value?new Pa(this.source,dt(),t.value):new Qu(this.source,dt(),t)}else return le(Je(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Qu(this.source,_t(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,t,s){this.node_=e,this.fullyInitialized_=t,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ye(e))return this.isFullyInitialized()&&!this.filtered_;const t=Je(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function hN(i,e,t,s){const a=[],l=[];return e.forEach(c=>{c.type==="child_changed"&&i.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&l.push(sN(c.childName,c.snapshotNode))}),Cu(i,a,"child_removed",e,s,t),Cu(i,a,"child_added",e,s,t),Cu(i,a,"child_moved",l,s,t),Cu(i,a,"child_changed",e,s,t),Cu(i,a,"value",e,s,t),a}function Cu(i,e,t,s,a,l){const c=s.filter(f=>f.type===t);c.sort((f,p)=>fN(i,f,p)),c.forEach(f=>{const p=dN(i,f,l);a.forEach(g=>{g.respondsTo(f.type)&&e.push(g.createEvent(p,i.query_))})})}function dN(i,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,i.index_)),e}function fN(i,e,t){if(e.childName==null||t.childName==null)throw ul("Should only compare child_ events.");const s=new Ze(e.childName,e.snapshotNode),a=new Ze(t.childName,t.snapshotNode);return i.index_.compare(s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(i,e){return{eventCache:i,serverCache:e}}function Uu(i,e,t,s){return Uw(new Yg(e,t,s),i.serverCache)}function jw(i,e,t,s){return Uw(i.eventCache,new Yg(e,t,s))}function ig(i){return i.eventCache.isFullyInitialized()?i.eventCache.getNode():null}function Va(i){return i.serverCache.isFullyInitialized()?i.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Up;const mN=()=>(Up||(Up=new Qi(ex)),Up);class gt{static fromObject(e){let t=new gt(null);return fi(e,(s,a)=>{t=t.set(new vt(s),a)}),t}constructor(e,t=mN()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:dt(),value:this.value};if(Ye(e))return null;{const s=Je(e),a=this.children.get(s);if(a!==null){const l=a.findRootMostMatchingPathAndValue(_t(e),t);return l!=null?{path:sn(new vt(s),l.path),value:l.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ye(e))return this;{const t=Je(e),s=this.children.get(t);return s!==null?s.subtree(_t(e)):new gt(null)}}set(e,t){if(Ye(e))return new gt(t,this.children);{const s=Je(e),l=(this.children.get(s)||new gt(null)).set(_t(e),t),c=this.children.insert(s,l);return new gt(this.value,c)}}remove(e){if(Ye(e))return this.children.isEmpty()?new gt(null):new gt(null,this.children);{const t=Je(e),s=this.children.get(t);if(s){const a=s.remove(_t(e));let l;return a.isEmpty()?l=this.children.remove(t):l=this.children.insert(t,a),this.value===null&&l.isEmpty()?new gt(null):new gt(this.value,l)}else return this}}get(e){if(Ye(e))return this.value;{const t=Je(e),s=this.children.get(t);return s?s.get(_t(e)):null}}setTree(e,t){if(Ye(e))return t;{const s=Je(e),l=(this.children.get(s)||new gt(null)).setTree(_t(e),t);let c;return l.isEmpty()?c=this.children.remove(s):c=this.children.insert(s,l),new gt(this.value,c)}}fold(e){return this.fold_(dt(),e)}fold_(e,t){const s={};return this.children.inorderTraversal((a,l)=>{s[a]=l.fold_(sn(e,a),t)}),t(e,this.value,s)}findOnPath(e,t){return this.findOnPath_(e,dt(),t)}findOnPath_(e,t,s){const a=this.value?s(t,this.value):!1;if(a)return a;if(Ye(e))return null;{const l=Je(e),c=this.children.get(l);return c?c.findOnPath_(_t(e),sn(t,l),s):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,dt(),t)}foreachOnPath_(e,t,s){if(Ye(e))return this;{this.value&&s(t,this.value);const a=Je(e),l=this.children.get(a);return l?l.foreachOnPath_(_t(e),sn(t,a),s):new gt(null)}}foreach(e){this.foreach_(dt(),e)}foreach_(e,t){this.children.inorderTraversal((s,a)=>{a.foreach_(sn(e,s),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,s)=>{s.value&&e(t,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e){this.writeTree_=e}static empty(){return new Ri(new gt(null))}}function ju(i,e,t){if(Ye(e))return new Ri(new gt(t));{const s=i.writeTree_.findRootMostValueAndPath(e);if(s!=null){const a=s.path;let l=s.value;const c=ci(a,e);return l=l.updateChild(c,t),new Ri(i.writeTree_.set(a,l))}else{const a=new gt(t),l=i.writeTree_.setTree(e,a);return new Ri(l)}}}function ZE(i,e,t){let s=i;return fi(t,(a,l)=>{s=ju(s,sn(e,a),l)}),s}function eT(i,e){if(Ye(e))return Ri.empty();{const t=i.writeTree_.setTree(e,new gt(null));return new Ri(t)}}function sg(i,e){return qa(i,e)!=null}function qa(i,e){const t=i.writeTree_.findRootMostValueAndPath(e);return t!=null?i.writeTree_.get(t.path).getChild(ci(t.path,e)):null}function tT(i){const e=[],t=i.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(wn,(s,a)=>{e.push(new Ze(s,a))}):i.writeTree_.children.inorderTraversal((s,a)=>{a.value!=null&&e.push(new Ze(s,a.value))}),e}function Pr(i,e){if(Ye(e))return i;{const t=qa(i,e);return t!=null?new Ri(new gt(t)):new Ri(i.writeTree_.subtree(e))}}function rg(i){return i.writeTree_.isEmpty()}function nl(i,e){return Bw(dt(),i.writeTree_,e)}function Bw(i,e,t){if(e.value!=null)return t.updateChild(i,e.value);{let s=null;return e.children.inorderTraversal((a,l)=>{a===".priority"?(le(l.value!==null,"Priority writes must always be leaf nodes"),s=l.value):t=Bw(sn(i,a),l,t)}),!t.getChild(i).isEmpty()&&s!==null&&(t=t.updateChild(sn(i,".priority"),s)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(i,e){return Kw(e,i)}function pN(i,e,t,s,a){le(s>i.lastWriteId,"Stacking an older write on top of newer ones"),a===void 0&&(a=!0),i.allWrites.push({path:e,snap:t,writeId:s,visible:a}),a&&(i.visibleWrites=ju(i.visibleWrites,e,t)),i.lastWriteId=s}function gN(i,e){for(let t=0;t<i.allWrites.length;t++){const s=i.allWrites[t];if(s.writeId===e)return s}return null}function _N(i,e){const t=i.allWrites.findIndex(f=>f.writeId===e);le(t>=0,"removeWrite called with nonexistent writeId.");const s=i.allWrites[t];i.allWrites.splice(t,1);let a=s.visible,l=!1,c=i.allWrites.length-1;for(;a&&c>=0;){const f=i.allWrites[c];f.visible&&(c>=t&&yN(f,s.path)?a=!1:Si(s.path,f.path)&&(l=!0)),c--}if(a){if(l)return vN(i),!0;if(s.snap)i.visibleWrites=eT(i.visibleWrites,s.path);else{const f=s.children;fi(f,p=>{i.visibleWrites=eT(i.visibleWrites,sn(s.path,p))})}return!0}else return!1}function yN(i,e){if(i.snap)return Si(i.path,e);for(const t in i.children)if(i.children.hasOwnProperty(t)&&Si(sn(i.path,t),e))return!0;return!1}function vN(i){i.visibleWrites=zw(i.allWrites,EN,dt()),i.allWrites.length>0?i.lastWriteId=i.allWrites[i.allWrites.length-1].writeId:i.lastWriteId=-1}function EN(i){return i.visible}function zw(i,e,t){let s=Ri.empty();for(let a=0;a<i.length;++a){const l=i[a];if(e(l)){const c=l.path;let f;if(l.snap)Si(t,c)?(f=ci(t,c),s=ju(s,f,l.snap)):Si(c,t)&&(f=ci(c,t),s=ju(s,dt(),l.snap.getChild(f)));else if(l.children){if(Si(t,c))f=ci(t,c),s=ZE(s,f,l.children);else if(Si(c,t))if(f=ci(c,t),Ye(f))s=ZE(s,dt(),l.children);else{const p=el(l.children,Je(f));if(p){const g=p.getChild(_t(f));s=ju(s,dt(),g)}}}else throw ul("WriteRecord should have .snap or .children")}}return s}function qw(i,e,t,s,a){if(!s&&!a){const l=qa(i.visibleWrites,e);if(l!=null)return l;{const c=Pr(i.visibleWrites,e);if(rg(c))return t;if(t==null&&!sg(c,dt()))return null;{const f=t||it.EMPTY_NODE;return nl(c,f)}}}else{const l=Pr(i.visibleWrites,e);if(!a&&rg(l))return t;if(!a&&t==null&&!sg(l,dt()))return null;{const c=function(g){return(g.visible||a)&&(!s||!~s.indexOf(g.writeId))&&(Si(g.path,e)||Si(e,g.path))},f=zw(i.allWrites,c,e),p=t||it.EMPTY_NODE;return nl(f,p)}}}function TN(i,e,t){let s=it.EMPTY_NODE;const a=qa(i.visibleWrites,e);if(a)return a.isLeafNode()||a.forEachChild(wn,(l,c)=>{s=s.updateImmediateChild(l,c)}),s;if(t){const l=Pr(i.visibleWrites,e);return t.forEachChild(wn,(c,f)=>{const p=nl(Pr(l,new vt(c)),f);s=s.updateImmediateChild(c,p)}),tT(l).forEach(c=>{s=s.updateImmediateChild(c.name,c.node)}),s}else{const l=Pr(i.visibleWrites,e);return tT(l).forEach(c=>{s=s.updateImmediateChild(c.name,c.node)}),s}}function bN(i,e,t,s,a){le(s||a,"Either existingEventSnap or existingServerSnap must exist");const l=sn(e,t);if(sg(i.visibleWrites,l))return null;{const c=Pr(i.visibleWrites,l);return rg(c)?a.getChild(t):nl(c,a.getChild(t))}}function wN(i,e,t,s){const a=sn(e,t),l=qa(i.visibleWrites,a);if(l!=null)return l;if(s.isCompleteForChild(t)){const c=Pr(i.visibleWrites,a);return nl(c,s.getNode().getImmediateChild(t))}else return null}function SN(i,e){return qa(i.visibleWrites,e)}function AN(i,e,t,s,a,l,c){let f;const p=Pr(i.visibleWrites,e),g=qa(p,dt());if(g!=null)f=g;else if(t!=null)f=nl(p,t);else return[];if(f=f.withIndex(c),!f.isEmpty()&&!f.isLeafNode()){const y=[],b=c.getCompare(),S=l?f.getReverseIteratorFrom(s,c):f.getIteratorFrom(s,c);let P=S.getNext();for(;P&&y.length<a;)b(P,s)!==0&&y.push(P),P=S.getNext();return y}else return[]}function RN(){return{visibleWrites:Ri.empty(),allWrites:[],lastWriteId:-1}}function ag(i,e,t,s){return qw(i.writeTree,i.treePath,e,t,s)}function Hw(i,e){return TN(i.writeTree,i.treePath,e)}function nT(i,e,t,s){return bN(i.writeTree,i.treePath,e,t,s)}function Ed(i,e){return SN(i.writeTree,sn(i.treePath,e))}function CN(i,e,t,s,a,l){return AN(i.writeTree,i.treePath,e,t,s,a,l)}function Qg(i,e,t){return wN(i.writeTree,i.treePath,e,t)}function Gw(i,e){return Kw(sn(i.treePath,e),i.writeTree)}function Kw(i,e){return{treePath:i,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,s=e.childName;le(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),le(s!==".priority","Only non-priority child changes can be tracked.");const a=this.changeMap.get(s);if(a){const l=a.type;if(t==="child_added"&&l==="child_removed")this.changeMap.set(s,$E(s,e.snapshotNode,a.snapshotNode));else if(t==="child_removed"&&l==="child_added")this.changeMap.delete(s);else if(t==="child_removed"&&l==="child_changed")this.changeMap.set(s,iN(s,a.oldSnap));else if(t==="child_changed"&&l==="child_added")this.changeMap.set(s,nN(s,e.snapshotNode));else if(t==="child_changed"&&l==="child_changed")this.changeMap.set(s,$E(s,e.snapshotNode,a.oldSnap));else throw ul("Illegal combination of changes: "+e+" occurred after "+a)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{getCompleteChild(e){return null}getChildAfterChild(e,t,s){return null}}const Yw=new xN;class $g{constructor(e,t,s=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=s}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Yg(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Qg(this.writes_,e,s)}}getChildAfterChild(e,t,s){const a=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Va(this.viewCache_),l=CN(this.writes_,a,t,1,s,e);return l.length===0?null:l[0]}}function NN(i,e){le(e.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),le(e.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed")}function DN(i,e,t,s,a){const l=new IN;let c,f;if(t.type===$i.OVERWRITE){const g=t;g.source.fromUser?c=og(i,e,g.path,g.snap,s,a,l):(le(g.source.fromServer,"Unknown source."),f=g.source.tagged||e.serverCache.isFiltered()&&!Ye(g.path),c=Td(i,e,g.path,g.snap,s,a,f,l))}else if(t.type===$i.MERGE){const g=t;g.source.fromUser?c=kN(i,e,g.path,g.children,s,a,l):(le(g.source.fromServer,"Unknown source."),f=g.source.tagged||e.serverCache.isFiltered(),c=lg(i,e,g.path,g.children,s,a,f,l))}else if(t.type===$i.ACK_USER_WRITE){const g=t;g.revert?c=VN(i,e,g.path,s,a,l):c=MN(i,e,g.path,g.affectedTree,s,a,l)}else if(t.type===$i.LISTEN_COMPLETE)c=PN(i,e,t.path,s,l);else throw ul("Unknown operation type: "+t.type);const p=l.getChanges();return ON(e,c,p),{viewCache:c,changes:p}}function ON(i,e,t){const s=e.eventCache;if(s.isFullyInitialized()){const a=s.getNode().isLeafNode()||s.getNode().isEmpty(),l=ig(i);(t.length>0||!i.eventCache.isFullyInitialized()||a&&!s.getNode().equals(l)||!s.getNode().getPriority().equals(l.getPriority()))&&t.push(tN(ig(e)))}}function Qw(i,e,t,s,a,l){const c=e.eventCache;if(Ed(s,t)!=null)return e;{let f,p;if(Ye(t))if(le(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const g=Va(e),y=g instanceof it?g:it.EMPTY_NODE,b=Hw(s,y);f=i.filter.updateFullNode(e.eventCache.getNode(),b,l)}else{const g=ag(s,Va(e));f=i.filter.updateFullNode(e.eventCache.getNode(),g,l)}else{const g=Je(t);if(g===".priority"){le(Br(t)===1,"Can't have a priority with additional path components");const y=c.getNode();p=e.serverCache.getNode();const b=nT(s,t,y,p);b!=null?f=i.filter.updatePriority(y,b):f=c.getNode()}else{const y=_t(t);let b;if(c.isCompleteForChild(g)){p=e.serverCache.getNode();const S=nT(s,t,c.getNode(),p);S!=null?b=c.getNode().getImmediateChild(g).updateChild(y,S):b=c.getNode().getImmediateChild(g)}else b=Qg(s,g,e.serverCache);b!=null?f=i.filter.updateChild(c.getNode(),g,b,y,a,l):f=c.getNode()}}return Uu(e,f,c.isFullyInitialized()||Ye(t),i.filter.filtersNodes())}}function Td(i,e,t,s,a,l,c,f){const p=e.serverCache;let g;const y=c?i.filter:i.filter.getIndexedFilter();if(Ye(t))g=y.updateFullNode(p.getNode(),s,null);else if(y.filtersNodes()&&!p.isFiltered()){const P=p.getNode().updateChild(t,s);g=y.updateFullNode(p.getNode(),P,null)}else{const P=Je(t);if(!p.isCompleteForPath(t)&&Br(t)>1)return e;const k=_t(t),K=p.getNode().getImmediateChild(P).updateChild(k,s);P===".priority"?g=y.updatePriority(p.getNode(),K):g=y.updateChild(p.getNode(),P,K,k,Yw,null)}const b=jw(e,g,p.isFullyInitialized()||Ye(t),y.filtersNodes()),S=new $g(a,b,l);return Qw(i,b,t,a,S,f)}function og(i,e,t,s,a,l,c){const f=e.eventCache;let p,g;const y=new $g(a,e,l);if(Ye(t))g=i.filter.updateFullNode(e.eventCache.getNode(),s,c),p=Uu(e,g,!0,i.filter.filtersNodes());else{const b=Je(t);if(b===".priority")g=i.filter.updatePriority(e.eventCache.getNode(),s),p=Uu(e,g,f.isFullyInitialized(),f.isFiltered());else{const S=_t(t),P=f.getNode().getImmediateChild(b);let k;if(Ye(S))k=s;else{const q=y.getCompleteChild(b);q!=null?Sw(S)===".priority"&&q.getChild(Rw(S)).isEmpty()?k=q:k=q.updateChild(S,s):k=it.EMPTY_NODE}if(P.equals(k))p=e;else{const q=i.filter.updateChild(f.getNode(),b,k,S,y,c);p=Uu(e,q,f.isFullyInitialized(),i.filter.filtersNodes())}}}return p}function iT(i,e){return i.eventCache.isCompleteForChild(e)}function kN(i,e,t,s,a,l,c){let f=e;return s.foreach((p,g)=>{const y=sn(t,p);iT(e,Je(y))&&(f=og(i,f,y,g,a,l,c))}),s.foreach((p,g)=>{const y=sn(t,p);iT(e,Je(y))||(f=og(i,f,y,g,a,l,c))}),f}function sT(i,e,t){return t.foreach((s,a)=>{e=e.updateChild(s,a)}),e}function lg(i,e,t,s,a,l,c,f){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let p=e,g;Ye(t)?g=s:g=new gt(null).setTree(t,s);const y=e.serverCache.getNode();return g.children.inorderTraversal((b,S)=>{if(y.hasChild(b)){const P=e.serverCache.getNode().getImmediateChild(b),k=sT(i,P,S);p=Td(i,p,new vt(b),k,a,l,c,f)}}),g.children.inorderTraversal((b,S)=>{const P=!e.serverCache.isCompleteForChild(b)&&S.value===null;if(!y.hasChild(b)&&!P){const k=e.serverCache.getNode().getImmediateChild(b),q=sT(i,k,S);p=Td(i,p,new vt(b),q,a,l,c,f)}}),p}function MN(i,e,t,s,a,l,c){if(Ed(a,t)!=null)return e;const f=e.serverCache.isFiltered(),p=e.serverCache;if(s.value!=null){if(Ye(t)&&p.isFullyInitialized()||p.isCompleteForPath(t))return Td(i,e,t,p.getNode().getChild(t),a,l,f,c);if(Ye(t)){let g=new gt(null);return p.getNode().forEachChild($o,(y,b)=>{g=g.set(new vt(y),b)}),lg(i,e,t,g,a,l,f,c)}else return e}else{let g=new gt(null);return s.foreach((y,b)=>{const S=sn(t,y);p.isCompleteForPath(S)&&(g=g.set(y,p.getNode().getChild(S)))}),lg(i,e,t,g,a,l,f,c)}}function PN(i,e,t,s,a){const l=e.serverCache,c=jw(e,l.getNode(),l.isFullyInitialized()||Ye(t),l.isFiltered());return Qw(i,c,t,s,Yw,a)}function VN(i,e,t,s,a,l){let c;if(Ed(s,t)!=null)return e;{const f=new $g(s,e,a),p=e.eventCache.getNode();let g;if(Ye(t)||Je(t)===".priority"){let y;if(e.serverCache.isFullyInitialized())y=ag(s,Va(e));else{const b=e.serverCache.getNode();le(b instanceof it,"serverChildren would be complete if leaf node"),y=Hw(s,b)}y=y,g=i.filter.updateFullNode(p,y,l)}else{const y=Je(t);let b=Qg(s,y,e.serverCache);b==null&&e.serverCache.isCompleteForChild(y)&&(b=p.getImmediateChild(y)),b!=null?g=i.filter.updateChild(p,y,b,_t(t),f,l):e.eventCache.getNode().hasChild(y)?g=i.filter.updateChild(p,y,it.EMPTY_NODE,_t(t),f,l):g=p,g.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=ag(s,Va(e)),c.isLeafNode()&&(g=i.filter.updateFullNode(g,c,l)))}return c=e.serverCache.isFullyInitialized()||Ed(s,dt())!=null,Uu(e,g,c,i.filter.filtersNodes())}}function LN(i,e){const t=Va(i.viewCache_);return t&&(i.query._queryParams.loadsAllData()||!Ye(e)&&!t.getImmediateChild(Je(e)).isEmpty())?t.getChild(e):null}function rT(i,e,t,s){e.type===$i.MERGE&&e.source.queryId!==null&&(le(Va(i.viewCache_),"We should always have a full cache before handling merges"),le(ig(i.viewCache_),"Missing event cache, even though we have a server cache"));const a=i.viewCache_,l=DN(i.processor_,a,e,t,s);return NN(i.processor_,l.viewCache),le(l.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),i.viewCache_=l.viewCache,UN(i,l.changes,l.viewCache.eventCache.getNode())}function UN(i,e,t,s){const a=i.eventRegistrations_;return hN(i.eventGenerator_,e,t,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aT;function jN(i){le(!aT,"__referenceConstructor has already been defined"),aT=i}function Wg(i,e,t,s){const a=e.source.queryId;if(a!==null){const l=i.views.get(a);return le(l!=null,"SyncTree gave us an op for an invalid query."),rT(l,e,t,s)}else{let l=[];for(const c of i.views.values())l=l.concat(rT(c,e,t,s));return l}}function Xg(i,e){let t=null;for(const s of i.views.values())t=t||LN(s,e);return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oT;function BN(i){le(!oT,"__referenceConstructor has already been defined"),oT=i}class lT{constructor(e){this.listenProvider_=e,this.syncPointTree_=new gt(null),this.pendingWriteTree_=RN(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function FN(i,e,t,s,a){return pN(i.pendingWriteTree_,e,t,s,a),a?Jd(i,new Pa(Pw(),e,t)):[]}function Ko(i,e,t=!1){const s=gN(i.pendingWriteTree_,e);if(_N(i.pendingWriteTree_,e)){let l=new gt(null);return s.snap!=null?l=l.set(dt(),!0):fi(s.children,c=>{l=l.set(new vt(c),!0)}),Jd(i,new vd(s.path,l,t))}else return[]}function Xd(i,e,t){return Jd(i,new Pa(Vw(),e,t))}function zN(i,e,t){const s=gt.fromObject(t);return Jd(i,new Qu(Vw(),e,s))}function qN(i,e,t,s){const a=Jw(i,s);if(a!=null){const l=Zw(a),c=l.path,f=l.queryId,p=ci(c,e),g=new Pa(Lw(f),p,t);return e1(i,c,g)}else return[]}function HN(i,e,t,s){const a=Jw(i,s);if(a){const l=Zw(a),c=l.path,f=l.queryId,p=ci(c,e),g=gt.fromObject(t),y=new Qu(Lw(f),p,g);return e1(i,c,y)}else return[]}function $w(i,e,t){const a=i.pendingWriteTree_,l=i.syncPointTree_.findOnPath(e,(c,f)=>{const p=ci(c,e),g=Xg(f,p);if(g)return g});return qw(a,e,l,t,!0)}function Jd(i,e){return Ww(e,i.syncPointTree_,null,Fw(i.pendingWriteTree_,dt()))}function Ww(i,e,t,s){if(Ye(i.path))return Xw(i,e,t,s);{const a=e.get(dt());t==null&&a!=null&&(t=Xg(a,dt()));let l=[];const c=Je(i.path),f=i.operationForChild(c),p=e.children.get(c);if(p&&f){const g=t?t.getImmediateChild(c):null,y=Gw(s,c);l=l.concat(Ww(f,p,g,y))}return a&&(l=l.concat(Wg(a,i,s,t))),l}}function Xw(i,e,t,s){const a=e.get(dt());t==null&&a!=null&&(t=Xg(a,dt()));let l=[];return e.children.inorderTraversal((c,f)=>{const p=t?t.getImmediateChild(c):null,g=Gw(s,c),y=i.operationForChild(c);y&&(l=l.concat(Xw(y,f,p,g)))}),a&&(l=l.concat(Wg(a,i,s,t))),l}function Jw(i,e){return i.tagToQueryMap.get(e)}function Zw(i){const e=i.indexOf("$");return le(e!==-1&&e<i.length-1,"Bad queryKey."),{queryId:i.substr(e+1),path:new vt(i.substr(0,e))}}function e1(i,e,t){const s=i.syncPointTree_.get(e);le(s,"Missing sync point for query tag that we're tracking");const a=Fw(i.pendingWriteTree_,e);return Wg(s,t,a,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Jg(t)}node(){return this.node_}}class Zg{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=sn(this.path_,e);return new Zg(this.syncTree_,t)}node(){return $w(this.syncTree_,this.path_)}}const GN=function(i){return i=i||{},i.timestamp=i.timestamp||new Date().getTime(),i},uT=function(i,e,t){if(!i||typeof i!="object")return i;if(le(".sv"in i,"Unexpected leaf node or priority contents"),typeof i[".sv"]=="string")return KN(i[".sv"],e,t);if(typeof i[".sv"]=="object")return YN(i[".sv"],e);le(!1,"Unexpected server value: "+JSON.stringify(i,null,2))},KN=function(i,e,t){switch(i){case"timestamp":return t.timestamp;default:le(!1,"Unexpected server value: "+i)}},YN=function(i,e,t){i.hasOwnProperty("increment")||le(!1,"Unexpected server value: "+JSON.stringify(i,null,2));const s=i.increment;typeof s!="number"&&le(!1,"Unexpected increment value: "+s);const a=e.node();if(le(a!==null&&typeof a<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!a.isLeafNode())return s;const c=a.getValue();return typeof c!="number"?s:c+s},QN=function(i,e,t,s){return e_(e,new Zg(t,i),s)},$N=function(i,e,t){return e_(i,new Jg(e),t)};function e_(i,e,t){const s=i.getPriority().val(),a=uT(s,e.getImmediateChild(".priority"),t);let l;if(i.isLeafNode()){const c=i,f=uT(c.getValue(),e,t);return f!==c.getValue()||a!==c.getPriority().val()?new tn(f,Tn(a)):i}else{const c=i;return l=c,a!==c.getPriority().val()&&(l=l.updatePriority(new tn(a))),c.forEachChild(wn,(f,p)=>{const g=e_(p,e.getImmediateChild(f),t);g!==p&&(l=l.updateImmediateChild(f,g))}),l}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e="",t=null,s={children:{},childCount:0}){this.name=e,this.parent=t,this.node=s}}function n_(i,e){let t=e instanceof vt?e:new vt(e),s=i,a=Je(t);for(;a!==null;){const l=el(s.node.children,a)||{children:{},childCount:0};s=new t_(a,s,l),t=_t(t),a=Je(t)}return s}function dl(i){return i.node.value}function t1(i,e){i.node.value=e,ug(i)}function n1(i){return i.node.childCount>0}function WN(i){return dl(i)===void 0&&!n1(i)}function Zd(i,e){fi(i.node.children,(t,s)=>{e(new t_(t,i,s))})}function i1(i,e,t,s){t&&e(i),Zd(i,a=>{i1(a,e,!0)})}function XN(i,e,t){let s=i.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function cc(i){return new vt(i.parent===null?i.name:cc(i.parent)+"/"+i.name)}function ug(i){i.parent!==null&&JN(i.parent,i.name,i)}function JN(i,e,t){const s=WN(t),a=Ws(i.node.children,e);s&&a?(delete i.node.children[e],i.node.childCount--,ug(i)):!s&&!a&&(i.node.children[e]=t.node,i.node.childCount++,ug(i))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=/[\[\].#$\/\u0000-\u001F\u007F]/,e2=/[\[\].#$\u0000-\u001F\u007F]/,jp=10*1024*1024,s1=function(i){return typeof i=="string"&&i.length!==0&&!ZN.test(i)},t2=function(i){return typeof i=="string"&&i.length!==0&&!e2.test(i)},n2=function(i){return i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),t2(i)},r1=function(i,e,t){const s=t instanceof vt?new Px(t,i):t;if(e===void 0)throw new Error(i+"contains undefined "+xa(s));if(typeof e=="function")throw new Error(i+"contains a function "+xa(s)+" with contents = "+e.toString());if(iw(e))throw new Error(i+"contains "+e.toString()+" "+xa(s));if(typeof e=="string"&&e.length>jp/3&&Yd(e)>jp)throw new Error(i+"contains a string greater than "+jp+" utf8 bytes "+xa(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let a=!1,l=!1;if(fi(e,(c,f)=>{if(c===".value")a=!0;else if(c!==".priority"&&c!==".sv"&&(l=!0,!s1(c)))throw new Error(i+" contains an invalid key ("+c+") "+xa(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Vx(s,c),r1(i,f,s),Lx(s)}),a&&l)throw new Error(i+' contains ".value" child '+xa(s)+" in addition to actual children.")}},i2=function(i,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!s1(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!n2(t))throw new Error(MC(i,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function r2(i,e){let t=null;for(let s=0;s<e.length;s++){const a=e[s],l=a.getPath();t!==null&&!Cw(l,t.path)&&(i.eventLists_.push(t),t=null),t===null&&(t={events:[],path:l}),t.events.push(a)}t&&i.eventLists_.push(t)}function Ha(i,e,t){r2(i,t),a2(i,s=>Si(s,e)||Si(e,s))}function a2(i,e){i.recursionDepth_++;let t=!0;for(let s=0;s<i.eventLists_.length;s++){const a=i.eventLists_[s];if(a){const l=a.path;e(l)?(o2(i.eventLists_[s]),i.eventLists_[s]=null):t=!1}}t&&(i.eventLists_=[]),i.recursionDepth_--}function o2(i){for(let e=0;e<i.events.length;e++){const t=i.events[e];if(t!==null){i.events[e]=null;const s=t.getEventRunner();Vu&&En("event: "+t.toString()),lc(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="repo_interrupt",u2=25;class c2{constructor(e,t,s,a){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=s,this.appCheckProvider_=a,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new s2,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=yd(),this.transactionQueueTree_=new t_,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function h2(i,e,t){if(i.stats_=zg(i.repoInfo_),i.forceRestClient_||ax())i.server_=new _d(i.repoInfo_,(s,a,l,c)=>{cT(i,s,a,l,c)},i.authTokenProvider_,i.appCheckProvider_),setTimeout(()=>hT(i,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{dn(t)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}i.persistentConnection_=new Bs(i.repoInfo_,e,(s,a,l,c)=>{cT(i,s,a,l,c)},s=>{hT(i,s)},s=>{f2(i,s)},i.authTokenProvider_,i.appCheckProvider_,t),i.server_=i.persistentConnection_}i.authTokenProvider_.addTokenChangeListener(s=>{i.server_.refreshAuthToken(s)}),i.appCheckProvider_.addTokenChangeListener(s=>{i.server_.refreshAppCheckToken(s.token)}),i.statsReporter_=hx(i.repoInfo_,()=>new cN(i.stats_,i.server_)),i.infoData_=new rN,i.infoSyncTree_=new lT({startListening:(s,a,l,c)=>{let f=[];const p=i.infoData_.getNode(s._path);return p.isEmpty()||(f=Xd(i.infoSyncTree_,s._path,p),setTimeout(()=>{c("ok")},0)),f},stopListening:()=>{}}),i_(i,"connected",!1),i.serverSyncTree_=new lT({startListening:(s,a,l,c)=>(i.server_.listen(s,l,a,(f,p)=>{const g=c(f,p);Ha(i.eventQueue_,s._path,g)}),[]),stopListening:(s,a)=>{i.server_.unlisten(s,a)}})}function d2(i){const t=i.infoData_.getNode(new vt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function a1(i){return GN({timestamp:d2(i)})}function cT(i,e,t,s,a){i.dataUpdateCount++;const l=new vt(e);t=i.interceptServerDataCallback_?i.interceptServerDataCallback_(e,t):t;let c=[];if(a)if(s){const p=dd(t,g=>Tn(g));c=HN(i.serverSyncTree_,l,p,a)}else{const p=Tn(t);c=qN(i.serverSyncTree_,l,p,a)}else if(s){const p=dd(t,g=>Tn(g));c=zN(i.serverSyncTree_,l,p)}else{const p=Tn(t);c=Xd(i.serverSyncTree_,l,p)}let f=l;c.length>0&&(f=r_(i,l)),Ha(i.eventQueue_,f,c)}function hT(i,e){i_(i,"connected",e),e===!1&&p2(i)}function f2(i,e){fi(e,(t,s)=>{i_(i,t,s)})}function i_(i,e,t){const s=new vt("/.info/"+e),a=Tn(t);i.infoData_.updateSnapshot(s,a);const l=Xd(i.infoSyncTree_,s,a);Ha(i.eventQueue_,s,l)}function m2(i){return i.nextWriteId_++}function p2(i){o1(i,"onDisconnectEvents");const e=a1(i),t=yd();ng(i.onDisconnect_,dt(),(a,l)=>{const c=QN(a,l,i.serverSyncTree_,e);Mw(t,a,c)});let s=[];ng(t,dt(),(a,l)=>{s=s.concat(Xd(i.serverSyncTree_,a,l));const c=v2(i,a);r_(i,c)}),i.onDisconnect_=yd(),Ha(i.eventQueue_,dt(),s)}function g2(i){i.persistentConnection_&&i.persistentConnection_.interrupt(l2)}function o1(i,...e){let t="";i.persistentConnection_&&(t=i.persistentConnection_.id+":"),En(t,...e)}function l1(i,e,t){return $w(i.serverSyncTree_,e,t)||it.EMPTY_NODE}function s_(i,e=i.transactionQueueTree_){if(e||ef(i,e),dl(e)){const t=c1(i,e);le(t.length>0,"Sending zero length transaction queue"),t.every(a=>a.status===0)&&_2(i,cc(e),t)}else n1(e)&&Zd(e,t=>{s_(i,t)})}function _2(i,e,t){const s=t.map(g=>g.currentWriteId),a=l1(i,e,s);let l=a;const c=a.hash();for(let g=0;g<t.length;g++){const y=t[g];le(y.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),y.status=1,y.retryCount++;const b=ci(e,y.path);l=l.updateChild(b,y.currentOutputSnapshotRaw)}const f=l.val(!0),p=e;i.server_.put(p.toString(),f,g=>{o1(i,"transaction put response",{path:p.toString(),status:g});let y=[];if(g==="ok"){const b=[];for(let S=0;S<t.length;S++)t[S].status=2,y=y.concat(Ko(i.serverSyncTree_,t[S].currentWriteId)),t[S].onComplete&&b.push(()=>t[S].onComplete(null,!0,t[S].currentOutputSnapshotResolved)),t[S].unwatcher();ef(i,n_(i.transactionQueueTree_,e)),s_(i,i.transactionQueueTree_),Ha(i.eventQueue_,e,y);for(let S=0;S<b.length;S++)lc(b[S])}else{if(g==="datastale")for(let b=0;b<t.length;b++)t[b].status===3?t[b].status=4:t[b].status=0;else{$n("transaction at "+p.toString()+" failed: "+g);for(let b=0;b<t.length;b++)t[b].status=4,t[b].abortReason=g}r_(i,e)}},c)}function r_(i,e){const t=u1(i,e),s=cc(t),a=c1(i,t);return y2(i,a,s),s}function y2(i,e,t){if(e.length===0)return;const s=[];let a=[];const c=e.filter(f=>f.status===0).map(f=>f.currentWriteId);for(let f=0;f<e.length;f++){const p=e[f],g=ci(t,p.path);let y=!1,b;if(le(g!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),p.status===4)y=!0,b=p.abortReason,a=a.concat(Ko(i.serverSyncTree_,p.currentWriteId,!0));else if(p.status===0)if(p.retryCount>=u2)y=!0,b="maxretry",a=a.concat(Ko(i.serverSyncTree_,p.currentWriteId,!0));else{const S=l1(i,p.path,c);p.currentInputSnapshot=S;const P=e[f].update(S.val());if(P!==void 0){r1("transaction failed: Data returned ",P,p.path);let k=Tn(P);typeof P=="object"&&P!=null&&Ws(P,".priority")||(k=k.updatePriority(S.getPriority()));const K=p.currentWriteId,pe=a1(i),ae=$N(k,S,pe);p.currentOutputSnapshotRaw=k,p.currentOutputSnapshotResolved=ae,p.currentWriteId=m2(i),c.splice(c.indexOf(K),1),a=a.concat(FN(i.serverSyncTree_,p.path,ae,p.currentWriteId,p.applyLocally)),a=a.concat(Ko(i.serverSyncTree_,K,!0))}else y=!0,b="nodata",a=a.concat(Ko(i.serverSyncTree_,p.currentWriteId,!0))}Ha(i.eventQueue_,t,a),a=[],y&&(e[f].status=2,function(S){setTimeout(S,Math.floor(0))}(e[f].unwatcher),e[f].onComplete&&(b==="nodata"?s.push(()=>e[f].onComplete(null,!1,e[f].currentInputSnapshot)):s.push(()=>e[f].onComplete(new Error(b),!1,null))))}ef(i,i.transactionQueueTree_);for(let f=0;f<s.length;f++)lc(s[f]);s_(i,i.transactionQueueTree_)}function u1(i,e){let t,s=i.transactionQueueTree_;for(t=Je(e);t!==null&&dl(s)===void 0;)s=n_(s,t),e=_t(e),t=Je(e);return s}function c1(i,e){const t=[];return h1(i,e,t),t.sort((s,a)=>s.order-a.order),t}function h1(i,e,t){const s=dl(e);if(s)for(let a=0;a<s.length;a++)t.push(s[a]);Zd(e,a=>{h1(i,a,t)})}function ef(i,e){const t=dl(e);if(t){let s=0;for(let a=0;a<t.length;a++)t[a].status!==2&&(t[s]=t[a],s++);t.length=s,t1(e,t.length>0?t:void 0)}Zd(e,s=>{ef(i,s)})}function v2(i,e){const t=cc(u1(i,e)),s=n_(i.transactionQueueTree_,e);return XN(s,a=>{Bp(i,a)}),Bp(i,s),i1(s,a=>{Bp(i,a)}),t}function Bp(i,e){const t=dl(e);if(t){const s=[];let a=[],l=-1;for(let c=0;c<t.length;c++)t[c].status===3||(t[c].status===1?(le(l===c-1,"All SENT items should be at beginning of queue."),l=c,t[c].status=3,t[c].abortReason="set"):(le(t[c].status===0,"Unexpected transaction status in abort"),t[c].unwatcher(),a=a.concat(Ko(i.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&s.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));l===-1?t1(e,void 0):t.length=l+1,Ha(i.eventQueue_,cc(e),a);for(let c=0;c<s.length;c++)lc(s[c])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E2(i){let e="";const t=i.split("/");for(let s=0;s<t.length;s++)if(t[s].length>0){let a=t[s];try{a=decodeURIComponent(a.replace(/\+/g," "))}catch{}e+="/"+a}return e}function T2(i){const e={};i.charAt(0)==="?"&&(i=i.substring(1));for(const t of i.split("&")){if(t.length===0)continue;const s=t.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):$n(`Invalid query segment '${t}' in query '${i}'`)}return e}const dT=function(i,e){const t=b2(i),s=t.namespace;t.domain==="firebase.com"&&Gs(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&t.domain!=="localhost"&&Gs("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||JI();const a=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new pw(t.host,t.secure,s,a,e,"",s!==t.subdomain),path:new vt(t.pathString)}},b2=function(i){let e="",t="",s="",a="",l="",c=!0,f="https",p=443;if(typeof i=="string"){let g=i.indexOf("//");g>=0&&(f=i.substring(0,g-1),i=i.substring(g+2));let y=i.indexOf("/");y===-1&&(y=i.length);let b=i.indexOf("?");b===-1&&(b=i.length),e=i.substring(0,Math.min(y,b)),y<b&&(a=E2(i.substring(y,b)));const S=T2(i.substring(Math.min(i.length,b)));g=e.indexOf(":"),g>=0?(c=f==="https"||f==="wss",p=parseInt(e.substring(g+1),10)):g=e.length;const P=e.slice(0,g);if(P.toLowerCase()==="localhost")t="localhost";else if(P.split(".").length<=2)t=P;else{const k=e.indexOf(".");s=e.substring(0,k).toLowerCase(),t=e.substring(k+1),l=s}"ns"in S&&(l=S.ns)}return{host:e,port:p,domain:t,subdomain:s,secure:c,scheme:f,pathString:a,namespace:l}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e,t,s,a){this._repo=e,this._path=t,this._queryParams=s,this._orderByCalled=a}get key(){return Ye(this._path)?null:Sw(this._path)}get ref(){return new fl(this._repo,this._path)}get _queryIdentifier(){const e=XE(this._queryParams),t=Bg(e);return t==="{}"?"default":t}get _queryObject(){return XE(this._queryParams)}isEqual(e){if(e=St(e),!(e instanceof a_))return!1;const t=this._repo===e._repo,s=Cw(this._path,e._path),a=this._queryIdentifier===e._queryIdentifier;return t&&s&&a}toJSON(){return this.toString()}toString(){return this._repo.toString()+Mx(this._path)}}class fl extends a_{constructor(e,t){super(e,t,new Kg,!1)}get parent(){const e=Rw(this._path);return e===null?null:new fl(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}jN(fl);BN(fl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2="FIREBASE_DATABASE_EMULATOR_HOST",cg={};let S2=!1;function A2(i,e,t,s){const a=e.lastIndexOf(":"),l=e.substring(0,a),c=$s(l);i.repoInfo_=new pw(e,c,i.repoInfo_.namespace,i.repoInfo_.webSocketOnly,i.repoInfo_.nodeAdmin,i.repoInfo_.persistenceKey,i.repoInfo_.includeNamespaceInQueryParams,!0,t),s&&(i.authTokenProvider_=s)}function R2(i,e,t,s,a){let l=s||i.options.databaseURL;l===void 0&&(i.options.projectId||Gs("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),En("Using default host for project ",i.options.projectId),l=`${i.options.projectId}-default-rtdb.firebaseio.com`);let c=dT(l,a),f=c.repoInfo,p;typeof process<"u"&&OE&&(p=OE[w2]),p?(l=`http://${p}?ns=${f.namespace}`,c=dT(l,a),f=c.repoInfo):c.repoInfo.secure;const g=new lx(i.name,i.options,e);i2("Invalid Firebase Database URL",c),Ye(c.path)||Gs("Database URL must point to the root of a Firebase Database (not including a child path).");const y=I2(f,i,g,new ox(i,t));return new x2(y,i)}function C2(i,e){const t=cg[e];(!t||t[i.key]!==i)&&Gs(`Database ${e}(${i.repoInfo_}) has already been deleted.`),g2(i),delete t[i.key]}function I2(i,e,t,s){let a=cg[e.name];a||(a={},cg[e.name]=a);let l=a[i.toURLString()];return l&&Gs("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),l=new c2(i,S2,t,s),a[i.toURLString()]=l,l}class x2{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(h2(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new fl(this._repo,dt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(C2(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Gs("Cannot call "+e+" on a deleted database.")}}function N2(i=$d(),e){const t=rc(i,"database").getImmediate({identifier:e});if(!t._instanceStarted){const s=Vg("database");s&&D2(t,...s)}return t}function D2(i,e,t,s={}){i=St(i),i._checkNotDeleted("useEmulator");const a=`${e}:${t}`,l=i._repoInternal;if(i._instanceStarted){if(a===i._repoInternal.repoInfo_.host&&Ur(s,l.repoInfo_.emulatorOptions))return;Gs("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let c;if(l.repoInfo_.nodeAdmin)s.mockUserToken&&Gs('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new Jh(Jh.OWNER);else if(s.mockUserToken){const f=typeof s.mockUserToken=="string"?s.mockUserToken:Kb(s.mockUserToken,i.app.options.projectId);c=new Jh(f)}$s(e)&&(Gd(e),Kd("Database",!0)),A2(l,a,s,c)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(i){KI(za),jr(new qs("database",(e,{instanceIdentifier:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal"),l=e.getProvider("app-check-internal");return R2(s,a,l,t)},"PUBLIC").setMultipleInstances(!0)),hi(kE,ME,i),hi(kE,ME,"esm2017")}Bs.prototype.simpleListen=function(i,e){this.sendRequest("q",{p:i},e)};Bs.prototype.echo=function(i,e){this.sendRequest("echo",{d:i},e)};O2();var fT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vr,d1;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(M,R){function I(){}I.prototype=R.prototype,M.D=R.prototype,M.prototype=new I,M.prototype.constructor=M,M.C=function(D,V,L){for(var x=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)x[ue-2]=arguments[ue];return R.prototype[V].apply(D,x)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(M,R,I){I||(I=0);var D=Array(16);if(typeof R=="string")for(var V=0;16>V;++V)D[V]=R.charCodeAt(I++)|R.charCodeAt(I++)<<8|R.charCodeAt(I++)<<16|R.charCodeAt(I++)<<24;else for(V=0;16>V;++V)D[V]=R[I++]|R[I++]<<8|R[I++]<<16|R[I++]<<24;R=M.g[0],I=M.g[1],V=M.g[2];var L=M.g[3],x=R+(L^I&(V^L))+D[0]+3614090360&4294967295;R=I+(x<<7&4294967295|x>>>25),x=L+(V^R&(I^V))+D[1]+3905402710&4294967295,L=R+(x<<12&4294967295|x>>>20),x=V+(I^L&(R^I))+D[2]+606105819&4294967295,V=L+(x<<17&4294967295|x>>>15),x=I+(R^V&(L^R))+D[3]+3250441966&4294967295,I=V+(x<<22&4294967295|x>>>10),x=R+(L^I&(V^L))+D[4]+4118548399&4294967295,R=I+(x<<7&4294967295|x>>>25),x=L+(V^R&(I^V))+D[5]+1200080426&4294967295,L=R+(x<<12&4294967295|x>>>20),x=V+(I^L&(R^I))+D[6]+2821735955&4294967295,V=L+(x<<17&4294967295|x>>>15),x=I+(R^V&(L^R))+D[7]+4249261313&4294967295,I=V+(x<<22&4294967295|x>>>10),x=R+(L^I&(V^L))+D[8]+1770035416&4294967295,R=I+(x<<7&4294967295|x>>>25),x=L+(V^R&(I^V))+D[9]+2336552879&4294967295,L=R+(x<<12&4294967295|x>>>20),x=V+(I^L&(R^I))+D[10]+4294925233&4294967295,V=L+(x<<17&4294967295|x>>>15),x=I+(R^V&(L^R))+D[11]+2304563134&4294967295,I=V+(x<<22&4294967295|x>>>10),x=R+(L^I&(V^L))+D[12]+1804603682&4294967295,R=I+(x<<7&4294967295|x>>>25),x=L+(V^R&(I^V))+D[13]+4254626195&4294967295,L=R+(x<<12&4294967295|x>>>20),x=V+(I^L&(R^I))+D[14]+2792965006&4294967295,V=L+(x<<17&4294967295|x>>>15),x=I+(R^V&(L^R))+D[15]+1236535329&4294967295,I=V+(x<<22&4294967295|x>>>10),x=R+(V^L&(I^V))+D[1]+4129170786&4294967295,R=I+(x<<5&4294967295|x>>>27),x=L+(I^V&(R^I))+D[6]+3225465664&4294967295,L=R+(x<<9&4294967295|x>>>23),x=V+(R^I&(L^R))+D[11]+643717713&4294967295,V=L+(x<<14&4294967295|x>>>18),x=I+(L^R&(V^L))+D[0]+3921069994&4294967295,I=V+(x<<20&4294967295|x>>>12),x=R+(V^L&(I^V))+D[5]+3593408605&4294967295,R=I+(x<<5&4294967295|x>>>27),x=L+(I^V&(R^I))+D[10]+38016083&4294967295,L=R+(x<<9&4294967295|x>>>23),x=V+(R^I&(L^R))+D[15]+3634488961&4294967295,V=L+(x<<14&4294967295|x>>>18),x=I+(L^R&(V^L))+D[4]+3889429448&4294967295,I=V+(x<<20&4294967295|x>>>12),x=R+(V^L&(I^V))+D[9]+568446438&4294967295,R=I+(x<<5&4294967295|x>>>27),x=L+(I^V&(R^I))+D[14]+3275163606&4294967295,L=R+(x<<9&4294967295|x>>>23),x=V+(R^I&(L^R))+D[3]+4107603335&4294967295,V=L+(x<<14&4294967295|x>>>18),x=I+(L^R&(V^L))+D[8]+1163531501&4294967295,I=V+(x<<20&4294967295|x>>>12),x=R+(V^L&(I^V))+D[13]+2850285829&4294967295,R=I+(x<<5&4294967295|x>>>27),x=L+(I^V&(R^I))+D[2]+4243563512&4294967295,L=R+(x<<9&4294967295|x>>>23),x=V+(R^I&(L^R))+D[7]+1735328473&4294967295,V=L+(x<<14&4294967295|x>>>18),x=I+(L^R&(V^L))+D[12]+2368359562&4294967295,I=V+(x<<20&4294967295|x>>>12),x=R+(I^V^L)+D[5]+4294588738&4294967295,R=I+(x<<4&4294967295|x>>>28),x=L+(R^I^V)+D[8]+2272392833&4294967295,L=R+(x<<11&4294967295|x>>>21),x=V+(L^R^I)+D[11]+1839030562&4294967295,V=L+(x<<16&4294967295|x>>>16),x=I+(V^L^R)+D[14]+4259657740&4294967295,I=V+(x<<23&4294967295|x>>>9),x=R+(I^V^L)+D[1]+2763975236&4294967295,R=I+(x<<4&4294967295|x>>>28),x=L+(R^I^V)+D[4]+1272893353&4294967295,L=R+(x<<11&4294967295|x>>>21),x=V+(L^R^I)+D[7]+4139469664&4294967295,V=L+(x<<16&4294967295|x>>>16),x=I+(V^L^R)+D[10]+3200236656&4294967295,I=V+(x<<23&4294967295|x>>>9),x=R+(I^V^L)+D[13]+681279174&4294967295,R=I+(x<<4&4294967295|x>>>28),x=L+(R^I^V)+D[0]+3936430074&4294967295,L=R+(x<<11&4294967295|x>>>21),x=V+(L^R^I)+D[3]+3572445317&4294967295,V=L+(x<<16&4294967295|x>>>16),x=I+(V^L^R)+D[6]+76029189&4294967295,I=V+(x<<23&4294967295|x>>>9),x=R+(I^V^L)+D[9]+3654602809&4294967295,R=I+(x<<4&4294967295|x>>>28),x=L+(R^I^V)+D[12]+3873151461&4294967295,L=R+(x<<11&4294967295|x>>>21),x=V+(L^R^I)+D[15]+530742520&4294967295,V=L+(x<<16&4294967295|x>>>16),x=I+(V^L^R)+D[2]+3299628645&4294967295,I=V+(x<<23&4294967295|x>>>9),x=R+(V^(I|~L))+D[0]+4096336452&4294967295,R=I+(x<<6&4294967295|x>>>26),x=L+(I^(R|~V))+D[7]+1126891415&4294967295,L=R+(x<<10&4294967295|x>>>22),x=V+(R^(L|~I))+D[14]+2878612391&4294967295,V=L+(x<<15&4294967295|x>>>17),x=I+(L^(V|~R))+D[5]+4237533241&4294967295,I=V+(x<<21&4294967295|x>>>11),x=R+(V^(I|~L))+D[12]+1700485571&4294967295,R=I+(x<<6&4294967295|x>>>26),x=L+(I^(R|~V))+D[3]+2399980690&4294967295,L=R+(x<<10&4294967295|x>>>22),x=V+(R^(L|~I))+D[10]+4293915773&4294967295,V=L+(x<<15&4294967295|x>>>17),x=I+(L^(V|~R))+D[1]+2240044497&4294967295,I=V+(x<<21&4294967295|x>>>11),x=R+(V^(I|~L))+D[8]+1873313359&4294967295,R=I+(x<<6&4294967295|x>>>26),x=L+(I^(R|~V))+D[15]+4264355552&4294967295,L=R+(x<<10&4294967295|x>>>22),x=V+(R^(L|~I))+D[6]+2734768916&4294967295,V=L+(x<<15&4294967295|x>>>17),x=I+(L^(V|~R))+D[13]+1309151649&4294967295,I=V+(x<<21&4294967295|x>>>11),x=R+(V^(I|~L))+D[4]+4149444226&4294967295,R=I+(x<<6&4294967295|x>>>26),x=L+(I^(R|~V))+D[11]+3174756917&4294967295,L=R+(x<<10&4294967295|x>>>22),x=V+(R^(L|~I))+D[2]+718787259&4294967295,V=L+(x<<15&4294967295|x>>>17),x=I+(L^(V|~R))+D[9]+3951481745&4294967295,M.g[0]=M.g[0]+R&4294967295,M.g[1]=M.g[1]+(V+(x<<21&4294967295|x>>>11))&4294967295,M.g[2]=M.g[2]+V&4294967295,M.g[3]=M.g[3]+L&4294967295}s.prototype.u=function(M,R){R===void 0&&(R=M.length);for(var I=R-this.blockSize,D=this.B,V=this.h,L=0;L<R;){if(V==0)for(;L<=I;)a(this,M,L),L+=this.blockSize;if(typeof M=="string"){for(;L<R;)if(D[V++]=M.charCodeAt(L++),V==this.blockSize){a(this,D),V=0;break}}else for(;L<R;)if(D[V++]=M[L++],V==this.blockSize){a(this,D),V=0;break}}this.h=V,this.o+=R},s.prototype.v=function(){var M=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);M[0]=128;for(var R=1;R<M.length-8;++R)M[R]=0;var I=8*this.o;for(R=M.length-8;R<M.length;++R)M[R]=I&255,I/=256;for(this.u(M),M=Array(16),R=I=0;4>R;++R)for(var D=0;32>D;D+=8)M[I++]=this.g[R]>>>D&255;return M};function l(M,R){var I=f;return Object.prototype.hasOwnProperty.call(I,M)?I[M]:I[M]=R(M)}function c(M,R){this.h=R;for(var I=[],D=!0,V=M.length-1;0<=V;V--){var L=M[V]|0;D&&L==R||(I[V]=L,D=!1)}this.g=I}var f={};function p(M){return-128<=M&&128>M?l(M,function(R){return new c([R|0],0>R?-1:0)}):new c([M|0],0>M?-1:0)}function g(M){if(isNaN(M)||!isFinite(M))return b;if(0>M)return K(g(-M));for(var R=[],I=1,D=0;M>=I;D++)R[D]=M/I|0,I*=4294967296;return new c(R,0)}function y(M,R){if(M.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(M.charAt(0)=="-")return K(y(M.substring(1),R));if(0<=M.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=g(Math.pow(R,8)),D=b,V=0;V<M.length;V+=8){var L=Math.min(8,M.length-V),x=parseInt(M.substring(V,V+L),R);8>L?(L=g(Math.pow(R,L)),D=D.j(L).add(g(x))):(D=D.j(I),D=D.add(g(x)))}return D}var b=p(0),S=p(1),P=p(16777216);i=c.prototype,i.m=function(){if(q(this))return-K(this).m();for(var M=0,R=1,I=0;I<this.g.length;I++){var D=this.i(I);M+=(0<=D?D:4294967296+D)*R,R*=4294967296}return M},i.toString=function(M){if(M=M||10,2>M||36<M)throw Error("radix out of range: "+M);if(k(this))return"0";if(q(this))return"-"+K(this).toString(M);for(var R=g(Math.pow(M,6)),I=this,D="";;){var V=Te(I,R).g;I=pe(I,V.j(R));var L=((0<I.g.length?I.g[0]:I.h)>>>0).toString(M);if(I=V,k(I))return L+D;for(;6>L.length;)L="0"+L;D=L+D}},i.i=function(M){return 0>M?0:M<this.g.length?this.g[M]:this.h};function k(M){if(M.h!=0)return!1;for(var R=0;R<M.g.length;R++)if(M.g[R]!=0)return!1;return!0}function q(M){return M.h==-1}i.l=function(M){return M=pe(this,M),q(M)?-1:k(M)?0:1};function K(M){for(var R=M.g.length,I=[],D=0;D<R;D++)I[D]=~M.g[D];return new c(I,~M.h).add(S)}i.abs=function(){return q(this)?K(this):this},i.add=function(M){for(var R=Math.max(this.g.length,M.g.length),I=[],D=0,V=0;V<=R;V++){var L=D+(this.i(V)&65535)+(M.i(V)&65535),x=(L>>>16)+(this.i(V)>>>16)+(M.i(V)>>>16);D=x>>>16,L&=65535,x&=65535,I[V]=x<<16|L}return new c(I,I[I.length-1]&-2147483648?-1:0)};function pe(M,R){return M.add(K(R))}i.j=function(M){if(k(this)||k(M))return b;if(q(this))return q(M)?K(this).j(K(M)):K(K(this).j(M));if(q(M))return K(this.j(K(M)));if(0>this.l(P)&&0>M.l(P))return g(this.m()*M.m());for(var R=this.g.length+M.g.length,I=[],D=0;D<2*R;D++)I[D]=0;for(D=0;D<this.g.length;D++)for(var V=0;V<M.g.length;V++){var L=this.i(D)>>>16,x=this.i(D)&65535,ue=M.i(V)>>>16,oe=M.i(V)&65535;I[2*D+2*V]+=x*oe,ae(I,2*D+2*V),I[2*D+2*V+1]+=L*oe,ae(I,2*D+2*V+1),I[2*D+2*V+1]+=x*ue,ae(I,2*D+2*V+1),I[2*D+2*V+2]+=L*ue,ae(I,2*D+2*V+2)}for(D=0;D<R;D++)I[D]=I[2*D+1]<<16|I[2*D];for(D=R;D<2*R;D++)I[D]=0;return new c(I,0)};function ae(M,R){for(;(M[R]&65535)!=M[R];)M[R+1]+=M[R]>>>16,M[R]&=65535,R++}function ce(M,R){this.g=M,this.h=R}function Te(M,R){if(k(R))throw Error("division by zero");if(k(M))return new ce(b,b);if(q(M))return R=Te(K(M),R),new ce(K(R.g),K(R.h));if(q(R))return R=Te(M,K(R)),new ce(K(R.g),R.h);if(30<M.g.length){if(q(M)||q(R))throw Error("slowDivide_ only works with positive integers.");for(var I=S,D=R;0>=D.l(M);)I=be(I),D=be(D);var V=Re(I,1),L=Re(D,1);for(D=Re(D,2),I=Re(I,2);!k(D);){var x=L.add(D);0>=x.l(M)&&(V=V.add(I),L=x),D=Re(D,1),I=Re(I,1)}return R=pe(M,V.j(R)),new ce(V,R)}for(V=b;0<=M.l(R);){for(I=Math.max(1,Math.floor(M.m()/R.m())),D=Math.ceil(Math.log(I)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),L=g(I),x=L.j(R);q(x)||0<x.l(M);)I-=D,L=g(I),x=L.j(R);k(L)&&(L=S),V=V.add(L),M=pe(M,x)}return new ce(V,M)}i.A=function(M){return Te(this,M).h},i.and=function(M){for(var R=Math.max(this.g.length,M.g.length),I=[],D=0;D<R;D++)I[D]=this.i(D)&M.i(D);return new c(I,this.h&M.h)},i.or=function(M){for(var R=Math.max(this.g.length,M.g.length),I=[],D=0;D<R;D++)I[D]=this.i(D)|M.i(D);return new c(I,this.h|M.h)},i.xor=function(M){for(var R=Math.max(this.g.length,M.g.length),I=[],D=0;D<R;D++)I[D]=this.i(D)^M.i(D);return new c(I,this.h^M.h)};function be(M){for(var R=M.g.length+1,I=[],D=0;D<R;D++)I[D]=M.i(D)<<1|M.i(D-1)>>>31;return new c(I,M.h)}function Re(M,R){var I=R>>5;R%=32;for(var D=M.g.length-I,V=[],L=0;L<D;L++)V[L]=0<R?M.i(L+I)>>>R|M.i(L+I+1)<<32-R:M.i(L+I);return new c(V,M.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,d1=s,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=g,c.fromString=y,Vr=c}).apply(typeof fT<"u"?fT:typeof self<"u"?self:typeof window<"u"?window:{});var Gh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var f1,Du,m1,ed,hg,p1,g1,_1;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,_,v){return h==Array.prototype||h==Object.prototype||(h[_]=v.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gh=="object"&&Gh];for(var _=0;_<h.length;++_){var v=h[_];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var s=t(this);function a(h,_){if(_)e:{var v=s;h=h.split(".");for(var A=0;A<h.length-1;A++){var j=h[A];if(!(j in v))break e;v=v[j]}h=h[h.length-1],A=v[h],_=_(A),_!=A&&_!=null&&e(v,h,{configurable:!0,writable:!0,value:_})}}function l(h,_){h instanceof String&&(h+="");var v=0,A=!1,j={next:function(){if(!A&&v<h.length){var Y=v++;return{value:_(Y,h[Y]),done:!1}}return A=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}a("Array.prototype.values",function(h){return h||function(){return l(this,function(_,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},f=this||self;function p(h){var _=typeof h;return _=_!="object"?_:h?Array.isArray(h)?"array":_:"null",_=="array"||_=="object"&&typeof h.length=="number"}function g(h){var _=typeof h;return _=="object"&&h!=null||_=="function"}function y(h,_,v){return h.call.apply(h.bind,arguments)}function b(h,_,v){if(!h)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,A),h.apply(_,j)}}return function(){return h.apply(_,arguments)}}function S(h,_,v){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?y:b,S.apply(null,arguments)}function P(h,_){var v=Array.prototype.slice.call(arguments,1);return function(){var A=v.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function k(h,_){function v(){}v.prototype=_.prototype,h.aa=_.prototype,h.prototype=new v,h.prototype.constructor=h,h.Qb=function(A,j,Y){for(var se=Array(arguments.length-2),Qe=2;Qe<arguments.length;Qe++)se[Qe-2]=arguments[Qe];return _.prototype[j].apply(A,se)}}function q(h){const _=h.length;if(0<_){const v=Array(_);for(let A=0;A<_;A++)v[A]=h[A];return v}return[]}function K(h,_){for(let v=1;v<arguments.length;v++){const A=arguments[v];if(p(A)){const j=h.length||0,Y=A.length||0;h.length=j+Y;for(let se=0;se<Y;se++)h[j+se]=A[se]}else h.push(A)}}class pe{constructor(_,v){this.i=_,this.j=v,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function ae(h){return/^[\s\xa0]*$/.test(h)}function ce(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function Te(h){return Te[" "](h),h}Te[" "]=function(){};var be=ce().indexOf("Gecko")!=-1&&!(ce().toLowerCase().indexOf("webkit")!=-1&&ce().indexOf("Edge")==-1)&&!(ce().indexOf("Trident")!=-1||ce().indexOf("MSIE")!=-1)&&ce().indexOf("Edge")==-1;function Re(h,_,v){for(const A in h)_.call(v,h[A],A,h)}function M(h,_){for(const v in h)_.call(void 0,h[v],v,h)}function R(h){const _={};for(const v in h)_[v]=h[v];return _}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(h,_){let v,A;for(let j=1;j<arguments.length;j++){A=arguments[j];for(v in A)h[v]=A[v];for(let Y=0;Y<I.length;Y++)v=I[Y],Object.prototype.hasOwnProperty.call(A,v)&&(h[v]=A[v])}}function V(h){var _=1;h=h.split(":");const v=[];for(;0<_&&h.length;)v.push(h.shift()),_--;return h.length&&v.push(h.join(":")),v}function L(h){f.setTimeout(()=>{throw h},0)}function x(){var h=fe;let _=null;return h.g&&(_=h.g,h.g=h.g.next,h.g||(h.h=null),_.next=null),_}class ue{constructor(){this.h=this.g=null}add(_,v){const A=oe.get();A.set(_,v),this.h?this.h.next=A:this.g=A,this.h=A}}var oe=new pe(()=>new z,h=>h.reset());class z{constructor(){this.next=this.g=this.h=null}set(_,v){this.h=_,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let te,Z=!1,fe=new ue,N=()=>{const h=f.Promise.resolve(void 0);te=()=>{h.then(X)}};var X=()=>{for(var h;h=x();){try{h.h.call(h.g)}catch(v){L(v)}var _=oe;_.j(h),100>_.h&&(_.h++,h.next=_.g,_.g=h)}Z=!1};function re(){this.s=this.s,this.C=this.C}re.prototype.s=!1,re.prototype.ma=function(){this.s||(this.s=!0,this.N())},re.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ne(h,_){this.type=h,this.g=this.target=_,this.defaultPrevented=!1}ne.prototype.h=function(){this.defaultPrevented=!0};var ye=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,_=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const v=()=>{};f.addEventListener("test",v,_),f.removeEventListener("test",v,_)}catch{}return h}();function Oe(h,_){if(ne.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var v=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=_,_=h.relatedTarget){if(be){e:{try{Te(_.nodeName);var j=!0;break e}catch{}j=!1}j||(_=null)}}else v=="mouseover"?_=h.fromElement:v=="mouseout"&&(_=h.toElement);this.relatedTarget=_,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Ne[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Oe.aa.h.call(this)}}k(Oe,ne);var Ne={2:"touch",3:"pen",4:"mouse"};Oe.prototype.h=function(){Oe.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Mt="closure_listenable_"+(1e6*Math.random()|0),ot=0;function Wn(h,_,v,A,j){this.listener=h,this.proxy=null,this.src=_,this.type=v,this.capture=!!A,this.ha=j,this.key=++ot,this.da=this.fa=!1}function xi(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function mi(h){this.src=h,this.g={},this.h=0}mi.prototype.add=function(h,_,v,A,j){var Y=h.toString();h=this.g[Y],h||(h=this.g[Y]=[],this.h++);var se=as(h,_,A,j);return-1<se?(_=h[se],v||(_.fa=!1)):(_=new Wn(_,this.src,Y,!!A,j),_.fa=v,h.push(_)),_};function rs(h,_){var v=_.type;if(v in h.g){var A=h.g[v],j=Array.prototype.indexOf.call(A,_,void 0),Y;(Y=0<=j)&&Array.prototype.splice.call(A,j,1),Y&&(xi(_),h.g[v].length==0&&(delete h.g[v],h.h--))}}function as(h,_,v,A){for(var j=0;j<h.length;++j){var Y=h[j];if(!Y.da&&Y.listener==_&&Y.capture==!!v&&Y.ha==A)return j}return-1}var os="closure_lm_"+(1e6*Math.random()|0),Xs={};function ls(h,_,v,A,j){if(Array.isArray(_)){for(var Y=0;Y<_.length;Y++)ls(h,_[Y],v,A,j);return null}return v=$a(v),h&&h[Mt]?h.K(_,v,g(A)?!!A.capture:!1,j):An(h,_,v,!1,A,j)}function An(h,_,v,A,j,Y){if(!_)throw Error("Invalid event type");var se=g(j)?!!j.capture:!!j,Qe=us(h);if(Qe||(h[os]=Qe=new mi(h)),v=Qe.add(_,v,A,se,Y),v.proxy)return v;if(A=vl(),v.proxy=A,A.src=h,A.listener=v,h.addEventListener)ye||(j=se),j===void 0&&(j=!1),h.addEventListener(_.toString(),A,j);else if(h.attachEvent)h.attachEvent(pi(_.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return v}function vl(){function h(v){return _.call(h.src,h.listener,v)}const _=El;return h}function Jr(h,_,v,A,j){if(Array.isArray(_))for(var Y=0;Y<_.length;Y++)Jr(h,_[Y],v,A,j);else A=g(A)?!!A.capture:!!A,v=$a(v),h&&h[Mt]?(h=h.i,_=String(_).toString(),_ in h.g&&(Y=h.g[_],v=as(Y,v,A,j),-1<v&&(xi(Y[v]),Array.prototype.splice.call(Y,v,1),Y.length==0&&(delete h.g[_],h.h--)))):h&&(h=us(h))&&(_=h.g[_.toString()],h=-1,_&&(h=as(_,v,A,j)),(v=-1<h?_[h]:null)&&Ni(v))}function Ni(h){if(typeof h!="number"&&h&&!h.da){var _=h.src;if(_&&_[Mt])rs(_.i,h);else{var v=h.type,A=h.proxy;_.removeEventListener?_.removeEventListener(v,A,h.capture):_.detachEvent?_.detachEvent(pi(v),A):_.addListener&&_.removeListener&&_.removeListener(A),(v=us(_))?(rs(v,h),v.h==0&&(v.src=null,_[os]=null)):xi(h)}}}function pi(h){return h in Xs?Xs[h]:Xs[h]="on"+h}function El(h,_){if(h.da)h=!0;else{_=new Oe(_,this);var v=h.listener,A=h.ha||h.src;h.fa&&Ni(h),h=v.call(A,_)}return h}function us(h){return h=h[os],h instanceof mi?h:null}var Js="__closure_events_fn_"+(1e9*Math.random()>>>0);function $a(h){return typeof h=="function"?h:(h[Js]||(h[Js]=function(_){return h.handleEvent(_)}),h[Js])}function Et(){re.call(this),this.i=new mi(this),this.M=this,this.F=null}k(Et,re),Et.prototype[Mt]=!0,Et.prototype.removeEventListener=function(h,_,v,A){Jr(this,h,_,v,A)};function Pe(h,_){var v,A=h.F;if(A)for(v=[];A;A=A.F)v.push(A);if(h=h.M,A=_.type||_,typeof _=="string")_=new ne(_,h);else if(_ instanceof ne)_.target=_.target||h;else{var j=_;_=new ne(A,h),D(_,j)}if(j=!0,v)for(var Y=v.length-1;0<=Y;Y--){var se=_.g=v[Y];j=Rn(se,A,!0,_)&&j}if(se=_.g=h,j=Rn(se,A,!0,_)&&j,j=Rn(se,A,!1,_)&&j,v)for(Y=0;Y<v.length;Y++)se=_.g=v[Y],j=Rn(se,A,!1,_)&&j}Et.prototype.N=function(){if(Et.aa.N.call(this),this.i){var h=this.i,_;for(_ in h.g){for(var v=h.g[_],A=0;A<v.length;A++)xi(v[A]);delete h.g[_],h.h--}}this.F=null},Et.prototype.K=function(h,_,v,A){return this.i.add(String(h),_,!1,v,A)},Et.prototype.L=function(h,_,v,A){return this.i.add(String(h),_,!0,v,A)};function Rn(h,_,v,A){if(_=h.i.g[String(_)],!_)return!0;_=_.concat();for(var j=!0,Y=0;Y<_.length;++Y){var se=_[Y];if(se&&!se.da&&se.capture==v){var Qe=se.listener,Ht=se.ha||se.src;se.fa&&rs(h.i,se),j=Qe.call(Ht,A)!==!1&&j}}return j&&!A.defaultPrevented}function $t(h,_,v){if(typeof h=="function")v&&(h=S(h,v));else if(h&&typeof h.handleEvent=="function")h=S(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:f.setTimeout(h,_||0)}function Wa(h){h.g=$t(()=>{h.g=null,h.i&&(h.i=!1,Wa(h))},h.l);const _=h.h;h.h=null,h.m.apply(null,_)}class Tl extends re{constructor(_,v){super(),this.m=_,this.l=v,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Wa(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cs(h){re.call(this),this.h=h,this.g={}}k(cs,re);var hs=[];function ds(h){Re(h.g,function(_,v){this.g.hasOwnProperty(v)&&Ni(_)},h),h.g={}}cs.prototype.N=function(){cs.aa.N.call(this),ds(this)},cs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Un=f.JSON.stringify,Zs=f.JSON.parse,fs=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function ie(){}ie.prototype.h=null;function me(h){return h.h||(h.h=h.i())}function ge(){}var Ee={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Fe(){ne.call(this,"d")}k(Fe,ne);function ze(){ne.call(this,"c")}k(ze,ne);var Ve={},zt=null;function xt(){return zt=zt||new Et}Ve.La="serverreachability";function rn(h){ne.call(this,Ve.La,h)}k(rn,ne);function gi(h){const _=xt();Pe(_,new rn(_))}Ve.STAT_EVENT="statevent";function bc(h,_){ne.call(this,Ve.STAT_EVENT,h),this.stat=_}k(bc,ne);function Tt(h){const _=xt();Pe(_,new bc(_,h))}Ve.Ma="timingevent";function qt(h,_){ne.call(this,Ve.Ma,h),this.size=_}k(qt,ne);function Pt(h,_){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},_)}function Xn(){this.g=!0}Xn.prototype.xa=function(){this.g=!1};function bl(h,_,v,A,j,Y){h.info(function(){if(h.g)if(Y)for(var se="",Qe=Y.split("&"),Ht=0;Ht<Qe.length;Ht++){var $e=Qe[Ht].split("=");if(1<$e.length){var Xt=$e[0];$e=$e[1];var Gt=Xt.split("_");se=2<=Gt.length&&Gt[1]=="type"?se+(Xt+"="+$e+"&"):se+(Xt+"=redacted&")}}else se=null;else se=Y;return"XMLHTTP REQ ("+A+") [attempt "+j+"]: "+_+`
`+v+`
`+se})}function Rf(h,_,v,A,j,Y,se){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+j+"]: "+_+`
`+v+`
`+Y+" "+se})}function er(h,_,v,A){h.info(function(){return"XMLHTTP TEXT ("+_+"): "+Zr(h,v)+(A?" "+A:"")})}function wc(h,_){h.info(function(){return"TIMEOUT: "+_})}Xn.prototype.info=function(){};function Zr(h,_){if(!h.g)return _;if(!_)return null;try{var v=JSON.parse(_);if(v){for(h=0;h<v.length;h++)if(Array.isArray(v[h])){var A=v[h];if(!(2>A.length)){var j=A[1];if(Array.isArray(j)&&!(1>j.length)){var Y=j[0];if(Y!="noop"&&Y!="stop"&&Y!="close")for(var se=1;se<j.length;se++)j[se]=""}}}}return Un(v)}catch{return _}}var tr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ms={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Di;function Oi(){}k(Oi,ie),Oi.prototype.g=function(){return new XMLHttpRequest},Oi.prototype.i=function(){return{}},Di=new Oi;function Cn(h,_,v,A){this.j=h,this.i=_,this.l=v,this.R=A||1,this.U=new cs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Nt}function Nt(){this.i=null,this.g="",this.h=!1}var wl={},Xa={};function _i(h,_,v){h.L=1,h.v=sa(jn(_)),h.m=v,h.P=!0,ps(h,null)}function ps(h,_){h.F=Date.now(),ea(h),h.A=jn(h.v);var v=h.A,A=h.R;Array.isArray(A)||(A=[String(A)]),xl(v.i,"t",A),h.C=0,v=h.j.J,h.h=new Nt,h.g=jc(h.j,v?_:null,!h.m),0<h.O&&(h.M=new Tl(S(h.Y,h,h.g),h.O)),_=h.U,v=h.g,A=h.ca;var j="readystatechange";Array.isArray(j)||(j&&(hs[0]=j.toString()),j=hs);for(var Y=0;Y<j.length;Y++){var se=ls(v,j[Y],A||_.handleEvent,!1,_.h||_);if(!se)break;_.g[se.key]=se}_=h.H?R(h.H):{},h.m?(h.u||(h.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,_)):(h.u="GET",h.g.ea(h.A,h.u,null,_)),gi(),bl(h.i,h.u,h.A,h.l,h.R,h.m)}Cn.prototype.ca=function(h){h=h.target;const _=this.M;_&&ti(h)==3?_.j():this.Y(h)},Cn.prototype.Y=function(h){try{if(h==this.g)e:{const Gt=ti(this.g);var _=this.g.Ba();const ws=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||Dc(this.g)))){this.J||Gt!=4||_==7||(_==8||0>=ws?gi(3):gi(2)),nr(this);var v=this.g.Z();this.X=v;t:if(Sc(this)){var A=Dc(this.g);h="";var j=A.length,Y=ti(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){an(this),ki(this);var se="";break t}this.h.i=new f.TextDecoder}for(_=0;_<j;_++)this.h.h=!0,h+=this.h.i.decode(A[_],{stream:!(Y&&_==j-1)});A.length=0,this.h.g+=h,this.C=0,se=this.h.g}else se=this.g.oa();if(this.o=v==200,Rf(this.i,this.u,this.A,this.l,this.R,Gt,v),this.o){if(this.T&&!this.K){t:{if(this.g){var Qe,Ht=this.g;if((Qe=Ht.g?Ht.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ae(Qe)){var $e=Qe;break t}}$e=null}if(v=$e)er(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ta(this,v);else{this.o=!1,this.s=3,Tt(12),an(this),ki(this);break e}}if(this.P){v=!0;let on;for(;!this.J&&this.C<se.length;)if(on=Ac(this,se),on==Xa){Gt==4&&(this.s=4,Tt(14),v=!1),er(this.i,this.l,null,"[Incomplete Response]");break}else if(on==wl){this.s=4,Tt(15),er(this.i,this.l,se,"[Invalid Chunk]"),v=!1;break}else er(this.i,this.l,on,null),ta(this,on);if(Sc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||se.length!=0||this.h.h||(this.s=1,Tt(16),v=!1),this.o=this.o&&v,!v)er(this.i,this.l,se,"[Invalid Chunked Response]"),an(this),ki(this);else if(0<se.length&&!this.W){this.W=!0;var Xt=this.j;Xt.g==this&&Xt.ba&&!Xt.M&&(Xt.j.info("Great, no buffering proxy detected. Bytes received: "+se.length),da(Xt),Xt.M=!0,Tt(11))}}else er(this.i,this.l,se,null),ta(this,se);Gt==4&&an(this),this.o&&!this.J&&(Gt==4?Vc(this.j,this):(this.o=!1,ea(this)))}else Df(this.g),v==400&&0<se.indexOf("Unknown SID")?(this.s=3,Tt(12)):(this.s=0,Tt(13)),an(this),ki(this)}}}catch{}finally{}};function Sc(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Ac(h,_){var v=h.C,A=_.indexOf(`
`,v);return A==-1?Xa:(v=Number(_.substring(v,A)),isNaN(v)?wl:(A+=1,A+v>_.length?Xa:(_=_.slice(A,A+v),h.C=A+v,_)))}Cn.prototype.cancel=function(){this.J=!0,an(this)};function ea(h){h.S=Date.now()+h.I,Rc(h,h.I)}function Rc(h,_){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Pt(S(h.ba,h),_)}function nr(h){h.B&&(f.clearTimeout(h.B),h.B=null)}Cn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(wc(this.i,this.A),this.L!=2&&(gi(),Tt(17)),an(this),this.s=2,ki(this)):Rc(this,this.S-h)};function ki(h){h.j.G==0||h.J||Vc(h.j,h)}function an(h){nr(h);var _=h.M;_&&typeof _.ma=="function"&&_.ma(),h.M=null,ds(h.U),h.g&&(_=h.g,h.g=null,_.abort(),_.ma())}function ta(h,_){try{var v=h.j;if(v.G!=0&&(v.g==h||Sl(v.h,h))){if(!h.K&&Sl(v.h,h)&&v.G==3){try{var A=v.Da.g.parse(_)}catch{A=null}if(Array.isArray(A)&&A.length==3){var j=A;if(j[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<h.F)uo(v),oo(v);else break e;Ml(v),Tt(18)}}else v.za=j[1],0<v.za-v.T&&37500>j[2]&&v.F&&v.v==0&&!v.C&&(v.C=Pt(S(v.Za,v),6e3));if(1>=Za(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else bs(v,11)}else if((h.K||v.g==h)&&uo(v),!ae(_))for(j=v.Da.g.parse(_),_=0;_<j.length;_++){let $e=j[_];if(v.T=$e[0],$e=$e[1],v.G==2)if($e[0]=="c"){v.K=$e[1],v.ia=$e[2];const Xt=$e[3];Xt!=null&&(v.la=Xt,v.j.info("VER="+v.la));const Gt=$e[4];Gt!=null&&(v.Aa=Gt,v.j.info("SVER="+v.Aa));const ws=$e[5];ws!=null&&typeof ws=="number"&&0<ws&&(A=1.5*ws,v.L=A,v.j.info("backChannelRequestTimeoutMs_="+A)),A=v;const on=h.g;if(on){const Bi=on.g?on.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bi){var Y=A.h;Y.g||Bi.indexOf("spdy")==-1&&Bi.indexOf("quic")==-1&&Bi.indexOf("h2")==-1||(Y.j=Y.l,Y.g=new Set,Y.h&&(eo(Y,Y.h),Y.h=null))}if(A.D){const Vl=on.g?on.g.getResponseHeader("X-HTTP-Session-Id"):null;Vl&&(A.ya=Vl,lt(A.I,A.D,Vl))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-h.F,v.j.info("Handshake RTT: "+v.R+"ms")),A=v;var se=h;if(A.qa=Uc(A,A.J?A.ia:null,A.W),se.K){In(A.h,se);var Qe=se,Ht=A.L;Ht&&(Qe.I=Ht),Qe.B&&(nr(Qe),ea(Qe)),A.g=se}else Mc(A);0<v.i.length&&lo(v)}else $e[0]!="stop"&&$e[0]!="close"||bs(v,7);else v.G==3&&($e[0]=="stop"||$e[0]=="close"?$e[0]=="stop"?bs(v,7):Ol(v):$e[0]!="noop"&&v.l&&v.l.ta($e),v.v=0)}}gi(4)}catch{}}var Cc=class{constructor(h,_){this.g=h,this.map=_}};function gs(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ja(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Za(h){return h.h?1:h.g?h.g.size:0}function Sl(h,_){return h.h?h.h==_:h.g?h.g.has(_):!1}function eo(h,_){h.g?h.g.add(_):h.h=_}function In(h,_){h.h&&h.h==_?h.h=null:h.g&&h.g.has(_)&&h.g.delete(_)}gs.prototype.cancel=function(){if(this.i=Al(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Al(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let _=h.i;for(const v of h.g.values())_=_.concat(v.D);return _}return q(h.i)}function Cf(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var _=[],v=h.length,A=0;A<v;A++)_.push(h[A]);return _}_=[],v=0;for(A in h)_[v++]=h[A];return _}function to(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var _=[];h=h.length;for(var v=0;v<h;v++)_.push(v);return _}_=[],v=0;for(const A in h)_[v++]=A;return _}}}function Rl(h,_){if(h.forEach&&typeof h.forEach=="function")h.forEach(_,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,_,void 0);else for(var v=to(h),A=Cf(h),j=A.length,Y=0;Y<j;Y++)_.call(void 0,A[Y],v&&v[Y],h)}var na=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function If(h,_){if(h){h=h.split("&");for(var v=0;v<h.length;v++){var A=h[v].indexOf("="),j=null;if(0<=A){var Y=h[v].substring(0,A);j=h[v].substring(A+1)}else Y=h[v];_(Y,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Vt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Vt){this.h=h.h,ia(this,h.j),this.o=h.o,this.g=h.g,ir(this,h.s),this.l=h.l;var _=h.i,v=new ys;v.i=_.i,_.g&&(v.g=new Map(_.g),v.h=_.h),_s(this,v),this.m=h.m}else h&&(_=String(h).match(na))?(this.h=!1,ia(this,_[1]||"",!0),this.o=Jn(_[2]||""),this.g=Jn(_[3]||"",!0),ir(this,_[4]),this.l=Jn(_[5]||"",!0),_s(this,_[6]||"",!0),this.m=Jn(_[7]||"")):(this.h=!1,this.i=new ys(null,this.h))}Vt.prototype.toString=function(){var h=[],_=this.j;_&&h.push(ra(_,Cl,!0),":");var v=this.g;return(v||_=="file")&&(h.push("//"),(_=this.o)&&h.push(ra(_,Cl,!0),"@"),h.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&h.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&h.push("/"),h.push(ra(v,v.charAt(0)=="/"?xf:Il,!0))),(v=this.i.toString())&&h.push("?",v),(v=this.m)&&h.push("#",ra(v,no)),h.join("")};function jn(h){return new Vt(h)}function ia(h,_,v){h.j=v?Jn(_,!0):_,h.j&&(h.j=h.j.replace(/:$/,""))}function ir(h,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);h.s=_}else h.s=null}function _s(h,_,v){_ instanceof ys?(h.i=_,xc(h.i,h.h)):(v||(_=ra(_,Nf)),h.i=new ys(_,h.h))}function lt(h,_,v){h.i.set(_,v)}function sa(h){return lt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Jn(h,_){return h?_?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ra(h,_,v){return typeof h=="string"?(h=encodeURI(h).replace(_,Ic),v&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Ic(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Cl=/[#\/\?@]/g,Il=/[#\?:]/g,xf=/[#\?]/g,Nf=/[#\?@]/g,no=/#/g;function ys(h,_){this.h=this.g=null,this.i=h||null,this.j=!!_}function Zn(h){h.g||(h.g=new Map,h.h=0,h.i&&If(h.i,function(_,v){h.add(decodeURIComponent(_.replace(/\+/g," ")),v)}))}i=ys.prototype,i.add=function(h,_){Zn(this),this.i=null,h=Mi(this,h);var v=this.g.get(h);return v||this.g.set(h,v=[]),v.push(_),this.h+=1,this};function vs(h,_){Zn(h),_=Mi(h,_),h.g.has(_)&&(h.i=null,h.h-=h.g.get(_).length,h.g.delete(_))}function Es(h,_){return Zn(h),_=Mi(h,_),h.g.has(_)}i.forEach=function(h,_){Zn(this),this.g.forEach(function(v,A){v.forEach(function(j){h.call(_,j,A,this)},this)},this)},i.na=function(){Zn(this);const h=Array.from(this.g.values()),_=Array.from(this.g.keys()),v=[];for(let A=0;A<_.length;A++){const j=h[A];for(let Y=0;Y<j.length;Y++)v.push(_[A])}return v},i.V=function(h){Zn(this);let _=[];if(typeof h=="string")Es(this,h)&&(_=_.concat(this.g.get(Mi(this,h))));else{h=Array.from(this.g.values());for(let v=0;v<h.length;v++)_=_.concat(h[v])}return _},i.set=function(h,_){return Zn(this),this.i=null,h=Mi(this,h),Es(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[_]),this.h+=1,this},i.get=function(h,_){return h?(h=this.V(h),0<h.length?String(h[0]):_):_};function xl(h,_,v){vs(h,_),0<v.length&&(h.i=null,h.g.set(Mi(h,_),q(v)),h.h+=v.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],_=Array.from(this.g.keys());for(var v=0;v<_.length;v++){var A=_[v];const Y=encodeURIComponent(String(A)),se=this.V(A);for(A=0;A<se.length;A++){var j=Y;se[A]!==""&&(j+="="+encodeURIComponent(String(se[A]))),h.push(j)}}return this.i=h.join("&")};function Mi(h,_){return _=String(_),h.j&&(_=_.toLowerCase()),_}function xc(h,_){_&&!h.j&&(Zn(h),h.i=null,h.g.forEach(function(v,A){var j=A.toLowerCase();A!=j&&(vs(this,A),xl(this,j,v))},h)),h.j=_}function aa(h,_){const v=new Xn;if(f.Image){const A=new Image;A.onload=P(ei,v,"TestLoadImage: loaded",!0,_,A),A.onerror=P(ei,v,"TestLoadImage: error",!1,_,A),A.onabort=P(ei,v,"TestLoadImage: abort",!1,_,A),A.ontimeout=P(ei,v,"TestLoadImage: timeout",!1,_,A),f.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else _(!1)}function yi(h,_){const v=new Xn,A=new AbortController,j=setTimeout(()=>{A.abort(),ei(v,"TestPingServer: timeout",!1,_)},1e4);fetch(h,{signal:A.signal}).then(Y=>{clearTimeout(j),Y.ok?ei(v,"TestPingServer: ok",!0,_):ei(v,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(j),ei(v,"TestPingServer: error",!1,_)})}function ei(h,_,v,A,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),A(v)}catch{}}function oa(){this.g=new fs}function Pi(h,_,v){const A=v||"";try{Rl(h,function(j,Y){let se=j;g(j)&&(se=Un(j)),_.push(A+Y+"="+encodeURIComponent(se))})}catch(j){throw _.push(A+"type="+encodeURIComponent("_badmap")),j}}function sr(h){this.l=h.Ub||null,this.j=h.eb||!1}k(sr,ie),sr.prototype.g=function(){return new Ts(this.l,this.j)},sr.prototype.i=function(h){return function(){return h}}({});function Ts(h,_){Et.call(this),this.D=h,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(Ts,Et),i=Ts.prototype,i.open=function(h,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=_,this.readyState=1,Li(this)},i.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(_.body=h),(this.D||f).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vi(this)),this.readyState=0},i.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Li(this)),this.g&&(this.readyState=3,Li(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Nl(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Nl(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}i.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var _=h.value?h.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!h.done}))&&(this.response=this.responseText+=_)}h.done?Vi(this):Li(this),this.readyState==3&&Nl(this)}},i.Ra=function(h){this.g&&(this.response=this.responseText=h,Vi(this))},i.Qa=function(h){this.g&&(this.response=h,Vi(this))},i.ga=function(){this.g&&Vi(this)};function Vi(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Li(h)}i.setRequestHeader=function(h,_){this.u.append(h,_)},i.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],_=this.h.entries();for(var v=_.next();!v.done;)v=v.value,h.push(v[0]+": "+v[1]),v=_.next();return h.join(`\r
`)};function Li(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ts.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Dl(h){let _="";return Re(h,function(v,A){_+=A,_+=":",_+=v,_+=`\r
`}),_}function Wt(h,_,v){e:{for(A in v){var A=!1;break e}A=!0}A||(v=Dl(v),typeof h=="string"?v!=null&&encodeURIComponent(String(v)):lt(h,_,v))}function nt(h){Et.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(nt,Et);var io=/^https?$/i,la=["POST","PUT"];i=nt.prototype,i.Ha=function(h){this.J=h},i.ea=function(h,_,v,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);_=_?_.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Di.g(),this.v=this.o?me(this.o):me(Di),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(_,String(h),!0),this.B=!1}catch(Y){Nc(this,Y);return}if(h=v||"",v=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var j in A)v.set(j,A[j]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const Y of A.keys())v.set(Y,A.get(Y));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(v.keys()).find(Y=>Y.toLowerCase()=="content-type"),j=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(la,_,void 0))||A||j||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Y,se]of v)this.g.setRequestHeader(Y,se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ua(this),this.u=!0,this.g.send(h),this.u=!1}catch(Y){Nc(this,Y)}};function Nc(h,_){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=_,h.m=5,so(h),Ui(h)}function so(h){h.A||(h.A=!0,Pe(h,"complete"),Pe(h,"error"))}i.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Pe(this,"complete"),Pe(this,"abort"),Ui(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ui(this,!0)),nt.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?ro(this):this.bb())},i.bb=function(){ro(this)};function ro(h){if(h.h&&typeof c<"u"&&(!h.v[1]||ti(h)!=4||h.Z()!=2)){if(h.u&&ti(h)==4)$t(h.Ea,0,h);else if(Pe(h,"readystatechange"),ti(h)==4){h.h=!1;try{const se=h.Z();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var v;if(!(v=_)){var A;if(A=se===0){var j=String(h.D).match(na)[1]||null;!j&&f.self&&f.self.location&&(j=f.self.location.protocol.slice(0,-1)),A=!io.test(j?j.toLowerCase():"")}v=A}if(v)Pe(h,"complete"),Pe(h,"success");else{h.m=6;try{var Y=2<ti(h)?h.g.statusText:""}catch{Y=""}h.l=Y+" ["+h.Z()+"]",so(h)}}finally{Ui(h)}}}}function Ui(h,_){if(h.g){ua(h);const v=h.g,A=h.v[0]?()=>{}:null;h.g=null,h.v=null,_||Pe(h,"ready");try{v.onreadystatechange=A}catch{}}}function ua(h){h.I&&(f.clearTimeout(h.I),h.I=null)}i.isActive=function(){return!!this.g};function ti(h){return h.g?h.g.readyState:0}i.Z=function(){try{return 2<ti(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(h){if(this.g){var _=this.g.responseText;return h&&_.indexOf(h)==0&&(_=_.substring(h.length)),Zs(_)}};function Dc(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Df(h){const _={};h=(h.g&&2<=ti(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(ae(h[A]))continue;var v=V(h[A]);const j=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const Y=_[j]||[];_[j]=Y,Y.push(v)}M(_,function(A){return A.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ca(h,_,v){return v&&v.internalChannelParams&&v.internalChannelParams[h]||_}function ao(h){this.Aa=0,this.i=[],this.j=new Xn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ca("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ca("baseRetryDelayMs",5e3,h),this.cb=ca("retryDelaySeedMs",1e4,h),this.Wa=ca("forwardChannelMaxRetries",2,h),this.wa=ca("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new gs(h&&h.concurrentRequestLimit),this.Da=new oa,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=ao.prototype,i.la=8,i.G=1,i.connect=function(h,_,v,A){Tt(0),this.W=h,this.H=_||{},v&&A!==void 0&&(this.H.OSID=v,this.H.OAID=A),this.F=this.X,this.I=Uc(this,null,this.W),lo(this)};function Ol(h){if(Oc(h),h.G==3){var _=h.U++,v=jn(h.I);if(lt(v,"SID",h.K),lt(v,"RID",_),lt(v,"TYPE","terminate"),ha(h,v),_=new Cn(h,h.j,_),_.L=2,_.v=sa(jn(v)),v=!1,f.navigator&&f.navigator.sendBeacon)try{v=f.navigator.sendBeacon(_.v.toString(),"")}catch{}!v&&f.Image&&(new Image().src=_.v,v=!0),v||(_.g=jc(_.j,null),_.g.ea(_.v)),_.F=Date.now(),ea(_)}Lc(h)}function oo(h){h.g&&(da(h),h.g.cancel(),h.g=null)}function Oc(h){oo(h),h.u&&(f.clearTimeout(h.u),h.u=null),uo(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function lo(h){if(!Ja(h.h)&&!h.s){h.s=!0;var _=h.Ga;te||N(),Z||(te(),Z=!0),fe.add(_,h),h.B=0}}function Of(h,_){return Za(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=_.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Pt(S(h.Ga,h,_),Pl(h,h.B)),h.B++,!0)}i.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const j=new Cn(this,this.j,h);let Y=this.o;if(this.S&&(Y?(Y=R(Y),D(Y,this.S)):Y=this.S),this.m!==null||this.O||(j.H=Y,Y=null),this.P)e:{for(var _=0,v=0;v<this.i.length;v++){t:{var A=this.i[v];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(_+=A,4096<_){_=v;break e}if(_===4096||v===this.i.length-1){_=v+1;break e}}_=1e3}else _=1e3;_=kc(this,j,_),v=jn(this.I),lt(v,"RID",h),lt(v,"CVER",22),this.D&&lt(v,"X-HTTP-Session-Id",this.D),ha(this,v),Y&&(this.O?_="headers="+encodeURIComponent(String(Dl(Y)))+"&"+_:this.m&&Wt(v,this.m,Y)),eo(this.h,j),this.Ua&&lt(v,"TYPE","init"),this.P?(lt(v,"$req",_),lt(v,"SID","null"),j.T=!0,_i(j,v,null)):_i(j,v,_),this.G=2}}else this.G==3&&(h?kl(this,h):this.i.length==0||Ja(this.h)||kl(this))};function kl(h,_){var v;_?v=_.l:v=h.U++;const A=jn(h.I);lt(A,"SID",h.K),lt(A,"RID",v),lt(A,"AID",h.T),ha(h,A),h.m&&h.o&&Wt(A,h.m,h.o),v=new Cn(h,h.j,v,h.B+1),h.m===null&&(v.H=h.o),_&&(h.i=_.D.concat(h.i)),_=kc(h,v,1e3),v.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),eo(h.h,v),_i(v,A,_)}function ha(h,_){h.H&&Re(h.H,function(v,A){lt(_,A,v)}),h.l&&Rl({},function(v,A){lt(_,A,v)})}function kc(h,_,v){v=Math.min(h.i.length,v);var A=h.l?S(h.l.Na,h.l,h):null;e:{var j=h.i;let Y=-1;for(;;){const se=["count="+v];Y==-1?0<v?(Y=j[0].g,se.push("ofs="+Y)):Y=0:se.push("ofs="+Y);let Qe=!0;for(let Ht=0;Ht<v;Ht++){let $e=j[Ht].g;const Xt=j[Ht].map;if($e-=Y,0>$e)Y=Math.max(0,j[Ht].g-100),Qe=!1;else try{Pi(Xt,se,"req"+$e+"_")}catch{A&&A(Xt)}}if(Qe){A=se.join("&");break e}}}return h=h.i.splice(0,v),_.D=h,A}function Mc(h){if(!h.g&&!h.u){h.Y=1;var _=h.Fa;te||N(),Z||(te(),Z=!0),fe.add(_,h),h.v=0}}function Ml(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Pt(S(h.Fa,h),Pl(h,h.v)),h.v++,!0)}i.Fa=function(){if(this.u=null,Pc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Pt(S(this.ab,this),h)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Tt(10),oo(this),Pc(this))};function da(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function Pc(h){h.g=new Cn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var _=jn(h.qa);lt(_,"RID","rpc"),lt(_,"SID",h.K),lt(_,"AID",h.T),lt(_,"CI",h.F?"0":"1"),!h.F&&h.ja&&lt(_,"TO",h.ja),lt(_,"TYPE","xmlhttp"),ha(h,_),h.m&&h.o&&Wt(_,h.m,h.o),h.L&&(h.g.I=h.L);var v=h.g;h=h.ia,v.L=1,v.v=sa(jn(_)),v.m=null,v.P=!0,ps(v,h)}i.Za=function(){this.C!=null&&(this.C=null,oo(this),Ml(this),Tt(19))};function uo(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function Vc(h,_){var v=null;if(h.g==_){uo(h),da(h),h.g=null;var A=2}else if(Sl(h.h,_))v=_.D,In(h.h,_),A=1;else return;if(h.G!=0){if(_.o)if(A==1){v=_.m?_.m.length:0,_=Date.now()-_.F;var j=h.B;A=xt(),Pe(A,new qt(A,v)),lo(h)}else Mc(h);else if(j=_.s,j==3||j==0&&0<_.X||!(A==1&&Of(h,_)||A==2&&Ml(h)))switch(v&&0<v.length&&(_=h.h,_.i=_.i.concat(v)),j){case 1:bs(h,5);break;case 4:bs(h,10);break;case 3:bs(h,6);break;default:bs(h,2)}}}function Pl(h,_){let v=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(v*=2),v*_}function bs(h,_){if(h.j.info("Error code "+_),_==2){var v=S(h.fb,h),A=h.Xa;const j=!A;A=new Vt(A||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||ia(A,"https"),sa(A),j?aa(A.toString(),v):yi(A.toString(),v)}else Tt(2);h.G=0,h.l&&h.l.sa(_),Lc(h),Oc(h)}i.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Tt(2)):(this.j.info("Failed to ping google.com"),Tt(1))};function Lc(h){if(h.G=0,h.ka=[],h.l){const _=Al(h.h);(_.length!=0||h.i.length!=0)&&(K(h.ka,_),K(h.ka,h.i),h.h.i.length=0,q(h.i),h.i.length=0),h.l.ra()}}function Uc(h,_,v){var A=v instanceof Vt?jn(v):new Vt(v);if(A.g!="")_&&(A.g=_+"."+A.g),ir(A,A.s);else{var j=f.location;A=j.protocol,_=_?_+"."+j.hostname:j.hostname,j=+j.port;var Y=new Vt(null);A&&ia(Y,A),_&&(Y.g=_),j&&ir(Y,j),v&&(Y.l=v),A=Y}return v=h.D,_=h.ya,v&&_&&lt(A,v,_),lt(A,"VER",h.la),ha(h,A),A}function jc(h,_,v){if(_&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=h.Ca&&!h.pa?new nt(new sr({eb:v})):new nt(h.pa),_.Ha(h.J),_}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Bc(){}i=Bc.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function co(){}co.prototype.g=function(h,_){return new xn(h,_)};function xn(h,_){Et.call(this),this.g=new ao(_),this.l=h,this.h=_&&_.messageUrlParams||null,h=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(h?h["X-WebChannel-Content-Type"]=_.messageContentType:h={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(h?h["X-WebChannel-Client-Profile"]=_.va:h={"X-WebChannel-Client-Profile":_.va}),this.g.S=h,(h=_&&_.Sb)&&!ae(h)&&(this.g.m=h),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!ae(_)&&(this.g.D=_,h=this.h,h!==null&&_ in h&&(h=this.h,_ in h&&delete h[_])),this.j=new ji(this)}k(xn,Et),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){Ol(this.g)},xn.prototype.o=function(h){var _=this.g;if(typeof h=="string"){var v={};v.__data__=h,h=v}else this.u&&(v={},v.__data__=Un(h),h=v);_.i.push(new Cc(_.Ya++,h)),_.G==3&&lo(_)},xn.prototype.N=function(){this.g.l=null,delete this.j,Ol(this.g),delete this.g,xn.aa.N.call(this)};function Fc(h){Fe.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var _=h.__sm__;if(_){e:{for(const v in _){h=v;break e}h=void 0}(this.i=h)&&(h=this.i,_=_!==null&&h in _?_[h]:void 0),this.data=_}else this.data=h}k(Fc,Fe);function zc(){ze.call(this),this.status=1}k(zc,ze);function ji(h){this.g=h}k(ji,Bc),ji.prototype.ua=function(){Pe(this.g,"a")},ji.prototype.ta=function(h){Pe(this.g,new Fc(h))},ji.prototype.sa=function(h){Pe(this.g,new zc)},ji.prototype.ra=function(){Pe(this.g,"b")},co.prototype.createWebChannel=co.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,_1=function(){return new co},g1=function(){return xt()},p1=Ve,hg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},tr.NO_ERROR=0,tr.TIMEOUT=8,tr.HTTP_ERROR=6,ed=tr,ms.COMPLETE="complete",m1=ms,ge.EventType=Ee,Ee.OPEN="a",Ee.CLOSE="b",Ee.ERROR="c",Ee.MESSAGE="d",Et.prototype.listen=Et.prototype.K,Du=ge,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,f1=nt}).apply(typeof Gh<"u"?Gh:typeof self<"u"?self:typeof window<"u"?window:{});const mT="@firebase/firestore",pT="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vn.UNAUTHENTICATED=new vn(null),vn.GOOGLE_CREDENTIALS=new vn("google-credentials-uid"),vn.FIRST_PARTY=new vn("first-party-uid"),vn.MOCK_USER=new vn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ml="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=new Qd("@firebase/firestore");function Fo(){return La.logLevel}function de(i,...e){if(La.logLevel<=Ge.DEBUG){const t=e.map(o_);La.debug(`Firestore (${ml}): ${i}`,...t)}}function Ks(i,...e){if(La.logLevel<=Ge.ERROR){const t=e.map(o_);La.error(`Firestore (${ml}): ${i}`,...t)}}function Fr(i,...e){if(La.logLevel<=Ge.WARN){const t=e.map(o_);La.warn(`Firestore (${ml}): ${i}`,...t)}}function o_(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(i,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,y1(i,s,t)}function y1(i,e,t){let s=`FIRESTORE (${ml}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Ks(s),new Error(s)}function st(i,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,i||y1(e,a,s)}function Me(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends ss{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class k2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(vn.UNAUTHENTICATED))}shutdown(){}}class M2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class P2{constructor(e){this.t=e,this.currentUser=vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){st(this.o===void 0,42304);let s=this.i;const a=p=>this.i!==s?(s=this.i,t(p)):Promise.resolve();let l=new Fs;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Fs,e.enqueueRetryable(()=>a(this.currentUser))};const c=()=>{const p=l;e.enqueueRetryable(async()=>{await p.promise,await a(this.currentUser)})},f=p=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(p=>f(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Fs)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(st(typeof s.accessToken=="string",31837,{l:s}),new v1(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return st(e===null||typeof e=="string",2055,{h:e}),new vn(e)}}class V2{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=vn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class L2{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new V2(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(vn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class gT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class U2{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Pn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){st(this.o===void 0,3512);const s=l=>{l.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,de("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable(()=>s(l))};const a=l=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(l=>a(l)),setTimeout(()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new gT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(st(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gT(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j2(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<i;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E1(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=j2(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function je(i,e){return i<e?-1:i>e?1:0}function dg(i,e){let t=0;for(;t<i.length&&t<e.length;){const s=i.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return je(s,a);{const l=E1(),c=B2(l.encode(_T(i,t)),l.encode(_T(e,t)));return c!==0?c:je(s,a)}}t+=s>65535?2:1}return je(i.length,e.length)}function _T(i,e){return i.codePointAt(e)>65535?i.substring(e,e+2):i.substring(e,e+1)}function B2(i,e){for(let t=0;t<i.length&&t<e.length;++t)if(i[t]!==e[t])return je(i[t],e[t]);return je(i.length,e.length)}function il(i,e,t){return i.length===e.length&&i.every((s,a)=>t(s,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT="__name__";class Yi{constructor(e,t,s){t===void 0?t=0:t>e.length&&xe(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&xe(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Yi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yi?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=Yi.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return je(e.length,t.length)}static compareSegments(e,t){const s=Yi.isNumericId(e),a=Yi.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?Yi.extractNumericId(e).compare(Yi.extractNumericId(t)):dg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vr.fromString(e.substring(4,e.length-2))}}class pt extends Yi{construct(e,t,s){return new pt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new he(W.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(a=>a.length>0))}return new pt(t)}static emptyPath(){return new pt([])}}const F2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class fn extends Yi{construct(e,t,s){return new fn(e,t,s)}static isValidIdentifier(e){return F2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yT}static keyField(){return new fn([yT])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new he(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let c=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new he(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[a+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new he(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=p,a+=2}else f==="`"?(c=!c,a++):f!=="."||c?(s+=f,a++):(l(),a++)}if(l(),c)throw new he(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new fn(t)}static emptyPath(){return new fn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(pt.fromString(e))}static fromName(e){return new we(pt.fromString(e).popFirst(5))}static empty(){return new we(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new pt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(i,e,t){if(!t)throw new he(W.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function z2(i,e,t,s){if(e===!0&&s===!0)throw new he(W.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function vT(i){if(!we.isDocumentKey(i))throw new he(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function ET(i){if(we.isDocumentKey(i))throw new he(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function b1(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function tf(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":xe(12329,{type:typeof i})}function di(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new he(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tf(i);throw new he(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ft(i,e){const t={typeString:i};return e&&(t.value=e),t}function hc(i,e){if(!b1(i))throw new he(W.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in i)){t=`JSON missing required field: '${s}'`;break}const c=i[s];if(a&&typeof c!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new he(W.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT=-62135596800,bT=1e6;class yt{static now(){return yt.fromMillis(Date.now())}static fromDate(e){return yt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*bT);return new yt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new he(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new he(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<TT)throw new he(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/bT}_compareTo(e){return this.seconds===e.seconds?je(this.nanoseconds,e.nanoseconds):je(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(hc(e,yt._jsonSchema))return new yt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-TT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yt._jsonSchemaVersion="firestore/timestamp/1.0",yt._jsonSchema={type:Ft("string",yt._jsonSchemaVersion),seconds:Ft("number"),nanoseconds:Ft("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{static fromTimestamp(e){return new ke(e)}static min(){return new ke(new yt(0,0))}static max(){return new ke(new yt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $u=-1;function q2(i,e){const t=i.toTimestamp().seconds,s=i.toTimestamp().nanoseconds+1,a=ke.fromTimestamp(s===1e9?new yt(t+1,0):new yt(t,s));return new zr(a,we.empty(),e)}function H2(i){return new zr(i.readTime,i.key,$u)}class zr{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new zr(ke.min(),we.empty(),$u)}static max(){return new zr(ke.max(),we.empty(),$u)}}function G2(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=we.comparator(i.documentKey,e.documentKey),t!==0?t:je(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Y2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pl(i){if(i.code!==W.FAILED_PRECONDITION||i.message!==K2)throw i;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ee((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ee?t:ee.resolve(t)}catch(t){return ee.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ee.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ee.reject(t)}static resolve(e){return new ee((t,s)=>{t(e)})}static reject(e){return new ee((t,s)=>{s(e)})}static waitFor(e){return new ee((t,s)=>{let a=0,l=0,c=!1;e.forEach(f=>{++a,f.next(()=>{++l,c&&l===a&&t()},p=>s(p))}),c=!0,l===a&&t()})}static or(e){let t=ee.resolve(!1);for(const s of e)t=t.next(a=>a?ee.resolve(a):s());return t}static forEach(e,t){const s=[];return e.forEach((a,l)=>{s.push(t.call(this,a,l))}),this.waitFor(s)}static mapArray(e,t){return new ee((s,a)=>{const l=e.length,c=new Array(l);let f=0;for(let p=0;p<l;p++){const g=p;t(e[g]).next(y=>{c[g]=y,++f,f===l&&s(c)},y=>a(y))}})}static doWhile(e,t){return new ee((s,a)=>{const l=()=>{e()===!0?t().next(()=>{l()},a):s()};l()})}}function Q2(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function gl(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}nf.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u_=-1;function sf(i){return i==null}function bd(i){return i===0&&1/i==-1/0}function $2(i){return typeof i=="number"&&Number.isInteger(i)&&!bd(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1="";function W2(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=wT(e)),e=X2(i.get(t),e);return wT(e)}function X2(i,e){let t=e;const s=i.length;for(let a=0;a<s;a++){const l=i.charAt(a);switch(l){case"\0":t+="";break;case w1:t+="";break;default:t+=l}}return t}function wT(i){return i+w1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ST(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Qr(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function S1(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,t){this.comparator=e,this.root=t||hn.EMPTY}insert(e,t){return new At(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,hn.BLACK,null,null))}remove(e){return new At(this.comparator,this.root.remove(e,this.comparator).copy(null,null,hn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kh(this.root,e,this.comparator,!0)}}class Kh{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class hn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??hn.RED,this.left=a??hn.EMPTY,this.right=l??hn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new hn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return hn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return hn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,hn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,hn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xe(27949);return e+(this.isRed()?0:1)}}hn.EMPTY=null,hn.RED=!0,hn.BLACK=!1;hn.EMPTY=new class{constructor(){this.size=0}get key(){throw xe(57766)}get value(){throw xe(16141)}get color(){throw xe(16727)}get left(){throw xe(29726)}get right(){throw xe(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new hn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.comparator=e,this.data=new At(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new AT(this.data.getIterator())}getIteratorFrom(e){return new AT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Qt)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Qt(this.comparator);return t.data=e,t}}class AT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this.fields=e,e.sort(fn.comparator)}static empty(){return new Qn([])}unionWith(e){let t=new Qt(fn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Qn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return il(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new A1("Invalid base64 string: "+l):l}}(e);return new mn(t)}static fromUint8Array(e){const t=function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l}(e);return new mn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return je(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mn.EMPTY_BYTE_STRING=new mn("");const J2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qr(i){if(st(!!i,39018),typeof i=="string"){let e=0;const t=J2.exec(i);if(st(!!t,46558,{timestamp:i}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(i);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:kt(i.seconds),nanos:kt(i.nanos)}}function kt(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Hr(i){return typeof i=="string"?mn.fromBase64String(i):mn.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1="server_timestamp",C1="__type__",I1="__previous_value__",x1="__local_write_time__";function c_(i){var e,t;return((t=(((e=i?.mapValue)===null||e===void 0?void 0:e.fields)||{})[C1])===null||t===void 0?void 0:t.stringValue)===R1}function rf(i){const e=i.mapValue.fields[I1];return c_(e)?rf(e):e}function Wu(i){const e=qr(i.mapValue.fields[x1].timestampValue);return new yt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e,t,s,a,l,c,f,p,g,y){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=y}}const wd="(default)";class Xu{constructor(e,t){this.projectId=e,this.database=t||wd}static empty(){return new Xu("","")}get isDefaultDatabase(){return this.database===wd}isEqual(e){return e instanceof Xu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N1="__type__",eD="__max__",Yh={mapValue:{}},D1="__vector__",Sd="value";function Gr(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?c_(i)?4:nD(i)?9007199254740991:tD(i)?10:11:xe(28295,{value:i})}function is(i,e){if(i===e)return!0;const t=Gr(i);if(t!==Gr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return Wu(i).isEqual(Wu(e));case 3:return function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=qr(a.timestampValue),f=qr(l.timestampValue);return c.seconds===f.seconds&&c.nanos===f.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(a,l){return Hr(a.bytesValue).isEqual(Hr(l.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(a,l){return kt(a.geoPointValue.latitude)===kt(l.geoPointValue.latitude)&&kt(a.geoPointValue.longitude)===kt(l.geoPointValue.longitude)}(i,e);case 2:return function(a,l){if("integerValue"in a&&"integerValue"in l)return kt(a.integerValue)===kt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=kt(a.doubleValue),f=kt(l.doubleValue);return c===f?bd(c)===bd(f):isNaN(c)&&isNaN(f)}return!1}(i,e);case 9:return il(i.arrayValue.values||[],e.arrayValue.values||[],is);case 10:case 11:return function(a,l){const c=a.mapValue.fields||{},f=l.mapValue.fields||{};if(ST(c)!==ST(f))return!1;for(const p in c)if(c.hasOwnProperty(p)&&(f[p]===void 0||!is(c[p],f[p])))return!1;return!0}(i,e);default:return xe(52216,{left:i})}}function Ju(i,e){return(i.values||[]).find(t=>is(t,e))!==void 0}function sl(i,e){if(i===e)return 0;const t=Gr(i),s=Gr(e);if(t!==s)return je(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return je(i.booleanValue,e.booleanValue);case 2:return function(l,c){const f=kt(l.integerValue||l.doubleValue),p=kt(c.integerValue||c.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1}(i,e);case 3:return RT(i.timestampValue,e.timestampValue);case 4:return RT(Wu(i),Wu(e));case 5:return dg(i.stringValue,e.stringValue);case 6:return function(l,c){const f=Hr(l),p=Hr(c);return f.compareTo(p)}(i.bytesValue,e.bytesValue);case 7:return function(l,c){const f=l.split("/"),p=c.split("/");for(let g=0;g<f.length&&g<p.length;g++){const y=je(f[g],p[g]);if(y!==0)return y}return je(f.length,p.length)}(i.referenceValue,e.referenceValue);case 8:return function(l,c){const f=je(kt(l.latitude),kt(c.latitude));return f!==0?f:je(kt(l.longitude),kt(c.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return CT(i.arrayValue,e.arrayValue);case 10:return function(l,c){var f,p,g,y;const b=l.fields||{},S=c.fields||{},P=(f=b[Sd])===null||f===void 0?void 0:f.arrayValue,k=(p=S[Sd])===null||p===void 0?void 0:p.arrayValue,q=je(((g=P?.values)===null||g===void 0?void 0:g.length)||0,((y=k?.values)===null||y===void 0?void 0:y.length)||0);return q!==0?q:CT(P,k)}(i.mapValue,e.mapValue);case 11:return function(l,c){if(l===Yh.mapValue&&c===Yh.mapValue)return 0;if(l===Yh.mapValue)return 1;if(c===Yh.mapValue)return-1;const f=l.fields||{},p=Object.keys(f),g=c.fields||{},y=Object.keys(g);p.sort(),y.sort();for(let b=0;b<p.length&&b<y.length;++b){const S=dg(p[b],y[b]);if(S!==0)return S;const P=sl(f[p[b]],g[y[b]]);if(P!==0)return P}return je(p.length,y.length)}(i.mapValue,e.mapValue);default:throw xe(23264,{le:t})}}function RT(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return je(i,e);const t=qr(i),s=qr(e),a=je(t.seconds,s.seconds);return a!==0?a:je(t.nanos,s.nanos)}function CT(i,e){const t=i.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=sl(t[a],s[a]);if(l)return l}return je(t.length,s.length)}function rl(i){return fg(i)}function fg(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(t){const s=qr(t);return`time(${s.seconds},${s.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(t){return Hr(t).toBase64()}(i.bytesValue):"referenceValue"in i?function(t){return we.fromName(t).toString()}(i.referenceValue):"geoPointValue"in i?function(t){return`geo(${t.latitude},${t.longitude})`}(i.geoPointValue):"arrayValue"in i?function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=fg(l);return s+"]"}(i.arrayValue):"mapValue"in i?function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of s)l?l=!1:a+=",",a+=`${c}:${fg(t.fields[c])}`;return a+"}"}(i.mapValue):xe(61005,{value:i})}function td(i){switch(Gr(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=rf(i);return e?16+td(e):16;case 5:return 2*i.stringValue.length;case 6:return Hr(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((a,l)=>a+td(l),0)}(i.arrayValue);case 10:case 11:return function(s){let a=0;return Qr(s.fields,(l,c)=>{a+=l.length+td(c)}),a}(i.mapValue);default:throw xe(13486,{value:i})}}function IT(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function mg(i){return!!i&&"integerValue"in i}function h_(i){return!!i&&"arrayValue"in i}function xT(i){return!!i&&"nullValue"in i}function NT(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function nd(i){return!!i&&"mapValue"in i}function tD(i){var e,t;return((t=(((e=i?.mapValue)===null||e===void 0?void 0:e.fields)||{})[N1])===null||t===void 0?void 0:t.stringValue)===D1}function Bu(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return Qr(i.mapValue.fields,(t,s)=>e.mapValue.fields[t]=Bu(s)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Bu(i.arrayValue.values[t]);return e}return Object.assign({},i)}function nD(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===eD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.value=e}static empty(){return new Vn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!nd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bu(t)}setAll(e){let t=fn.emptyPath(),s={},a=[];e.forEach((c,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,s,a),s={},a=[],t=f.popLast()}c?s[f.lastSegment()]=Bu(c):a.push(f.lastSegment())});const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());nd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return is(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];nd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){Qr(t,(a,l)=>e[a]=l);for(const a of s)delete e[a]}clone(){return new Vn(Bu(this.value))}}function O1(i){const e=[];return Qr(i.fields,(t,s)=>{const a=new fn([t]);if(nd(s)){const l=O1(s.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)}),new Qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,t,s,a,l,c,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=c,this.documentState=f}static newInvalidDocument(e){return new bn(e,0,ke.min(),ke.min(),ke.min(),Vn.empty(),0)}static newFoundDocument(e,t,s,a){return new bn(e,1,t,ke.min(),s,a,0)}static newNoDocument(e,t){return new bn(e,2,t,ke.min(),ke.min(),Vn.empty(),0)}static newUnknownDocument(e,t){return new bn(e,3,t,ke.min(),ke.min(),Vn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,t){this.position=e,this.inclusive=t}}function DT(i,e,t){let s=0;for(let a=0;a<i.position.length;a++){const l=e[a],c=i.position[a];if(l.field.isKeyField()?s=we.comparator(we.fromName(c.referenceValue),t.key):s=sl(c,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function OT(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!is(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e,t="asc"){this.field=e,this.dir=t}}function iD(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{}class Bt extends k1{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new rD(e,t,s):t==="array-contains"?new lD(e,s):t==="in"?new uD(e,s):t==="not-in"?new cD(e,s):t==="array-contains-any"?new hD(e,s):new Bt(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new aD(e,s):new oD(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sl(t,this.value)):t!==null&&Gr(this.value)===Gr(t)&&this.matchesComparison(sl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ci extends k1{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Ci(e,t)}matches(e){return M1(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function M1(i){return i.op==="and"}function P1(i){return sD(i)&&M1(i)}function sD(i){for(const e of i.filters)if(e instanceof Ci)return!1;return!0}function pg(i){if(i instanceof Bt)return i.field.canonicalString()+i.op.toString()+rl(i.value);if(P1(i))return i.filters.map(e=>pg(e)).join(",");{const e=i.filters.map(t=>pg(t)).join(",");return`${i.op}(${e})`}}function V1(i,e){return i instanceof Bt?function(s,a){return a instanceof Bt&&s.op===a.op&&s.field.isEqual(a.field)&&is(s.value,a.value)}(i,e):i instanceof Ci?function(s,a){return a instanceof Ci&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce((l,c,f)=>l&&V1(c,a.filters[f]),!0):!1}(i,e):void xe(19439)}function L1(i){return i instanceof Bt?function(t){return`${t.field.canonicalString()} ${t.op} ${rl(t.value)}`}(i):i instanceof Ci?function(t){return t.op.toString()+" {"+t.getFilters().map(L1).join(" ,")+"}"}(i):"Filter"}class rD extends Bt{constructor(e,t,s){super(e,t,s),this.key=we.fromName(s.referenceValue)}matches(e){const t=we.comparator(e.key,this.key);return this.matchesComparison(t)}}class aD extends Bt{constructor(e,t){super(e,"in",t),this.keys=U1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class oD extends Bt{constructor(e,t){super(e,"not-in",t),this.keys=U1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function U1(i,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(s=>we.fromName(s.referenceValue))}class lD extends Bt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return h_(t)&&Ju(t.arrayValue,this.value)}}class uD extends Bt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ju(this.value.arrayValue,t)}}class cD extends Bt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ju(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ju(this.value.arrayValue,t)}}class hD extends Bt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!h_(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>Ju(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e,t=null,s=[],a=[],l=null,c=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=c,this.endAt=f,this.Pe=null}}function kT(i,e=null,t=[],s=[],a=null,l=null,c=null){return new dD(i,e,t,s,a,l,c)}function d_(i){const e=Me(i);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>pg(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(l){return l.field.canonicalString()+l.dir}(s)).join(","),sf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>rl(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>rl(s)).join(",")),e.Pe=t}return e.Pe}function f_(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!iD(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!V1(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!OT(i.startAt,e.startAt)&&OT(i.endAt,e.endAt)}function gg(i){return we.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,t=null,s=[],a=[],l=null,c="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=c,this.startAt=f,this.endAt=p,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function fD(i,e,t,s,a,l,c,f){return new dc(i,e,t,s,a,l,c,f)}function af(i){return new dc(i)}function MT(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function j1(i){return i.collectionGroup!==null}function Fu(i){const e=Me(i);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let f=new Qt(fn.comparator);return c.filters.forEach(p=>{p.getFlattenedFilters().forEach(g=>{g.isInequality()&&(f=f.add(g.field))})}),f})(e).forEach(l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new Rd(l,s))}),t.has(fn.keyField().canonicalString())||e.Te.push(new Rd(fn.keyField(),s))}return e.Te}function Wi(i){const e=Me(i);return e.Ie||(e.Ie=mD(e,Fu(i))),e.Ie}function mD(i,e){if(i.limitType==="F")return kT(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(a=>{const l=a.dir==="desc"?"asc":"desc";return new Rd(a.field,l)});const t=i.endAt?new Ad(i.endAt.position,i.endAt.inclusive):null,s=i.startAt?new Ad(i.startAt.position,i.startAt.inclusive):null;return kT(i.path,i.collectionGroup,e,i.filters,i.limit,t,s)}}function _g(i,e){const t=i.filters.concat([e]);return new dc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function yg(i,e,t){return new dc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function of(i,e){return f_(Wi(i),Wi(e))&&i.limitType===e.limitType}function B1(i){return`${d_(Wi(i))}|lt:${i.limitType}`}function zo(i){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(a=>L1(a)).join(", ")}]`),sf(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(a=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(a)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(a=>rl(a)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(a=>rl(a)).join(",")),`Target(${s})`}(Wi(i))}; limitType=${i.limitType})`}function lf(i,e){return e.isFoundDocument()&&function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):we.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)}(i,e)&&function(s,a){for(const l of Fu(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0}(i,e)&&function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0}(i,e)&&function(s,a){return!(s.startAt&&!function(c,f,p){const g=DT(c,f,p);return c.inclusive?g<=0:g<0}(s.startAt,Fu(s),a)||s.endAt&&!function(c,f,p){const g=DT(c,f,p);return c.inclusive?g>=0:g>0}(s.endAt,Fu(s),a))}(i,e)}function pD(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function F1(i){return(e,t)=>{let s=!1;for(const a of Fu(i)){const l=gD(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function gD(i,e,t){const s=i.field.isKeyField()?we.comparator(e.key,t.key):function(l,c,f){const p=c.data.field(l),g=f.data.field(l);return p!==null&&g!==null?sl(p,g):xe(42886)}(i.field,e,t);switch(i.dir){case"asc":return s;case"desc":return-1*s;default:return xe(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Qr(this.inner,(t,s)=>{for(const[a,l]of s)e(a,l)})}isEmpty(){return S1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _D=new At(we.comparator);function Ys(){return _D}const z1=new At(we.comparator);function Ou(...i){let e=z1;for(const t of i)e=e.insert(t.key,t);return e}function q1(i){let e=z1;return i.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function Da(){return zu()}function H1(){return zu()}function zu(){return new Ga(i=>i.toString(),(i,e)=>i.isEqual(e))}const yD=new At(we.comparator),vD=new Qt(we.comparator);function Ke(...i){let e=vD;for(const t of i)e=e.add(t);return e}const ED=new Qt(je);function TD(){return ED}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bd(e)?"-0":e}}function G1(i){return{integerValue:""+i}}function bD(i,e){return $2(e)?G1(e):m_(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(){this._=void 0}}function wD(i,e,t){return i instanceof Cd?function(a,l){const c={fields:{[C1]:{stringValue:R1},[x1]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&c_(l)&&(l=rf(l)),l&&(c.fields[I1]=l),{mapValue:c}}(t,e):i instanceof Zu?Y1(i,e):i instanceof ec?Q1(i,e):function(a,l){const c=K1(a,l),f=PT(c)+PT(a.Ee);return mg(c)&&mg(a.Ee)?G1(f):m_(a.serializer,f)}(i,e)}function SD(i,e,t){return i instanceof Zu?Y1(i,e):i instanceof ec?Q1(i,e):t}function K1(i,e){return i instanceof Id?function(s){return mg(s)||function(l){return!!l&&"doubleValue"in l}(s)}(e)?e:{integerValue:0}:null}class Cd extends uf{}class Zu extends uf{constructor(e){super(),this.elements=e}}function Y1(i,e){const t=$1(e);for(const s of i.elements)t.some(a=>is(a,s))||t.push(s);return{arrayValue:{values:t}}}class ec extends uf{constructor(e){super(),this.elements=e}}function Q1(i,e){let t=$1(e);for(const s of i.elements)t=t.filter(a=>!is(a,s));return{arrayValue:{values:t}}}class Id extends uf{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function PT(i){return kt(i.integerValue||i.doubleValue)}function $1(i){return h_(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function AD(i,e){return i.field.isEqual(e.field)&&function(s,a){return s instanceof Zu&&a instanceof Zu||s instanceof ec&&a instanceof ec?il(s.elements,a.elements,is):s instanceof Id&&a instanceof Id?is(s.Ee,a.Ee):s instanceof Cd&&a instanceof Cd}(i.transform,e.transform)}class RD{constructor(e,t){this.version=e,this.transformResults=t}}class Xi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xi}static exists(e){return new Xi(void 0,e)}static updateTime(e){return new Xi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function id(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class cf{}function W1(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new J1(i.key,Xi.none()):new fc(i.key,i.data,Xi.none());{const t=i.data,s=Vn.empty();let a=new Qt(fn.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?s.delete(l):s.set(l,c),a=a.add(l)}return new $r(i.key,s,new Qn(a.toArray()),Xi.none())}}function CD(i,e,t){i instanceof fc?function(a,l,c){const f=a.value.clone(),p=LT(a.fieldTransforms,l,c.transformResults);f.setAll(p),l.convertToFoundDocument(c.version,f).setHasCommittedMutations()}(i,e,t):i instanceof $r?function(a,l,c){if(!id(a.precondition,l))return void l.convertToUnknownDocument(c.version);const f=LT(a.fieldTransforms,l,c.transformResults),p=l.data;p.setAll(X1(a)),p.setAll(f),l.convertToFoundDocument(c.version,p).setHasCommittedMutations()}(i,e,t):function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,t)}function qu(i,e,t,s){return i instanceof fc?function(l,c,f,p){if(!id(l.precondition,c))return f;const g=l.value.clone(),y=UT(l.fieldTransforms,p,c);return g.setAll(y),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),null}(i,e,t,s):i instanceof $r?function(l,c,f,p){if(!id(l.precondition,c))return f;const g=UT(l.fieldTransforms,p,c),y=c.data;return y.setAll(X1(l)),y.setAll(g),c.convertToFoundDocument(c.version,y).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map(b=>b.field))}(i,e,t,s):function(l,c,f){return id(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):f}(i,e,t)}function ID(i,e){let t=null;for(const s of i.fieldTransforms){const a=e.data.field(s.field),l=K1(s.transform,a||null);l!=null&&(t===null&&(t=Vn.empty()),t.set(s.field,l))}return t||null}function VT(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&il(s,a,(l,c)=>AD(l,c))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class fc extends cf{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class $r extends cf{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function X1(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=i.data.field(t);e.set(t,s)}}),e}function LT(i,e,t){const s=new Map;st(i.length===t.length,32656,{Ae:t.length,Re:i.length});for(let a=0;a<t.length;a++){const l=i[a],c=l.transform,f=e.data.field(l.field);s.set(l.field,SD(c,f,t[a]))}return s}function UT(i,e,t){const s=new Map;for(const a of i){const l=a.transform,c=t.data.field(a.field);s.set(a.field,wD(l,c,e))}return s}class J1 extends cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xD extends cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&CD(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=qu(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=qu(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=H1();return this.mutations.forEach(a=>{const l=e.get(a.key),c=l.overlayedDocument;let f=this.applyToLocalView(c,l.mutatedFields);f=t.has(a.key)?null:f;const p=W1(c,f);p!==null&&s.set(a.key,p),c.isValidDocument()||c.convertToNoDocument(ke.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ke())}isEqual(e){return this.batchId===e.batchId&&il(this.mutations,e.mutations,(t,s)=>VT(t,s))&&il(this.baseMutations,e.baseMutations,(t,s)=>VT(t,s))}}class p_{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){st(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=function(){return yD}();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,s[c].version);return new p_(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jt,Xe;function kD(i){switch(i){case W.OK:return xe(64938);case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0;default:return xe(15467,{code:i})}}function Z1(i){if(i===void 0)return Ks("GRPC error has no .code"),W.UNKNOWN;switch(i){case jt.OK:return W.OK;case jt.CANCELLED:return W.CANCELLED;case jt.UNKNOWN:return W.UNKNOWN;case jt.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case jt.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case jt.INTERNAL:return W.INTERNAL;case jt.UNAVAILABLE:return W.UNAVAILABLE;case jt.UNAUTHENTICATED:return W.UNAUTHENTICATED;case jt.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case jt.NOT_FOUND:return W.NOT_FOUND;case jt.ALREADY_EXISTS:return W.ALREADY_EXISTS;case jt.PERMISSION_DENIED:return W.PERMISSION_DENIED;case jt.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case jt.ABORTED:return W.ABORTED;case jt.OUT_OF_RANGE:return W.OUT_OF_RANGE;case jt.UNIMPLEMENTED:return W.UNIMPLEMENTED;case jt.DATA_LOSS:return W.DATA_LOSS;default:return xe(39323,{code:i})}}(Xe=jt||(jt={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD=new Vr([4294967295,4294967295],0);function jT(i){const e=E1().encode(i),t=new d1;return t.update(e),new Uint8Array(t.digest())}function BT(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Vr([t,s],0),new Vr([a,l],0)]}class g_{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new ku(`Invalid padding: ${t}`);if(s<0)throw new ku(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new ku(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new ku(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Vr.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(Vr.fromNumber(s)));return a.compare(MD)===1&&(a=new Vr([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=jT(e),[s,a]=BT(t);for(let l=0;l<this.hashCount;l++){const c=this.pe(s,a,l);if(!this.ye(c))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new g_(l,a,t);return s.forEach(f=>c.insert(f)),c}insert(e){if(this.fe===0)return;const t=jT(e),[s,a]=BT(t);for(let l=0;l<this.hashCount;l++){const c=this.pe(s,a,l);this.we(c)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class ku extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,mc.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new hf(ke.min(),a,new At(je),Ys(),Ke())}}class mc{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new mc(s,t,Ke(),Ke(),Ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class eS{constructor(e,t){this.targetId=e,this.De=t}}class tS{constructor(e,t,s=mn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class FT{constructor(){this.ve=0,this.Ce=zT(),this.Fe=mn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ke(),t=Ke(),s=Ke();return this.Ce.forEach((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:xe(38017,{changeType:l})}}),new mc(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=zT()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,st(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class PD{constructor(e){this.We=e,this.Ge=new Map,this.ze=Ys(),this.je=Qh(),this.Je=Qh(),this.He=new At(je)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:xe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((s,a)=>{this.nt(a)&&t(a)})}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(gg(l))if(s===0){const c=new we(l.path);this.Xe(t,c,bn.newNoDocument(c,ke.min()))}else st(s===1,20013,{expectedCount:s});else{const c=this.ot(t);if(c!==s){const f=this._t(e),p=f?this.ut(f,e,c):1;if(p!==0){this.rt(t);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,g)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let c,f;try{c=Hr(s).toUint8Array()}catch(p){if(p instanceof A1)return Fr("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new g_(c,a,l)}catch(p){return Fr(p instanceof ku?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach(l=>{const c=this.We.lt(),f=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)}),a}Pt(e){const t=new Map;this.Ge.forEach((l,c)=>{const f=this.st(c);if(f){if(l.current&&gg(f.target)){const p=new we(f.target.path);this.Tt(p).has(c)||this.It(c,p)||this.Xe(c,p,bn.newNoDocument(p,e))}l.Ne&&(t.set(c,l.Le()),l.ke())}});let s=Ke();this.Je.forEach((l,c)=>{let f=!0;c.forEachWhile(p=>{const g=this.st(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(s=s.add(l))}),this.ze.forEach((l,c)=>c.setReadTime(e));const a=new hf(e,t,this.He,this.ze,s);return this.ze=Ys(),this.je=Qh(),this.Je=Qh(),this.He=new At(je),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new FT,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Qt(je),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Qt(je),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||de("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new FT),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Qh(){return new At(we.comparator)}function zT(){return new At(we.comparator)}const VD={asc:"ASCENDING",desc:"DESCENDING"},LD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},UD={and:"AND",or:"OR"};class jD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vg(i,e){return i.useProto3Json||sf(e)?e:{value:e}}function xd(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nS(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function BD(i,e){return xd(i,e.toTimestamp())}function Ji(i){return st(!!i,49232),ke.fromTimestamp(function(t){const s=qr(t);return new yt(s.seconds,s.nanos)}(i))}function __(i,e){return Eg(i,e).canonicalString()}function Eg(i,e){const t=function(a){return new pt(["projects",a.projectId,"databases",a.database])}(i).child("documents");return e===void 0?t:t.child(e)}function iS(i){const e=pt.fromString(i);return st(lS(e),10190,{key:e.toString()}),e}function Tg(i,e){return __(i.databaseId,e.path)}function Fp(i,e){const t=iS(e);if(t.get(1)!==i.databaseId.projectId)throw new he(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new he(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new we(rS(t))}function sS(i,e){return __(i.databaseId,e)}function FD(i){const e=iS(i);return e.length===4?pt.emptyPath():rS(e)}function bg(i){return new pt(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function rS(i){return st(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function qT(i,e,t){return{name:Tg(i,e),fields:t.value.mapValue.fields}}function zD(i,e){let t;if("targetChange"in e){e.targetChange;const s=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:xe(39313,{state:g})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=function(g,y){return g.useProto3Json?(st(y===void 0||typeof y=="string",58123),mn.fromBase64String(y||"")):(st(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),mn.fromUint8Array(y||new Uint8Array))}(i,e.targetChange.resumeToken),c=e.targetChange.cause,f=c&&function(g){const y=g.code===void 0?W.UNKNOWN:Z1(g.code);return new he(y,g.message||"")}(c);t=new tS(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=Fp(i,s.document.name),l=Ji(s.document.updateTime),c=s.document.createTime?Ji(s.document.createTime):ke.min(),f=new Vn({mapValue:{fields:s.document.fields}}),p=bn.newFoundDocument(a,l,c,f),g=s.targetIds||[],y=s.removedTargetIds||[];t=new sd(g,y,p.key,p)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=Fp(i,s.document),l=s.readTime?Ji(s.readTime):ke.min(),c=bn.newNoDocument(a,l),f=s.removedTargetIds||[];t=new sd([],f,c.key,c)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=Fp(i,s.document),l=s.removedTargetIds||[];t=new sd([],l,a,null)}else{if(!("filter"in e))return xe(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,c=new OD(a,l),f=s.targetId;t=new eS(f,c)}}return t}function qD(i,e){let t;if(e instanceof fc)t={update:qT(i,e.key,e.value)};else if(e instanceof J1)t={delete:Tg(i,e.key)};else if(e instanceof $r)t={update:qT(i,e.key,e.data),updateMask:JD(e.fieldMask)};else{if(!(e instanceof xD))return xe(16599,{Rt:e.type});t={verify:Tg(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(l,c){const f=c.transform;if(f instanceof Cd)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Zu)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof ec)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Id)return{fieldPath:c.field.canonicalString(),increment:f.Ee};throw xe(20930,{transform:c.transform})}(0,s))),e.precondition.isNone||(t.currentDocument=function(a,l){return l.updateTime!==void 0?{updateTime:BD(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:xe(27497)}(i,e.precondition)),t}function HD(i,e){return i&&i.length>0?(st(e!==void 0,14353),i.map(t=>function(a,l){let c=a.updateTime?Ji(a.updateTime):Ji(l);return c.isEqual(ke.min())&&(c=Ji(l)),new RD(c,a.transformResults||[])}(t,e))):[]}function GD(i,e){return{documents:[sS(i,e.path)]}}function KD(i,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=sS(i,a);const l=function(g){if(g.length!==0)return oS(Ci.create(g,"and"))}(e.filters);l&&(t.structuredQuery.where=l);const c=function(g){if(g.length!==0)return g.map(y=>function(S){return{field:qo(S.field),direction:$D(S.dir)}}(y))}(e.orderBy);c&&(t.structuredQuery.orderBy=c);const f=vg(i,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=function(g){return{before:g.inclusive,values:g.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(g){return{before:!g.inclusive,values:g.position}}(e.endAt)),{Vt:t,parent:a}}function YD(i){let e=FD(i.parent);const t=i.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){st(s===1,65062);const y=t.from[0];y.allDescendants?a=y.collectionId:e=e.child(y.collectionId)}let l=[];t.where&&(l=function(b){const S=aS(b);return S instanceof Ci&&P1(S)?S.getFilters():[S]}(t.where));let c=[];t.orderBy&&(c=function(b){return b.map(S=>function(k){return new Rd(Ho(k.field),function(K){switch(K){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(S))}(t.orderBy));let f=null;t.limit&&(f=function(b){let S;return S=typeof b=="object"?b.value:b,sf(S)?null:S}(t.limit));let p=null;t.startAt&&(p=function(b){const S=!!b.before,P=b.values||[];return new Ad(P,S)}(t.startAt));let g=null;return t.endAt&&(g=function(b){const S=!b.before,P=b.values||[];return new Ad(P,S)}(t.endAt)),fD(e,a,c,l,f,"F",p,g)}function QD(i,e){const t=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xe(28987,{purpose:a})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function aS(i){return i.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Ho(t.unaryFilter.field);return Bt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=Ho(t.unaryFilter.field);return Bt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Ho(t.unaryFilter.field);return Bt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Ho(t.unaryFilter.field);return Bt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xe(61313);default:return xe(60726)}}(i):i.fieldFilter!==void 0?function(t){return Bt.create(Ho(t.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xe(58110);default:return xe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(t){return Ci.create(t.compositeFilter.filters.map(s=>aS(s)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return xe(1026)}}(t.compositeFilter.op))}(i):xe(30097,{filter:i})}function $D(i){return VD[i]}function WD(i){return LD[i]}function XD(i){return UD[i]}function qo(i){return{fieldPath:i.canonicalString()}}function Ho(i){return fn.fromServerFormat(i.fieldPath)}function oS(i){return i instanceof Bt?function(t){if(t.op==="=="){if(NT(t.value))return{unaryFilter:{field:qo(t.field),op:"IS_NAN"}};if(xT(t.value))return{unaryFilter:{field:qo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(NT(t.value))return{unaryFilter:{field:qo(t.field),op:"IS_NOT_NAN"}};if(xT(t.value))return{unaryFilter:{field:qo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qo(t.field),op:WD(t.op),value:t.value}}}(i):i instanceof Ci?function(t){const s=t.getFilters().map(a=>oS(a));return s.length===1?s[0]:{compositeFilter:{op:XD(t.op),filters:s}}}(i):xe(54877,{filter:i})}function JD(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function lS(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,t,s,a,l=ke.min(),c=ke.min(),f=mn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new Or(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Or(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e){this.gt=e}}function eO(i){const e=YD({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?yg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(){this.Dn=new nO}addToCollectionParentIndex(e,t){return this.Dn.add(t),ee.resolve()}getCollectionParents(e,t){return ee.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ee.resolve()}deleteFieldIndex(e,t){return ee.resolve()}deleteAllFieldIndexes(e){return ee.resolve()}createTargetIndexes(e,t){return ee.resolve()}getDocumentsMatchingTarget(e,t){return ee.resolve(null)}getIndexType(e,t){return ee.resolve(0)}getFieldIndexes(e,t){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,t){return ee.resolve(zr.min())}getMinOffsetFromCollectionGroup(e,t){return ee.resolve(zr.min())}updateCollectionGroup(e,t,s){return ee.resolve()}updateIndexEntries(e,t){return ee.resolve()}}class nO{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new Qt(pt.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new Qt(pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},uS=41943040;class Mn{static withCacheSize(e){return new Mn(e,Mn.DEFAULT_COLLECTION_PERCENTILE,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mn.DEFAULT_COLLECTION_PERCENTILE=10,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mn.DEFAULT=new Mn(uS,Mn.DEFAULT_COLLECTION_PERCENTILE,Mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mn.DISABLED=new Mn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new al(0)}static ur(){return new al(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT="LruGarbageCollector",iO=1048576;function KT([i,e],[t,s]){const a=je(i,t);return a===0?je(e,s):a}class sO{constructor(e){this.Tr=e,this.buffer=new Qt(KT),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();KT(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class rO{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){de(GT,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){gl(t)?de(GT,"Ignoring IndexedDB error during garbage collection: ",t):await pl(t)}await this.Rr(3e5)})}}class aO{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(t===0)return ee.resolve(nf.ue);const s=new sO(t);return this.Vr.forEachTarget(e,a=>s.Er(a.sequenceNumber)).next(()=>this.Vr.gr(e,a=>s.Er(a))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(HT)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),HT):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,c,f,p,g;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),a=this.params.maximumSequenceNumbersToCollect):a=b,c=Date.now(),this.nthSequenceNumber(e,a))).next(b=>(s=b,f=Date.now(),this.removeTargets(e,s,t))).next(b=>(l=b,p=Date.now(),this.removeOrphanedDocuments(e,s))).next(b=>(g=Date.now(),Fo()<=Ge.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-y}ms
	Determined least recently used ${a} in `+(f-c)+`ms
	Removed ${l} targets in `+(p-f)+`ms
	Removed ${b} documents in `+(g-p)+`ms
Total Duration: ${g-y}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:b})))}}function oO(i,e){return new aO(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(){this.changes=new Ga(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,bn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ee.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(a=>(s=a,this.remoteDocumentCache.getEntry(e,t))).next(a=>(s!==null&&qu(s.mutation,a,Qn.empty(),yt.now()),a))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,Ke()).next(()=>s))}getLocalViewOfDocuments(e,t,s=Ke()){const a=Da();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,s).next(l=>{let c=Ou();return l.forEach((f,p)=>{c=c.insert(f,p.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){const s=Da();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,Ke()))}populateOverlays(e,t,s){const a=[];return s.forEach(l=>{t.has(l)||a.push(l)}),this.documentOverlayCache.getOverlays(e,a).next(l=>{l.forEach((c,f)=>{t.set(c,f)})})}computeViews(e,t,s,a){let l=Ys();const c=zu(),f=function(){return zu()}();return t.forEach((p,g)=>{const y=s.get(g.key);a.has(g.key)&&(y===void 0||y.mutation instanceof $r)?l=l.insert(g.key,g):y!==void 0?(c.set(g.key,y.mutation.getFieldMask()),qu(y.mutation,g,y.mutation.getFieldMask(),yt.now())):c.set(g.key,Qn.empty())}),this.recalculateAndSaveOverlays(e,l).next(p=>(p.forEach((g,y)=>c.set(g,y)),t.forEach((g,y)=>{var b;return f.set(g,new uO(y,(b=c.get(g))!==null&&b!==void 0?b:null))}),f))}recalculateAndSaveOverlays(e,t){const s=zu();let a=new At((c,f)=>c-f),l=Ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(const f of c)f.keys().forEach(p=>{const g=t.get(p);if(g===null)return;let y=s.get(p)||Qn.empty();y=f.applyToLocalView(g,y),s.set(p,y);const b=(a.get(f.batchId)||Ke()).add(p);a=a.insert(f.batchId,b)})}).next(()=>{const c=[],f=a.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),g=p.key,y=p.value,b=H1();y.forEach(S=>{if(!l.has(S)){const P=W1(t.get(S),s.get(S));P!==null&&b.set(S,P),l=l.add(S)}}),c.push(this.documentOverlayCache.saveOverlays(e,g,b))}return ee.waitFor(c)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,a){return function(c){return we.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):j1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next(l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ee.resolve(Da());let f=$u,p=l;return c.next(g=>ee.forEach(g,(y,b)=>(f<b.largestBatchId&&(f=b.largestBatchId),l.get(y)?ee.resolve():this.remoteDocumentCache.getEntry(e,y).next(S=>{p=p.insert(y,S)}))).next(()=>this.populateOverlays(e,g,l)).next(()=>this.computeViews(e,p,g,Ke())).next(y=>({batchId:f,changes:q1(y)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new we(t)).next(s=>{let a=Ou();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a})}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let c=Ou();return this.indexManager.getCollectionParents(e,l).next(f=>ee.forEach(f,p=>{const g=function(b,S){return new dc(S,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)}(t,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,g,s,a).next(y=>{y.forEach((b,S)=>{c=c.insert(b,S)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a))).next(c=>{l.forEach((p,g)=>{const y=g.getKey();c.get(y)===null&&(c=c.insert(y,bn.newInvalidDocument(y)))});let f=Ou();return c.forEach((p,g)=>{const y=l.get(p);y!==void 0&&qu(y.mutation,g,Qn.empty(),yt.now()),lf(t,g)&&(f=f.insert(p,g))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ee.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(a){return{id:a.id,version:a.version,createTime:Ji(a.createTime)}}(t)),ee.resolve()}getNamedQuery(e,t){return ee.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(a){return{name:a.name,query:eO(a.bundledQuery),readTime:Ji(a.readTime)}}(t)),ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(){this.overlays=new At(we.comparator),this.kr=new Map}getOverlay(e,t){return ee.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Da();return ee.forEach(t,a=>this.getOverlay(e,a).next(l=>{l!==null&&s.set(a,l)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((a,l)=>{this.wt(e,t,l)}),ee.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach(l=>this.overlays=this.overlays.remove(l)),this.kr.delete(s)),ee.resolve()}getOverlaysForCollection(e,t,s){const a=Da(),l=t.length+1,c=new we(t.child("")),f=this.overlays.getIteratorFrom(c);for(;f.hasNext();){const p=f.getNext().value,g=p.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===l&&p.largestBatchId>s&&a.set(p.getKey(),p)}return ee.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new At((g,y)=>g-y);const c=this.overlays.getIterator();for(;c.hasNext();){const g=c.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>s){let y=l.get(g.largestBatchId);y===null&&(y=Da(),l=l.insert(g.largestBatchId,y)),y.set(g.getKey(),g)}}const f=Da(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((g,y)=>f.set(g,y)),!(f.size()>=a)););return ee.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const c=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(s.key,new DD(t,s));let l=this.kr.get(t);l===void 0&&(l=Ke(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(){this.sessionToken=mn.EMPTY_BYTE_STRING}getSessionToken(e){return ee.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(){this.qr=new Qt(nn.Qr),this.$r=new Qt(nn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new nn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Wr(new nn(e,t))}Gr(e,t){e.forEach(s=>this.removeReference(s,t))}zr(e){const t=new we(new pt([])),s=new nn(t,e),a=new nn(t,e+1),l=[];return this.$r.forEachInRange([s,a],c=>{this.Wr(c),l.push(c.key)}),l}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new we(new pt([])),s=new nn(t,e),a=new nn(t,e+1);let l=Ke();return this.$r.forEachInRange([s,a],c=>{l=l.add(c.key)}),l}containsKey(e){const t=new nn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class nn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return we.comparator(e.key,t.key)||je(e.Hr,t.Hr)}static Ur(e,t){return je(e.Hr,t.Hr)||we.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Qt(nn.Qr)}checkEmpty(e){return ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new ND(l,t,s,a);this.mutationQueue.push(c);for(const f of a)this.Yr=this.Yr.add(new nn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ee.resolve(c)}lookupMutationBatch(e,t){return ee.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ee.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(this.mutationQueue.length===0?u_:this.er-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new nn(t,0),a=new nn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],c=>{const f=this.Zr(c.Hr);l.push(f)}),ee.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Qt(je);return t.forEach(a=>{const l=new nn(a,0),c=new nn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,c],f=>{s=s.add(f.Hr)})}),ee.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;we.isDocumentKey(l)||(l=l.child(""));const c=new nn(new we(l),0);let f=new Qt(je);return this.Yr.forEachWhile(p=>{const g=p.key.path;return!!s.isPrefixOf(g)&&(g.length===a&&(f=f.add(p.Hr)),!0)},c),ee.resolve(this.ei(f))}ei(e){const t=[];return e.forEach(s=>{const a=this.Zr(s);a!==null&&t.push(a)}),t}removeMutationBatch(e,t){st(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ee.forEach(t.mutations,a=>{const l=new nn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Yr=s})}rr(e){}containsKey(e,t){const s=new nn(t,0),a=this.Yr.firstAfterOrEqual(s);return ee.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ee.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e){this.ni=e,this.docs=function(){return new At(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,c=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ee.resolve(s?s.document.mutableCopy():bn.newInvalidDocument(t))}getEntries(e,t){let s=Ys();return t.forEach(a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():bn.newInvalidDocument(a))}),ee.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=Ys();const c=t.path,f=new we(c.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:g,value:{document:y}}=p.getNext();if(!c.isPrefixOf(g.path))break;g.path.length>c.length+1||G2(H2(y),s)<=0||(a.has(y.key)||lf(t,y))&&(l=l.insert(y.key,y.mutableCopy()))}return ee.resolve(l)}getAllFromCollectionGroup(e,t,s,a){xe(9500)}ri(e,t){return ee.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new gO(this)}getSize(e){return ee.resolve(this.size)}}class gO extends lO{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)}),ee.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e){this.persistence=e,this.ii=new Ga(t=>d_(t),f_),this.lastRemoteSnapshotVersion=ke.min(),this.highestTargetId=0,this.si=0,this.oi=new y_,this.targetCount=0,this._i=al.ar()}forEachTarget(e,t){return this.ii.forEach((s,a)=>t(a)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ee.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new al(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ee.resolve()}updateTargetData(e,t){return this.hr(t),ee.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach((c,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(c),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)}),ee.waitFor(l).next(()=>a)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ee.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ee.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach(c=>{l.push(a.markPotentiallyOrphaned(e,c))}),ee.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ee.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ee.resolve(s)}containsKey(e,t){return ee.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,t){this.ai={},this.overlays={},this.ui=new nf(0),this.ci=!1,this.ci=!0,this.li=new fO,this.referenceDelegate=e(this),this.hi=new _O(this),this.indexManager=new tO,this.remoteDocumentCache=function(a){return new pO(a)}(s=>this.referenceDelegate.Pi(s)),this.serializer=new ZD(t),this.Ti=new hO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new dO,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new mO(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){de("MemoryPersistence","Starting transaction:",e);const a=new yO(this.ui.next());return this.referenceDelegate.Ii(),s(a).next(l=>this.referenceDelegate.di(a).next(()=>l)).toPromise().then(l=>(a.raiseOnCommittedEvent(),l))}Ei(e,t){return ee.or(Object.values(this.ai).map(s=>()=>s.containsKey(e,t)))}}class yO extends Y2{constructor(e){super(),this.currentSequenceNumber=e}}class v_{constructor(e){this.persistence=e,this.Ai=new y_,this.Ri=null}static Vi(e){return new v_(e)}get mi(){if(this.Ri)return this.Ri;throw xe(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ee.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ee.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ee.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(a=>this.mi.add(a.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(a=>{a.forEach(l=>this.mi.add(l.toString()))}).next(()=>s.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.mi,s=>{const a=we.fromPath(s);return this.fi(e,a).next(l=>{l||t.removeEntry(a,ke.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return ee.or([()=>ee.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Nd{constructor(e,t){this.persistence=e,this.gi=new Ga(s=>W2(s.path),(s,a)=>s.isEqual(a)),this.garbageCollector=oO(this,t)}static Vi(e,t){return new Nd(e,t)}Ii(){}di(e){return ee.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>t.next(a=>s+a))}yr(e){let t=0;return this.gr(e,s=>{t++}).next(()=>t)}gr(e,t){return ee.forEach(this.gi,(s,a)=>this.Sr(e,s,a).next(l=>l?ee.resolve():t(a)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,c=>this.Sr(e,c,t).next(f=>{f||(s++,l.removeEntry(c,ke.min()))})).next(()=>l.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ee.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ee.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ee.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ee.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=td(e.data.value)),t}Sr(e,t,s){return ee.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ee.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=Ke(),a=Ke();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new E_(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return bC()?8:Q2(Sn())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next(c=>{l.result=c}).next(()=>{if(!l.result)return this.ys(e,t,a,s).next(c=>{l.result=c})}).next(()=>{if(l.result)return;const c=new vO;return this.ws(e,t,c).next(f=>{if(l.result=f,this.Rs)return this.Ss(e,t,c,f.size)})}).next(()=>l.result)}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(Fo()<=Ge.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",zo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ee.resolve()):(Fo()<=Ge.DEBUG&&de("QueryEngine","Query:",zo(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(Fo()<=Ge.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",zo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wi(t))):ee.resolve())}ps(e,t){if(MT(t))return ee.resolve(null);let s=Wi(t);return this.indexManager.getIndexType(e,s).next(a=>a===0?null:(t.limit!==null&&a===1&&(t=yg(t,null,"F"),s=Wi(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(l=>{const c=Ke(...l);return this.gs.getDocuments(e,c).next(f=>this.indexManager.getMinOffset(e,s).next(p=>{const g=this.bs(t,f);return this.Ds(t,g,c,p.readTime)?this.ps(e,yg(t,null,"F")):this.vs(e,g,t,p)}))})))}ys(e,t,s,a){return MT(t)||a.isEqual(ke.min())?ee.resolve(null):this.gs.getDocuments(e,s).next(l=>{const c=this.bs(t,l);return this.Ds(t,c,s,a)?ee.resolve(null):(Fo()<=Ge.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),zo(t)),this.vs(e,c,t,q2(a,$u)).next(f=>f))})}bs(e,t){let s=new Qt(F1(e));return t.forEach((a,l)=>{lf(e,l)&&(s=s.add(l))}),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return Fo()<=Ge.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",zo(t)),this.gs.getDocumentsMatchingQuery(e,t,zr.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next(l=>(t.forEach(c=>{l=l.insert(c.key,c)}),l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_="LocalStore",TO=3e8;class bO{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new At(je),this.Ms=new Ga(l=>d_(l),f_),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cO(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function wO(i,e,t,s){return new bO(i,e,t,s)}async function hS(i,e){const t=Me(i);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next(l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s))).next(l=>{const c=[],f=[];let p=Ke();for(const g of a){c.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}for(const g of l){f.push(g.batchId);for(const y of g.mutations)p=p.add(y.key)}return t.localDocuments.getDocuments(s,p).next(g=>({Bs:g,removedBatchIds:c,addedBatchIds:f}))})})}function SO(i,e){const t=Me(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return function(f,p,g,y){const b=g.batch,S=b.keys();let P=ee.resolve();return S.forEach(k=>{P=P.next(()=>y.getEntry(p,k)).next(q=>{const K=g.docVersions.get(k);st(K!==null,48541),q.version.compareTo(K)<0&&(b.applyToRemoteDocument(q,g),q.isValidDocument()&&(q.setReadTime(g.commitVersion),y.addEntry(q)))})}),P.next(()=>f.mutationQueue.removeMutationBatch(p,b))}(t,s,e,l).next(()=>l.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(f){let p=Ke();for(let g=0;g<f.mutationResults.length;++g)f.mutationResults[g].transformResults.length>0&&(p=p.add(f.batch.mutations[g].key));return p}(e))).next(()=>t.localDocuments.getDocuments(s,a))})}function dS(i){const e=Me(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function AO(i,e){const t=Me(i),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",l=>{const c=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach((y,b)=>{const S=a.get(b);if(!S)return;f.push(t.hi.removeMatchingKeys(l,y.removedDocuments,b).next(()=>t.hi.addMatchingKeys(l,y.addedDocuments,b)));let P=S.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(b)!==null?P=P.withResumeToken(mn.EMPTY_BYTE_STRING,ke.min()).withLastLimboFreeSnapshotVersion(ke.min()):y.resumeToken.approximateByteSize()>0&&(P=P.withResumeToken(y.resumeToken,s)),a=a.insert(b,P),function(q,K,pe){return q.resumeToken.approximateByteSize()===0||K.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=TO?!0:pe.addedDocuments.size+pe.modifiedDocuments.size+pe.removedDocuments.size>0}(S,P,y)&&f.push(t.hi.updateTargetData(l,P))});let p=Ys(),g=Ke();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,y))}),f.push(RO(l,c,e.documentUpdates).next(y=>{p=y.Ls,g=y.ks})),!s.isEqual(ke.min())){const y=t.hi.getLastRemoteSnapshotVersion(l).next(b=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s));f.push(y)}return ee.waitFor(f).next(()=>c.apply(l)).next(()=>t.localDocuments.getLocalViewOfDocuments(l,p,g)).next(()=>p)}).then(l=>(t.Fs=a,l))}function RO(i,e,t){let s=Ke(),a=Ke();return t.forEach(l=>s=s.add(l)),e.getEntries(i,s).next(l=>{let c=Ys();return t.forEach((f,p)=>{const g=l.get(f);p.isFoundDocument()!==g.isFoundDocument()&&(a=a.add(f)),p.isNoDocument()&&p.version.isEqual(ke.min())?(e.removeEntry(f,p.readTime),c=c.insert(f,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),c=c.insert(f,p)):de(T_,"Ignoring outdated watch update for ",f,". Current version:",g.version," Watch version:",p.version)}),{Ls:c,ks:a}})}function CO(i,e){const t=Me(i);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=u_),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function IO(i,e){const t=Me(i);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let a;return t.hi.getTargetData(s,e).next(l=>l?(a=l,ee.resolve(a)):t.hi.allocateTargetId(s).next(c=>(a=new Or(e,c,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next(()=>a))))}).then(s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s})}async function wg(i,e,t){const s=Me(i),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,c=>s.persistence.referenceDelegate.removeTarget(c,a))}catch(c){if(!gl(c))throw c;de(T_,`Failed to update sequence numbers for target ${e}: ${c}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function YT(i,e,t){const s=Me(i);let a=ke.min(),l=Ke();return s.persistence.runTransaction("Execute query","readwrite",c=>function(p,g,y){const b=Me(p),S=b.Ms.get(y);return S!==void 0?ee.resolve(b.Fs.get(S)):b.hi.getTargetData(g,y)}(s,c,Wi(e)).next(f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(c,f.targetId).next(p=>{l=p})}).next(()=>s.Cs.getDocumentsMatchingQuery(c,e,t?a:ke.min(),t?l:Ke())).next(f=>(xO(s,pD(e),f),{documents:f,qs:l})))}function xO(i,e,t){let s=i.xs.get(e)||ke.min();t.forEach((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)}),i.xs.set(e,s)}class QT{constructor(){this.activeTargetIds=TD()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class NO{constructor(){this.Fo=new QT,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new QT,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $T="ConnectivityMonitor";class WT{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){de($T,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){de($T,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $h=null;function Sg(){return $h===null?$h=function(){return 268435456+Math.round(2147483648*Math.random())}():$h++,"0x"+$h.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="RestConnection",OO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class kO{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===wd?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const c=Sg(),f=this.Go(e,t.toUriEncodedString());de(zp,`Sending RPC '${e}' ${c}:`,f,s);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(p,a,l);const{host:g}=new URL(f),y=$s(g);return this.jo(e,f,p,s,y).then(b=>(de(zp,`Received RPC '${e}' ${c}: `,b),b),b=>{throw Fr(zp,`RPC '${e}' ${c} failed with error: `,b,"url: ",f,"request:",s),b})}Jo(e,t,s,a,l,c){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ml}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((a,l)=>e[l]=a),s&&s.headers.forEach((a,l)=>e[l]=a)}Go(e,t){const s=OO[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n="WebChannelConnection";class PO extends kO{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const c=Sg();return new Promise((f,p)=>{const g=new f1;g.setWithCredentials(!0),g.listenOnce(m1.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case ed.NO_ERROR:const b=g.getResponseJson();de(_n,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(b)),f(b);break;case ed.TIMEOUT:de(_n,`RPC '${e}' ${c} timed out`),p(new he(W.DEADLINE_EXCEEDED,"Request time out"));break;case ed.HTTP_ERROR:const S=g.getStatus();if(de(_n,`RPC '${e}' ${c} failed with status:`,S,"response text:",g.getResponseText()),S>0){let P=g.getResponseJson();Array.isArray(P)&&(P=P[0]);const k=P?.error;if(k&&k.status&&k.message){const q=function(pe){const ae=pe.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(ae)>=0?ae:W.UNKNOWN}(k.status);p(new he(q,k.message))}else p(new he(W.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new he(W.UNAVAILABLE,"Connection failed."));break;default:xe(9055,{c_:e,streamId:c,l_:g.getLastErrorCode(),h_:g.getLastError()})}}finally{de(_n,`RPC '${e}' ${c} completed.`)}});const y=JSON.stringify(a);de(_n,`RPC '${e}' ${c} sending request:`,a),g.send(t,"POST",y,s,15)})}P_(e,t,s){const a=Sg(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=_1(),f=g1(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.zo(p.initMessageHeaders,t,s),p.encodeInitMessageHeaders=!0;const y=l.join("");de(_n,`Creating RPC '${e}' stream ${a}: ${y}`,p);const b=c.createWebChannel(y,p);this.T_(b);let S=!1,P=!1;const k=new MO({Ho:K=>{P?de(_n,`Not sending because RPC '${e}' stream ${a} is closed:`,K):(S||(de(_n,`Opening RPC '${e}' stream ${a} transport.`),b.open(),S=!0),de(_n,`RPC '${e}' stream ${a} sending:`,K),b.send(K))},Yo:()=>b.close()}),q=(K,pe,ae)=>{K.listen(pe,ce=>{try{ae(ce)}catch(Te){setTimeout(()=>{throw Te},0)}})};return q(b,Du.EventType.OPEN,()=>{P||(de(_n,`RPC '${e}' stream ${a} transport opened.`),k.s_())}),q(b,Du.EventType.CLOSE,()=>{P||(P=!0,de(_n,`RPC '${e}' stream ${a} transport closed`),k.__(),this.I_(b))}),q(b,Du.EventType.ERROR,K=>{P||(P=!0,Fr(_n,`RPC '${e}' stream ${a} transport errored. Name:`,K.name,"Message:",K.message),k.__(new he(W.UNAVAILABLE,"The operation could not be completed")))}),q(b,Du.EventType.MESSAGE,K=>{var pe;if(!P){const ae=K.data[0];st(!!ae,16349);const ce=ae,Te=ce?.error||((pe=ce[0])===null||pe===void 0?void 0:pe.error);if(Te){de(_n,`RPC '${e}' stream ${a} received error:`,Te);const be=Te.status;let Re=function(I){const D=jt[I];if(D!==void 0)return Z1(D)}(be),M=Te.message;Re===void 0&&(Re=W.INTERNAL,M="Unknown error status: "+be+" with message "+Te.message),P=!0,k.__(new he(Re,M)),b.close()}else de(_n,`RPC '${e}' stream ${a} received:`,ae),k.a_(ae)}}),q(f,p1.STAT_EVENT,K=>{K.stat===hg.PROXY?de(_n,`RPC '${e}' stream ${a} detected buffering proxy`):K.stat===hg.NOPROXY&&de(_n,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{k.o_()},0),k}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function qp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(i){return new jD(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&de("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XT="PersistentStream";class mS{constructor(e,t,s,a,l,c,f,p){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new fS(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===W.RESOURCE_EXHAUSTED?(Ks(t.toString()),Ks("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,a])=>{this.b_===t&&this.W_(s,a)},s=>{e(()=>{const a=new he(W.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)})})}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{s(()=>this.listener.Zo())}),this.stream.e_(()=>{s(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(a=>{s(()=>this.G_(a))}),this.stream.onMessage(a=>{s(()=>++this.C_==1?this.j_(a):this.onNext(a))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return de(XT,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(de(XT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class VO extends mS{constructor(e,t,s,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,c),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=zD(this.serializer,e),s=function(l){if(!("targetChange"in l))return ke.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?ke.min():c.readTime?Ji(c.readTime):ke.min()}(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=bg(this.serializer),t.addTarget=function(l,c){let f;const p=c.target;if(f=gg(p)?{documents:GD(l,p)}:{query:KD(l,p).Vt},f.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){f.resumeToken=nS(l,c.resumeToken);const g=vg(l,c.expectedCount);g!==null&&(f.expectedCount=g)}else if(c.snapshotVersion.compareTo(ke.min())>0){f.readTime=xd(l,c.snapshotVersion.toTimestamp());const g=vg(l,c.expectedCount);g!==null&&(f.expectedCount=g)}return f}(this.serializer,e);const s=QD(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=bg(this.serializer),t.removeTarget=e,this.k_(t)}}class LO extends mS{constructor(e,t,s,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,c),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return st(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,st(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){st(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=HD(e.writeResults,e.commitTime),s=Ji(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=bg(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>qD(this.serializer,s))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{}class jO extends UO{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new he(W.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,c])=>this.connection.Wo(e,Eg(t,s),a,l,c)).catch(l=>{throw l.name==="FirebaseError"?(l.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new he(W.UNKNOWN,l.toString())})}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,f])=>this.connection.Jo(e,Eg(t,s),a,c,f,l)).catch(c=>{throw c.name==="FirebaseError"?(c.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new he(W.UNKNOWN,c.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class BO{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Ks(t),this._a=!1):de("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua="RemoteStore";class FO{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo(c=>{s.enqueueAndForget(async()=>{Ka(this)&&(de(Ua,"Restarting streams for network reachability change."),await async function(p){const g=Me(p);g.Ia.add(4),await pc(g),g.Aa.set("Unknown"),g.Ia.delete(4),await ff(g)}(this))})}),this.Aa=new BO(s,a)}}async function ff(i){if(Ka(i))for(const e of i.da)await e(!0)}async function pc(i){for(const e of i.da)await e(!1)}function pS(i,e){const t=Me(i);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),A_(t)?S_(t):_l(t).x_()&&w_(t,e))}function b_(i,e){const t=Me(i),s=_l(t);t.Ta.delete(e),s.x_()&&gS(t,e),t.Ta.size===0&&(s.x_()?s.B_():Ka(t)&&t.Aa.set("Unknown"))}function w_(i,e){if(i.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ke.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}_l(i).H_(e)}function gS(i,e){i.Ra.$e(e),_l(i).Y_(e)}function S_(i){i.Ra=new PD({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>i.Ta.get(e)||null,lt:()=>i.datastore.serializer.databaseId}),_l(i).start(),i.Aa.aa()}function A_(i){return Ka(i)&&!_l(i).M_()&&i.Ta.size>0}function Ka(i){return Me(i).Ia.size===0}function _S(i){i.Ra=void 0}async function zO(i){i.Aa.set("Online")}async function qO(i){i.Ta.forEach((e,t)=>{w_(i,e)})}async function HO(i,e){_S(i),A_(i)?(i.Aa.la(e),S_(i)):i.Aa.set("Unknown")}async function GO(i,e,t){if(i.Aa.set("Online"),e instanceof tS&&e.state===2&&e.cause)try{await async function(a,l){const c=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,c),a.Ta.delete(f),a.Ra.removeTarget(f))}(i,e)}catch(s){de(Ua,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Dd(i,s)}else if(e instanceof sd?i.Ra.Ye(e):e instanceof eS?i.Ra.it(e):i.Ra.et(e),!t.isEqual(ke.min()))try{const s=await dS(i.localStore);t.compareTo(s)>=0&&await function(l,c){const f=l.Ra.Pt(c);return f.targetChanges.forEach((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const y=l.Ta.get(g);y&&l.Ta.set(g,y.withResumeToken(p.resumeToken,c))}}),f.targetMismatches.forEach((p,g)=>{const y=l.Ta.get(p);if(!y)return;l.Ta.set(p,y.withResumeToken(mn.EMPTY_BYTE_STRING,y.snapshotVersion)),gS(l,p);const b=new Or(y.target,p,g,y.sequenceNumber);w_(l,b)}),l.remoteSyncer.applyRemoteEvent(f)}(i,t)}catch(s){de(Ua,"Failed to raise snapshot:",s),await Dd(i,s)}}async function Dd(i,e,t){if(!gl(e))throw e;i.Ia.add(1),await pc(i),i.Aa.set("Offline"),t||(t=()=>dS(i.localStore)),i.asyncQueue.enqueueRetryable(async()=>{de(Ua,"Retrying IndexedDB access"),await t(),i.Ia.delete(1),await ff(i)})}function yS(i,e){return e().catch(t=>Dd(i,t,e))}async function mf(i){const e=Me(i),t=Kr(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:u_;for(;KO(e);)try{const a=await CO(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,YO(e,a)}catch(a){await Dd(e,a)}vS(e)&&ES(e)}function KO(i){return Ka(i)&&i.Pa.length<10}function YO(i,e){i.Pa.push(e);const t=Kr(i);t.x_()&&t.Z_&&t.X_(e.mutations)}function vS(i){return Ka(i)&&!Kr(i).M_()&&i.Pa.length>0}function ES(i){Kr(i).start()}async function QO(i){Kr(i).na()}async function $O(i){const e=Kr(i);for(const t of i.Pa)e.X_(t.mutations)}async function WO(i,e,t){const s=i.Pa.shift(),a=p_.from(s,e,t);await yS(i,()=>i.remoteSyncer.applySuccessfulWrite(a)),await mf(i)}async function XO(i,e){e&&Kr(i).Z_&&await async function(s,a){if(function(c){return kD(c)&&c!==W.ABORTED}(a.code)){const l=s.Pa.shift();Kr(s).N_(),await yS(s,()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a)),await mf(s)}}(i,e),vS(i)&&ES(i)}async function JT(i,e){const t=Me(i);t.asyncQueue.verifyOperationInProgress(),de(Ua,"RemoteStore received new credentials");const s=Ka(t);t.Ia.add(3),await pc(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await ff(t)}async function JO(i,e){const t=Me(i);e?(t.Ia.delete(2),await ff(t)):e||(t.Ia.add(2),await pc(t),t.Aa.set("Unknown"))}function _l(i){return i.Va||(i.Va=function(t,s,a){const l=Me(t);return l.ia(),new VO(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)}(i.datastore,i.asyncQueue,{Zo:zO.bind(null,i),e_:qO.bind(null,i),n_:HO.bind(null,i),J_:GO.bind(null,i)}),i.da.push(async e=>{e?(i.Va.N_(),A_(i)?S_(i):i.Aa.set("Unknown")):(await i.Va.stop(),_S(i))})),i.Va}function Kr(i){return i.ma||(i.ma=function(t,s,a){const l=Me(t);return l.ia(),new LO(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)}(i.datastore,i.asyncQueue,{Zo:()=>Promise.resolve(),e_:QO.bind(null,i),n_:XO.bind(null,i),ea:$O.bind(null,i),ta:WO.bind(null,i)}),i.da.push(async e=>{e?(i.ma.N_(),await mf(i)):(await i.ma.stop(),i.Pa.length>0&&(de(Ua,`Stopping write stream with ${i.Pa.length} pending writes`),i.Pa=[]))})),i.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new Fs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const c=Date.now()+s,f=new R_(e,t,c,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function C_(i,e){if(Ks("AsyncQueue",`${e}: ${i}`),gl(i))return new he(W.UNAVAILABLE,`${e}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{static emptySet(e){return new Wo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||we.comparator(t.key,s.key):(t,s)=>we.comparator(t.key,s.key),this.keyedMap=Ou(),this.sortedSet=new At(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Wo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Wo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(){this.fa=new At(we.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):xe(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,s)=>{e.push(s)}),e}}class ol{constructor(e,t,s,a,l,c,f,p,g){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,t,s,a,l){const c=[];return t.forEach(f=>{c.push({type:0,doc:f})}),new ol(e,t,Wo.emptySet(t),c,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&of(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class e4{constructor(){this.queries=eb(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=Me(t),l=a.queries;a.queries=eb(),l.forEach((c,f)=>{for(const p of f.wa)p.onError(s)})})(this,new he(W.ABORTED,"Firestore shutting down"))}}function eb(){return new Ga(i=>B1(i),of)}async function I_(i,e){const t=Me(i);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new ZO,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const f=C_(c,`Initialization of query '${zo(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&N_(t)}async function x_(i,e){const t=Me(i),s=e.query;let a=3;const l=t.queries.get(s);if(l){const c=l.wa.indexOf(e);c>=0&&(l.wa.splice(c,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function t4(i,e){const t=Me(i);let s=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const f of c.wa)f.Ca(a)&&(s=!0);c.ya=a}}s&&N_(t)}function n4(i,e,t){const s=Me(i),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function N_(i){i.Da.forEach(e=>{e.next()})}var Ag,tb;(tb=Ag||(Ag={})).Fa="default",tb.Cache="cache";class D_{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new ol(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=ol.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Ag.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e){this.key=e}}class bS{constructor(e){this.key=e}}class i4{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ke(),this.mutatedKeys=Ke(),this.Xa=F1(e),this.eu=new Wo(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new ZT,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,f=!1;const p=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,g=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((y,b)=>{const S=a.get(y),P=lf(this.query,b)?b:null,k=!!S&&this.mutatedKeys.has(S.key),q=!!P&&(P.hasLocalMutations||this.mutatedKeys.has(P.key)&&P.hasCommittedMutations);let K=!1;S&&P?S.data.isEqual(P.data)?k!==q&&(s.track({type:3,doc:P}),K=!0):this.iu(S,P)||(s.track({type:2,doc:P}),K=!0,(p&&this.Xa(P,p)>0||g&&this.Xa(P,g)<0)&&(f=!0)):!S&&P?(s.track({type:0,doc:P}),K=!0):S&&!P&&(s.track({type:1,doc:S}),K=!0,(p||g)&&(f=!0)),K&&(P?(c=c.add(P),l=q?l.add(y):l.delete(y)):(c=c.delete(y),l=l.delete(y)))}),this.query.limit!==null)for(;c.size>this.query.limit;){const y=this.query.limitType==="F"?c.last():c.first();c=c.delete(y.key),l=l.delete(y.key),s.track({type:1,doc:y})}return{eu:c,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const c=e.ru.pa();c.sort((y,b)=>function(P,k){const q=K=>{switch(K){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xe(20277,{At:K})}};return q(P)-q(k)}(y.type,b.type)||this.Xa(y.doc,b.doc)),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],p=this.Za.size===0&&this.current&&!a?1:0,g=p!==this.Ya;return this.Ya=p,c.length!==0||g?{snapshot:new ol(this.query,e.eu,l,c,e.mutatedKeys,p===0,g,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new ZT,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Ke(),this.eu.forEach(s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))});const t=[];return e.forEach(s=>{this.Za.has(s)||t.push(new bS(s))}),this.Za.forEach(s=>{e.has(s)||t.push(new TS(s))}),t}uu(e){this.Ha=e.qs,this.Za=Ke();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return ol.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const O_="SyncEngine";class s4{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class r4{constructor(e){this.key=e,this.lu=!1}}class a4{constructor(e,t,s,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.hu={},this.Pu=new Ga(f=>B1(f),of),this.Tu=new Map,this.Iu=new Set,this.du=new At(we.comparator),this.Eu=new Map,this.Au=new y_,this.Ru={},this.Vu=new Map,this.mu=al.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function o4(i,e,t=!0){const s=IS(i);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await wS(s,e,t,!0),a}async function l4(i,e){const t=IS(i);await wS(t,e,!0,!1)}async function wS(i,e,t,s){const a=await IO(i.localStore,Wi(e)),l=a.targetId,c=i.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await u4(i,e,l,c==="current",a.resumeToken)),i.isPrimaryClient&&t&&pS(i.remoteStore,a),f}async function u4(i,e,t,s,a){i.gu=(b,S,P)=>async function(q,K,pe,ae){let ce=K.view.nu(pe);ce.Ds&&(ce=await YT(q.localStore,K.query,!1).then(({documents:M})=>K.view.nu(M,ce)));const Te=ae&&ae.targetChanges.get(K.targetId),be=ae&&ae.targetMismatches.get(K.targetId)!=null,Re=K.view.applyChanges(ce,q.isPrimaryClient,Te,be);return ib(q,K.targetId,Re._u),Re.snapshot}(i,b,S,P);const l=await YT(i.localStore,e,!0),c=new i4(e,l.qs),f=c.nu(l.documents),p=mc.createSynthesizedTargetChangeForCurrentChange(t,s&&i.onlineState!=="Offline",a),g=c.applyChanges(f,i.isPrimaryClient,p);ib(i,t,g._u);const y=new s4(e,t,c);return i.Pu.set(e,y),i.Tu.has(t)?i.Tu.get(t).push(e):i.Tu.set(t,[e]),g.snapshot}async function c4(i,e,t){const s=Me(i),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter(c=>!of(c,e))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await wg(s.localStore,a.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(a.targetId),t&&b_(s.remoteStore,a.targetId),Rg(s,a.targetId)}).catch(pl)):(Rg(s,a.targetId),await wg(s.localStore,a.targetId,!0))}async function h4(i,e){const t=Me(i),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),b_(t.remoteStore,s.targetId))}async function d4(i,e,t){const s=v4(i);try{const a=await function(c,f){const p=Me(c),g=yt.now(),y=f.reduce((P,k)=>P.add(k.key),Ke());let b,S;return p.persistence.runTransaction("Locally write mutations","readwrite",P=>{let k=Ys(),q=Ke();return p.Os.getEntries(P,y).next(K=>{k=K,k.forEach((pe,ae)=>{ae.isValidDocument()||(q=q.add(pe))})}).next(()=>p.localDocuments.getOverlayedDocuments(P,k)).next(K=>{b=K;const pe=[];for(const ae of f){const ce=ID(ae,b.get(ae.key).overlayedDocument);ce!=null&&pe.push(new $r(ae.key,ce,O1(ce.value.mapValue),Xi.exists(!0)))}return p.mutationQueue.addMutationBatch(P,g,pe,f)}).next(K=>{S=K;const pe=K.applyToLocalDocumentSet(b,q);return p.documentOverlayCache.saveOverlays(P,K.batchId,pe)})}).then(()=>({batchId:S.batchId,changes:q1(b)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),function(c,f,p){let g=c.Ru[c.currentUser.toKey()];g||(g=new At(je)),g=g.insert(f,p),c.Ru[c.currentUser.toKey()]=g}(s,a.batchId,t),await gc(s,a.changes),await mf(s.remoteStore)}catch(a){const l=C_(a,"Failed to persist write");t.reject(l)}}async function SS(i,e){const t=Me(i);try{const s=await AO(t.localStore,e);e.targetChanges.forEach((a,l)=>{const c=t.Eu.get(l);c&&(st(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.lu=!0:a.modifiedDocuments.size>0?st(c.lu,14607):a.removedDocuments.size>0&&(st(c.lu,42227),c.lu=!1))}),await gc(t,s,e)}catch(s){await pl(s)}}function nb(i,e,t){const s=Me(i);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach((l,c)=>{const f=c.view.va(e);f.snapshot&&a.push(f.snapshot)}),function(c,f){const p=Me(c);p.onlineState=f;let g=!1;p.queries.forEach((y,b)=>{for(const S of b.wa)S.va(f)&&(g=!0)}),g&&N_(p)}(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function f4(i,e,t){const s=Me(i);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let c=new At(we.comparator);c=c.insert(l,bn.newNoDocument(l,ke.min()));const f=Ke().add(l),p=new hf(ke.min(),new Map,new At(je),c,f);await SS(s,p),s.du=s.du.remove(l),s.Eu.delete(e),k_(s)}else await wg(s.localStore,e,!1).then(()=>Rg(s,e,t)).catch(pl)}async function m4(i,e){const t=Me(i),s=e.batch.batchId;try{const a=await SO(t.localStore,e);RS(t,s,null),AS(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await gc(t,a)}catch(a){await pl(a)}}async function p4(i,e,t){const s=Me(i);try{const a=await function(c,f){const p=Me(c);return p.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let y;return p.mutationQueue.lookupMutationBatch(g,f).next(b=>(st(b!==null,37113),y=b.keys(),p.mutationQueue.removeMutationBatch(g,b))).next(()=>p.mutationQueue.performConsistencyCheck(g)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(g,y,f)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,y)).next(()=>p.localDocuments.getDocuments(g,y))})}(s.localStore,e);RS(s,e,t),AS(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await gc(s,a)}catch(a){await pl(a)}}function AS(i,e){(i.Vu.get(e)||[]).forEach(t=>{t.resolve()}),i.Vu.delete(e)}function RS(i,e,t){const s=Me(i);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Rg(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const s of i.Tu.get(e))i.Pu.delete(s),t&&i.hu.pu(s,t);i.Tu.delete(e),i.isPrimaryClient&&i.Au.zr(e).forEach(s=>{i.Au.containsKey(s)||CS(i,s)})}function CS(i,e){i.Iu.delete(e.path.canonicalString());const t=i.du.get(e);t!==null&&(b_(i.remoteStore,t),i.du=i.du.remove(e),i.Eu.delete(t),k_(i))}function ib(i,e,t){for(const s of t)s instanceof TS?(i.Au.addReference(s.key,e),g4(i,s)):s instanceof bS?(de(O_,"Document no longer in limbo: "+s.key),i.Au.removeReference(s.key,e),i.Au.containsKey(s.key)||CS(i,s.key)):xe(19791,{yu:s})}function g4(i,e){const t=e.key,s=t.path.canonicalString();i.du.get(t)||i.Iu.has(s)||(de(O_,"New document in limbo: "+t),i.Iu.add(s),k_(i))}function k_(i){for(;i.Iu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const e=i.Iu.values().next().value;i.Iu.delete(e);const t=new we(pt.fromString(e)),s=i.mu.next();i.Eu.set(s,new r4(t)),i.du=i.du.insert(t,s),pS(i.remoteStore,new Or(Wi(af(t.path)),s,"TargetPurposeLimboResolution",nf.ue))}}async function gc(i,e,t){const s=Me(i),a=[],l=[],c=[];s.Pu.isEmpty()||(s.Pu.forEach((f,p)=>{c.push(s.gu(p,e,t).then(g=>{var y;if((g||t)&&s.isPrimaryClient){const b=g?!g.fromCache:(y=t?.targetChanges.get(p.targetId))===null||y===void 0?void 0:y.current;s.sharedClientState.updateQueryState(p.targetId,b?"current":"not-current")}if(g){a.push(g);const b=E_.Es(p.targetId,g);l.push(b)}}))}),await Promise.all(c),s.hu.J_(a),await async function(p,g){const y=Me(p);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",b=>ee.forEach(g,S=>ee.forEach(S.Is,P=>y.persistence.referenceDelegate.addReference(b,S.targetId,P)).next(()=>ee.forEach(S.ds,P=>y.persistence.referenceDelegate.removeReference(b,S.targetId,P)))))}catch(b){if(!gl(b))throw b;de(T_,"Failed to update sequence numbers: "+b)}for(const b of g){const S=b.targetId;if(!b.fromCache){const P=y.Fs.get(S),k=P.snapshotVersion,q=P.withLastLimboFreeSnapshotVersion(k);y.Fs=y.Fs.insert(S,q)}}}(s.localStore,l))}async function _4(i,e){const t=Me(i);if(!t.currentUser.isEqual(e)){de(O_,"User change. New user:",e.toKey());const s=await hS(t.localStore,e);t.currentUser=e,function(l,c){l.Vu.forEach(f=>{f.forEach(p=>{p.reject(new he(W.CANCELLED,c))})}),l.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await gc(t,s.Bs)}}function y4(i,e){const t=Me(i),s=t.Eu.get(e);if(s&&s.lu)return Ke().add(s.key);{let a=Ke();const l=t.Tu.get(e);if(!l)return a;for(const c of l){const f=t.Pu.get(c);a=a.unionWith(f.view.tu)}return a}}function IS(i){const e=Me(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=SS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=y4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=f4.bind(null,e),e.hu.J_=t4.bind(null,e.eventManager),e.hu.pu=n4.bind(null,e.eventManager),e}function v4(i){const e=Me(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=m4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=p4.bind(null,e),e}class Od{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=df(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return wO(this.persistence,new EO,e.initialUser,this.serializer)}Du(e){return new cS(v_.Vi,this.serializer)}bu(e){return new NO}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Od.provider={build:()=>new Od};class E4 extends Od{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){st(this.persistence.referenceDelegate instanceof Nd,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new rO(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Mn.withCacheSize(this.cacheSizeBytes):Mn.DEFAULT;return new cS(s=>Nd.Vi(s,t),this.serializer)}}class Cg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>nb(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=_4.bind(null,this.syncEngine),await JO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new e4}()}createDatastore(e){const t=df(e.databaseInfo.databaseId),s=function(l){return new PO(l)}(e.databaseInfo);return function(l,c,f,p){return new jO(l,c,f,p)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,a,l,c,f){return new FO(s,a,l,c,f)}(this.localStore,this.datastore,e.asyncQueue,t=>nb(this.syncEngine,t,0),function(){return WT.C()?new WT:new DO}())}createSyncEngine(e,t){return function(a,l,c,f,p,g,y){const b=new a4(a,l,c,f,p,g);return y&&(b.fu=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(a){const l=Me(a);de(Ua,"RemoteStore shutting down."),l.Ia.add(5),await pc(l),l.Ea.shutdown(),l.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Cg.provider={build:()=>new Cg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Ks("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yr="FirestoreClient";class T4{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=vn.UNAUTHENTICATED,this.clientId=l_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,async c=>{de(Yr,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(s,c=>(de(Yr,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Fs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=C_(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function Hp(i,e){i.asyncQueue.verifyOperationInProgress(),de(Yr,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let s=t.initialUser;i.setCredentialChangeListener(async a=>{s.isEqual(a)||(await hS(e.localStore,a),s=a)}),e.persistence.setDatabaseDeletedListener(()=>{Fr("Terminating Firestore due to IndexedDb database deletion"),i.terminate().then(()=>{de("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(a=>{Fr("Terminating Firestore due to IndexedDb database deletion failed",a)})}),i._offlineComponents=e}async function sb(i,e){i.asyncQueue.verifyOperationInProgress();const t=await b4(i);de(Yr,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener(s=>JT(e.remoteStore,s)),i.setAppCheckTokenChangeListener((s,a)=>JT(e.remoteStore,a)),i._onlineComponents=e}async function b4(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){de(Yr,"Using user provided OfflineComponentProvider");try{await Hp(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(a){return a.name==="FirebaseError"?a.code===W.FAILED_PRECONDITION||a.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(t))throw t;Fr("Error using user provided cache. Falling back to memory cache: "+t),await Hp(i,new Od)}}else de(Yr,"Using default OfflineComponentProvider"),await Hp(i,new E4(void 0));return i._offlineComponents}async function xS(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(de(Yr,"Using user provided OnlineComponentProvider"),await sb(i,i._uninitializedComponentsProvider._online)):(de(Yr,"Using default OnlineComponentProvider"),await sb(i,new Cg))),i._onlineComponents}function w4(i){return xS(i).then(e=>e.syncEngine)}async function kd(i){const e=await xS(i),t=e.eventManager;return t.onListen=o4.bind(null,e.syncEngine),t.onUnlisten=c4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=l4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=h4.bind(null,e.syncEngine),t}function S4(i,e,t={}){const s=new Fs;return i.asyncQueue.enqueueAndForget(async()=>function(l,c,f,p,g){const y=new M_({next:S=>{y.Ou(),c.enqueueAndForget(()=>x_(l,b));const P=S.docs.has(f);!P&&S.fromCache?g.reject(new he(W.UNAVAILABLE,"Failed to get document because the client is offline.")):P&&S.fromCache&&p&&p.source==="server"?g.reject(new he(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(S)},error:S=>g.reject(S)}),b=new D_(af(f.path),y,{includeMetadataChanges:!0,ka:!0});return I_(l,b)}(await kd(i),i.asyncQueue,e,t,s)),s.promise}function A4(i,e,t={}){const s=new Fs;return i.asyncQueue.enqueueAndForget(async()=>function(l,c,f,p,g){const y=new M_({next:S=>{y.Ou(),c.enqueueAndForget(()=>x_(l,b)),S.fromCache&&p.source==="server"?g.reject(new he(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(S)},error:S=>g.reject(S)}),b=new D_(f,y,{includeMetadataChanges:!0,ka:!0});return I_(l,b)}(await kd(i),i.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NS(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rb=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS="firestore.googleapis.com",ab=!0;class ob{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new he(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=DS,this.ssl=ab}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:ab;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=uS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<iO)throw new he(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}z2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=NS((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new he(W.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new he(W.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new he(W.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,a){return s.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class pf{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ob({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ob(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new k2;switch(s.type){case"firstParty":return new L2(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new he(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=rb.get(t);s&&(de("ComponentProvider","Removing Datastore"),rb.delete(t),s.terminate())}(this),Promise.resolve()}}function R4(i,e,t,s={}){var a;i=di(i,pf);const l=$s(e),c=i._getSettings(),f=Object.assign(Object.assign({},c),{emulatorOptions:i._getEmulatorOptions()}),p=`${e}:${t}`;l&&(Gd(`https://${p}`),Kd("Firestore",!0)),c.host!==DS&&c.host!==p&&Fr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g=Object.assign(Object.assign({},c),{host:p,ssl:l,emulatorOptions:s});if(!Ur(g,f)&&(i._setSettings(g),s.mockUserToken)){let y,b;if(typeof s.mockUserToken=="string")y=s.mockUserToken,b=vn.MOCK_USER;else{y=Kb(s.mockUserToken,(a=i._app)===null||a===void 0?void 0:a.options.projectId);const S=s.mockUserToken.sub||s.mockUserToken.user_id;if(!S)throw new he(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new vn(S)}i._authCredentials=new M2(new v1(y,b))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Ya(this.firestore,e,this._query)}}class It{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new It(this.firestore,e,this._key)}toJSON(){return{type:It._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(hc(t,It._jsonSchema))return new It(e,s||null,new we(pt.fromString(t.referencePath)))}}It._jsonSchemaVersion="firestore/documentReference/1.0",It._jsonSchema={type:Ft("string",It._jsonSchemaVersion),referencePath:Ft("string")};class Lr extends Ya{constructor(e,t,s){super(e,t,af(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new It(this.firestore,null,new we(e))}withConverter(e){return new Lr(this.firestore,e,this._path)}}function C4(i,e,...t){if(i=St(i),T1("collection","path",e),i instanceof pf){const s=pt.fromString(e,...t);return ET(s),new Lr(i,null,s)}{if(!(i instanceof It||i instanceof Lr))throw new he(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=i._path.child(pt.fromString(e,...t));return ET(s),new Lr(i.firestore,null,s)}}function Ki(i,e,...t){if(i=St(i),arguments.length===1&&(e=l_.newId()),T1("doc","path",e),i instanceof pf){const s=pt.fromString(e,...t);return vT(s),new It(i,null,new we(s))}{if(!(i instanceof It||i instanceof Lr))throw new he(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=i._path.child(pt.fromString(e,...t));return vT(s),new It(i.firestore,i instanceof Lr?i.converter:null,new we(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb="AsyncQueue";class ub{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new fS(this,"async_queue_retry"),this.oc=()=>{const s=qp();s&&de(lb,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=qp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=qp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new Fs;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!gl(e))throw e;de(lb,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(s=>{throw this.tc=s,this.nc=!1,Ks("INTERNAL UNHANDLED ERROR: ",cb(s)),s}).then(s=>(this.nc=!1,s))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=R_.createAndSchedule(this,e,t,s,l=>this.lc(l));return this.ec.push(a),a}ac(){this.tc&&xe(47125,{hc:cb(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function cb(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hb(i){return function(t,s){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of s)if(l in a&&typeof a[l]=="function")return!0;return!1}(i,["next","error","complete"])}class ja extends pf{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new ub,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ub(e),this._firestoreClient=void 0,await e}}}function I4(i,e){const t=typeof i=="object"?i:$d(),s=typeof i=="string"?i:wd,a=rc(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=Vg("firestore");l&&R4(a,...l)}return a}function gf(i){if(i._terminated)throw new he(W.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||x4(i),i._firestoreClient}function x4(i){var e,t,s;const a=i._freezeSettings(),l=function(f,p,g,y){return new Z2(f,p,g,y.host,y.ssl,y.experimentalForceLongPolling,y.experimentalAutoDetectLongPolling,NS(y.experimentalLongPollingOptions),y.useFetchStreams,y.isUsingEmulator)}(i._databaseId,((e=i._app)===null||e===void 0?void 0:e.options.appId)||"",i._persistenceKey,a);i._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(i._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),i._firestoreClient=new T4(i._authCredentials,i._appCheckCredentials,i._queue,l,i._componentsProvider&&function(f){const p=f?._online.build();return{_offline:f?._offline.build(p),_online:p}}(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ui(mn.fromBase64String(e))}catch(t){throw new he(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ui(mn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ui._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(hc(e,ui._jsonSchema))return ui.fromBase64String(e.bytes)}}ui._jsonSchemaVersion="firestore/bytes/1.0",ui._jsonSchema={type:Ft("string",ui._jsonSchemaVersion),bytes:Ft("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new he(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new fn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new he(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new he(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return je(this._lat,e._lat)||je(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Zi._jsonSchemaVersion}}static fromJSON(e){if(hc(e,Zi._jsonSchema))return new Zi(e.latitude,e.longitude)}}Zi._jsonSchemaVersion="firestore/geoPoint/1.0",Zi._jsonSchema={type:Ft("string",Zi._jsonSchemaVersion),latitude:Ft("number"),longitude:Ft("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0}(this._values,e._values)}toJSON(){return{type:es._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(hc(e,es._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new es(e.vectorValues);throw new he(W.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}es._jsonSchemaVersion="firestore/vectorValue/1.0",es._jsonSchema={type:Ft("string",es._jsonSchemaVersion),vectorValues:Ft("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N4=/^__.*__$/;class D4{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new $r(e,this.data,this.fieldMask,t,this.fieldTransforms):new fc(e,this.data,t,this.fieldTransforms)}}class OS{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new $r(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function kS(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xe(40011,{Ec:i})}}class V_{constructor(e,t,s,a,l,c){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new V_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Md(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(kS(this.Ec)&&N4.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class O4{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||df(e)}Dc(e,t,s,a=!1){return new V_({Ec:e,methodName:t,bc:s,path:fn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function L_(i){const e=i._freezeSettings(),t=df(i._databaseId);return new O4(i._databaseId,!!e.ignoreUndefinedProperties,t)}function k4(i,e,t,s,a,l={}){const c=i.Dc(l.merge||l.mergeFields?2:0,e,t,a);U_("Data must be an object, but it was:",c,s);const f=MS(s,c);let p,g;if(l.merge)p=new Qn(c.fieldMask),g=c.fieldTransforms;else if(l.mergeFields){const y=[];for(const b of l.mergeFields){const S=Ig(e,b,t);if(!c.contains(S))throw new he(W.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);VS(y,S)||y.push(S)}p=new Qn(y),g=c.fieldTransforms.filter(b=>p.covers(b.field))}else p=null,g=c.fieldTransforms;return new D4(new Vn(f),p,g)}class yf extends P_{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof yf}}function M4(i,e,t,s){const a=i.Dc(1,e,t);U_("Data must be an object, but it was:",a,s);const l=[],c=Vn.empty();Qr(s,(p,g)=>{const y=j_(e,p,t);g=St(g);const b=a.gc(y);if(g instanceof yf)l.push(y);else{const S=_c(g,b);S!=null&&(l.push(y),c.set(y,S))}});const f=new Qn(l);return new OS(c,f,a.fieldTransforms)}function P4(i,e,t,s,a,l){const c=i.Dc(1,e,t),f=[Ig(e,s,t)],p=[a];if(l.length%2!=0)throw new he(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<l.length;S+=2)f.push(Ig(e,l[S])),p.push(l[S+1]);const g=[],y=Vn.empty();for(let S=f.length-1;S>=0;--S)if(!VS(g,f[S])){const P=f[S];let k=p[S];k=St(k);const q=c.gc(P);if(k instanceof yf)g.push(P);else{const K=_c(k,q);K!=null&&(g.push(P),y.set(P,K))}}const b=new Qn(g);return new OS(y,b,c.fieldTransforms)}function V4(i,e,t,s=!1){return _c(t,i.Dc(s?4:3,e))}function _c(i,e){if(PS(i=St(i)))return U_("Unsupported field value:",e,i),MS(i,e);if(i instanceof P_)return function(s,a){if(!kS(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(s,a){const l=[];let c=0;for(const f of s){let p=_c(f,a.yc(c));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),c++}return{arrayValue:{values:l}}}(i,e)}return function(s,a){if((s=St(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return bD(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=yt.fromDate(s);return{timestampValue:xd(a.serializer,l)}}if(s instanceof yt){const l=new yt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:xd(a.serializer,l)}}if(s instanceof Zi)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ui)return{bytesValue:nS(a.serializer,s._byteString)};if(s instanceof It){const l=a.databaseId,c=s.firestore._databaseId;if(!c.isEqual(l))throw a.wc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:__(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof es)return function(c,f){return{mapValue:{fields:{[N1]:{stringValue:D1},[Sd]:{arrayValue:{values:c.toArray().map(g=>{if(typeof g!="number")throw f.wc("VectorValues must only contain numeric values.");return m_(f.serializer,g)})}}}}}}(s,a);throw a.wc(`Unsupported field value: ${tf(s)}`)}(i,e)}function MS(i,e){const t={};return S1(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qr(i,(s,a)=>{const l=_c(a,e.Vc(s));l!=null&&(t[s]=l)}),{mapValue:{fields:t}}}function PS(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof yt||i instanceof Zi||i instanceof ui||i instanceof It||i instanceof P_||i instanceof es)}function U_(i,e,t){if(!PS(t)||!b1(t)){const s=tf(t);throw s==="an object"?e.wc(i+" a custom object"):e.wc(i+" "+s)}}function Ig(i,e,t){if((e=St(e))instanceof _f)return e._internalPath;if(typeof e=="string")return j_(i,e);throw Md("Field path arguments must be of type string or ",i,!1,void 0,t)}const L4=new RegExp("[~\\*/\\[\\]]");function j_(i,e,t){if(e.search(L4)>=0)throw Md(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new _f(...e.split("."))._internalPath}catch{throw Md(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function Md(i,e,t,s,a){const l=s&&!s.isEmpty(),c=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(l||c)&&(p+=" (found",l&&(p+=` in field ${s}`),c&&(p+=` in document ${a}`),p+=")"),new he(W.INVALID_ARGUMENT,f+i+p)}function VS(i,e){return i.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new It(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new U4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(B_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class U4 extends LS{data(){return super.data()}}function B_(i,e){return typeof e=="string"?j_(i,e):e instanceof _f?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new he(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class F_{}class j4 extends F_{}function db(i,e,...t){let s=[];e instanceof F_&&s.push(e),s=s.concat(t),function(l){const c=l.filter(p=>p instanceof z_).length,f=l.filter(p=>p instanceof vf).length;if(c>1||c>0&&f>0)throw new he(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const a of s)i=a._apply(i);return i}class vf extends j4{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new vf(e,t,s)}_apply(e){const t=this._parse(e);return jS(e._query,t),new Ya(e.firestore,e.converter,_g(e._query,t))}_parse(e){const t=L_(e.firestore);return function(l,c,f,p,g,y,b){let S;if(g.isKeyField()){if(y==="array-contains"||y==="array-contains-any")throw new he(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if(y==="in"||y==="not-in"){mb(b,y);const k=[];for(const q of b)k.push(fb(p,l,q));S={arrayValue:{values:k}}}else S=fb(p,l,b)}else y!=="in"&&y!=="not-in"&&y!=="array-contains-any"||mb(b,y),S=V4(f,c,b,y==="in"||y==="not-in");return Bt.create(g,y,S)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Wh(i,e,t){const s=e,a=B_("where",i);return vf._create(a,s,t)}class z_ extends F_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new z_(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:Ci.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(a,l){let c=a;const f=l.getFlattenedFilters();for(const p of f)jS(c,p),c=_g(c,p)}(e._query,t),new Ya(e.firestore,e.converter,_g(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function fb(i,e,t){if(typeof(t=St(t))=="string"){if(t==="")throw new he(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!j1(e)&&t.indexOf("/")!==-1)throw new he(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(pt.fromString(t));if(!we.isDocumentKey(s))throw new he(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return IT(i,new we(s))}if(t instanceof It)return IT(i,t._key);throw new he(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tf(t)}.`)}function mb(i,e){if(!Array.isArray(i)||i.length===0)throw new he(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jS(i,e){const t=function(a,l){for(const c of a)for(const f of c.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null}(i.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new he(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class B4{convertValue(e,t="none"){switch(Gr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Hr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Qr(e,(a,l)=>{s[a]=this.convertValue(l,t)}),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Sd].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map(c=>kt(c.doubleValue));return new es(l)}convertGeoPoint(e){return new Zi(kt(e.latitude),kt(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=rf(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Wu(e));default:return null}}convertTimestamp(e){const t=qr(e);return new yt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=pt.fromString(e);st(lS(s),9688,{name:e});const a=new Xu(s.get(1),s.get(3)),l=new we(s.popFirst(5));return a.isEqual(t)||Ks(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F4(i,e,t){let s;return s=i?i.toFirestore(e):e,s}class Mu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Oa extends LS{constructor(e,t,s,a,l,c){super(e,t,s,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new rd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(B_("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new he(W.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Oa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Oa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Oa._jsonSchema={type:Ft("string",Oa._jsonSchemaVersion),bundleSource:Ft("string","DocumentSnapshot"),bundleName:Ft("string"),bundle:Ft("string")};class rd extends Oa{data(e={}){return super.data(e)}}class ka{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Mu(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new rd(this._firestore,this._userDataWriter,s.key,s,new Mu(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new he(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map(f=>{const p=new rd(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Mu(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:c++}})}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(f=>l||f.type!==3).map(f=>{const p=new rd(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Mu(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let g=-1,y=-1;return f.type!==0&&(g=c.indexOf(f.doc.key),c=c.delete(f.doc.key)),f.type!==1&&(c=c.add(f.doc),y=c.indexOf(f.doc.key)),{type:z4(f.type),doc:p,oldIndex:g,newIndex:y}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new he(W.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ka._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=l_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach(l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function z4(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xe(61501,{type:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q4(i){i=di(i,It);const e=di(i.firestore,ja);return S4(gf(e),i._key).then(t=>FS(e,i,t))}ka._jsonSchemaVersion="firestore/querySnapshot/1.0",ka._jsonSchema={type:Ft("string",ka._jsonSchemaVersion),bundleSource:Ft("string","QuerySnapshot"),bundleName:Ft("string"),bundle:Ft("string")};class q_ extends B4{constructor(e){super(),this.firestore=e}convertBytes(e){return new ui(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new It(this.firestore,null,t)}}function pb(i){i=di(i,Ya);const e=di(i.firestore,ja),t=gf(e),s=new q_(e);return US(i._query),A4(t,i._query).then(a=>new ka(e,s,i,a))}function H4(i,e,t){i=di(i,It);const s=di(i.firestore,ja),a=F4(i.converter,e);return BS(s,[k4(L_(s),"setDoc",i._key,a,i.converter!==null,t).toMutation(i._key,Xi.none())])}function Rr(i,e,t,...s){i=di(i,It);const a=di(i.firestore,ja),l=L_(a);let c;return c=typeof(e=St(e))=="string"||e instanceof _f?P4(l,"updateDoc",i._key,e,t,s):M4(l,"updateDoc",i._key,e),BS(a,[c.toMutation(i._key,Xi.exists(!0))])}function G4(i,...e){var t,s,a;i=St(i);let l={includeMetadataChanges:!1,source:"default"},c=0;typeof e[c]!="object"||hb(e[c])||(l=e[c++]);const f={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(hb(e[c])){const b=e[c];e[c]=(t=b.next)===null||t===void 0?void 0:t.bind(b),e[c+1]=(s=b.error)===null||s===void 0?void 0:s.bind(b),e[c+2]=(a=b.complete)===null||a===void 0?void 0:a.bind(b)}let p,g,y;if(i instanceof It)g=di(i.firestore,ja),y=af(i._key.path),p={next:b=>{e[c]&&e[c](FS(g,i,b))},error:e[c+1],complete:e[c+2]};else{const b=di(i,Ya);g=di(b.firestore,ja),y=b._query;const S=new q_(g);p={next:P=>{e[c]&&e[c](new ka(g,S,b,P))},error:e[c+1],complete:e[c+2]},US(i._query)}return function(S,P,k,q){const K=new M_(q),pe=new D_(P,K,k);return S.asyncQueue.enqueueAndForget(async()=>I_(await kd(S),pe)),()=>{K.Ou(),S.asyncQueue.enqueueAndForget(async()=>x_(await kd(S),pe))}}(gf(g),y,f,p)}function BS(i,e){return function(s,a){const l=new Fs;return s.asyncQueue.enqueueAndForget(async()=>d4(await w4(s),a,l)),l.promise}(gf(i),e)}function FS(i,e,t){const s=t.docs.get(e._key),a=new q_(i);return new Oa(i,a,e._key,s,new Mu(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(a){ml=a})(za),jr(new qs("firestore",(s,{instanceIdentifier:a,options:l})=>{const c=s.getProvider("app").getImmediate(),f=new ja(new P2(s.getProvider("auth-internal")),new U2(c,s.getProvider("app-check-internal")),function(g,y){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new he(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xu(g.options.projectId,y)}(c,a),c);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f},"PUBLIC").setMultipleInstances(!0)),hi(mT,pT,e),hi(mT,pT,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K4="type.googleapis.com/google.protobuf.Int64Value",Y4="type.googleapis.com/google.protobuf.UInt64Value";function zS(i,e){const t={};for(const s in i)i.hasOwnProperty(s)&&(t[s]=e(i[s]));return t}function Pd(i){if(i==null)return null;if(i instanceof Number&&(i=i.valueOf()),typeof i=="number"&&isFinite(i)||i===!0||i===!1||Object.prototype.toString.call(i)==="[object String]")return i;if(i instanceof Date)return i.toISOString();if(Array.isArray(i))return i.map(e=>Pd(e));if(typeof i=="function"||typeof i=="object")return zS(i,e=>Pd(e));throw new Error("Data cannot be encoded in JSON: "+i)}function ll(i){if(i==null)return i;if(i["@type"])switch(i["@type"]){case K4:case Y4:{const e=Number(i.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+i);return e}default:throw new Error("Data cannot be decoded from JSON: "+i)}return Array.isArray(i)?i.map(e=>ll(e)):typeof i=="function"||typeof i=="object"?zS(i,e=>ll(e)):i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H_="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ln extends ss{constructor(e,t,s){super(`${H_}/${e}`,t||""),this.details=s,Object.setPrototypeOf(this,Ln.prototype)}}function Q4(i){if(i>=200&&i<300)return"ok";switch(i){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Vd(i,e){let t=Q4(i),s=t,a;try{const l=e&&e.error;if(l){const c=l.status;if(typeof c=="string"){if(!gb[c])return new Ln("internal","internal");t=gb[c],s=c}const f=l.message;typeof f=="string"&&(s=f),a=l.details,a!==void 0&&(a=ll(a))}}catch{}return t==="ok"?null:new Ln(t,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e,t,s,a){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Pn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=s.getImmediate({optional:!0}),this.auth||t.get().then(l=>this.auth=l,()=>{}),this.messaging||s.get().then(l=>this.messaging=l,()=>{}),this.appCheck||a?.get().then(l=>this.appCheck=l,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),s=await this.getMessagingToken(),a=await this.getAppCheckToken(e);return{authToken:t,messagingToken:s,appCheckToken:a}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg="us-central1",W4=/^data: (.*?)(?:\n|$)/;function X4(i){let e=null;return{promise:new Promise((t,s)=>{e=setTimeout(()=>{s(new Ln("deadline-exceeded","deadline-exceeded"))},i)}),cancel:()=>{e&&clearTimeout(e)}}}class J4{constructor(e,t,s,a,l=xg,c=(...f)=>fetch(...f)){this.app=e,this.fetchImpl=c,this.emulatorOrigin=null,this.contextProvider=new $4(e,t,s,a),this.cancelAllRequests=new Promise(f=>{this.deleteService=()=>Promise.resolve(f())});try{const f=new URL(l);this.customDomain=f.origin+(f.pathname==="/"?"":f.pathname),this.region=xg}catch{this.customDomain=null,this.region=l}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function Z4(i,e,t){const s=$s(e);i.emulatorOrigin=`http${s?"s":""}://${e}:${t}`,s&&(Gd(i.emulatorOrigin),Kd("Functions",!0))}function ek(i,e,t){const s=a=>nk(i,e,a,{});return s.stream=(a,l)=>sk(i,e,a,l),s}async function tk(i,e,t,s){t["Content-Type"]="application/json";let a;try{a=await s(i,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let l=null;try{l=await a.json()}catch{}return{status:a.status,json:l}}async function qS(i,e){const t={},s=await i.contextProvider.getContext(e.limitedUseAppCheckTokens);return s.authToken&&(t.Authorization="Bearer "+s.authToken),s.messagingToken&&(t["Firebase-Instance-ID-Token"]=s.messagingToken),s.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=s.appCheckToken),t}function nk(i,e,t,s){const a=i._url(e);return ik(i,a,t,s)}async function ik(i,e,t,s){t=Pd(t);const a={data:t},l=await qS(i,s),c=s.timeout||7e4,f=X4(c),p=await Promise.race([tk(e,a,l,i.fetchImpl),f.promise,i.cancelAllRequests]);if(f.cancel(),!p)throw new Ln("cancelled","Firebase Functions instance was deleted.");const g=Vd(p.status,p.json);if(g)throw g;if(!p.json)throw new Ln("internal","Response is not valid JSON object.");let y=p.json.data;if(typeof y>"u"&&(y=p.json.result),typeof y>"u")throw new Ln("internal","Response is missing data field.");return{data:ll(y)}}function sk(i,e,t,s){const a=i._url(e);return rk(i,a,t,s||{})}async function rk(i,e,t,s){var a;t=Pd(t);const l={data:t},c=await qS(i,s);c["Content-Type"]="application/json",c.Accept="text/event-stream";let f;try{f=await i.fetchImpl(e,{method:"POST",body:JSON.stringify(l),headers:c,signal:s?.signal})}catch(P){if(P instanceof Error&&P.name==="AbortError"){const q=new Ln("cancelled","Request was cancelled.");return{data:Promise.reject(q),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(q)}}}}}}const k=Vd(0,null);return{data:Promise.reject(k),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(k)}}}}}}let p,g;const y=new Promise((P,k)=>{p=P,g=k});(a=s?.signal)===null||a===void 0||a.addEventListener("abort",()=>{const P=new Ln("cancelled","Request was cancelled.");g(P)});const b=f.body.getReader(),S=ak(b,p,g,s?.signal);return{stream:{[Symbol.asyncIterator](){const P=S.getReader();return{async next(){const{value:k,done:q}=await P.read();return{value:k,done:q}},async return(){return await P.cancel(),{done:!0,value:void 0}}}}},data:y}}function ak(i,e,t,s){const a=(c,f)=>{const p=c.match(W4);if(!p)return;const g=p[1];try{const y=JSON.parse(g);if("result"in y){e(ll(y.result));return}if("message"in y){f.enqueue(ll(y.message));return}if("error"in y){const b=Vd(0,y);f.error(b),t(b);return}}catch(y){if(y instanceof Ln){f.error(y),t(y);return}}},l=new TextDecoder;return new ReadableStream({start(c){let f="";return p();async function p(){if(s?.aborted){const g=new Ln("cancelled","Request was cancelled");return c.error(g),t(g),Promise.resolve()}try{const{value:g,done:y}=await i.read();if(y){f.trim()&&a(f.trim(),c),c.close();return}if(s?.aborted){const S=new Ln("cancelled","Request was cancelled");c.error(S),t(S),await i.cancel();return}f+=l.decode(g,{stream:!0});const b=f.split(`
`);f=b.pop()||"";for(const S of b)S.trim()&&a(S.trim(),c);return p()}catch(g){const y=g instanceof Ln?g:Vd(0,null);c.error(y),t(y)}}},cancel(){return i.cancel()}})}const _b="@firebase/functions",yb="0.12.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ok="auth-internal",lk="app-check-internal",uk="messaging-internal";function ck(i){const e=(t,{instanceIdentifier:s})=>{const a=t.getProvider("app").getImmediate(),l=t.getProvider(ok),c=t.getProvider(uk),f=t.getProvider(lk);return new J4(a,l,c,f,s)};jr(new qs(H_,e,"PUBLIC").setMultipleInstances(!0)),hi(_b,yb,i),hi(_b,yb,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(i=$d(),e=xg){const s=rc(St(i),H_).getImmediate({identifier:e}),a=Vg("functions");return a&&dk(s,...a),s}function dk(i,e,t){Z4(St(i),e,t)}function Ef(i,e,t){return ek(St(i),e)}ck();function G_(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(i);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(i,s[a])&&(t[s[a]]=i[s[a]]);return t}function HS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const fk=HS,GS=new sc("auth","Firebase",HS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld=new Qd("@firebase/auth");function mk(i,...e){Ld.logLevel<=Ge.WARN&&Ld.warn(`Auth (${za}): ${i}`,...e)}function ad(i,...e){Ld.logLevel<=Ge.ERROR&&Ld.error(`Auth (${za}): ${i}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(i,...e){throw K_(i,...e)}function ts(i,...e){return K_(i,...e)}function KS(i,e,t){const s=Object.assign(Object.assign({},fk()),{[e]:t});return new sc("auth","Firebase",s).create(e,{appName:i.name})}function zs(i){return KS(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function K_(i,...e){if(typeof i!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=i.name),i._errorFactory.create(t,...s)}return GS.create(i,...e)}function Ie(i,e,...t){if(!i)throw K_(e,...t)}function Us(i){const e="INTERNAL ASSERTION FAILED: "+i;throw ad(e),new Error(e)}function Qs(i,e){i||Us(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ng(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.href)||""}function pk(){return vb()==="http:"||vb()==="https:"}function vb(){var i;return typeof self<"u"&&((i=self.location)===null||i===void 0?void 0:i.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pk()||vC()||"connection"in navigator)?navigator.onLine:!0}function _k(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qs(t>e,"Short delay should be less than long delay!"),this.isMobile=Ug()||Yb()}get(){return gk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(i,e){Qs(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Us("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Us("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Us("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Ek=new yc(3e4,6e4);function Wr(i,e){return i.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:i.tenantId}):e}async function Xr(i,e,t,s,a={}){return QS(i,a,async()=>{let l={},c={};s&&(e==="GET"?c=s:l={body:JSON.stringify(s)});const f=cl(Object.assign({key:i.config.apiKey},c)).slice(1),p=await i._getAdditionalHeaders();p["Content-Type"]="application/json",i.languageCode&&(p["X-Firebase-Locale"]=i.languageCode);const g=Object.assign({method:e,headers:p},l);return yC()||(g.referrerPolicy="no-referrer"),i.emulatorConfig&&$s(i.emulatorConfig.host)&&(g.credentials="include"),YS.fetch()(await $S(i,i.config.apiHost,t,f),g)})}async function QS(i,e,t){i._canInitEmulator=!1;const s=Object.assign(Object.assign({},yk),e);try{const a=new bk(i),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Xh(i,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const f=l.ok?c.errorMessage:c.error.message,[p,g]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xh(i,"credential-already-in-use",c);if(p==="EMAIL_EXISTS")throw Xh(i,"email-already-in-use",c);if(p==="USER_DISABLED")throw Xh(i,"user-disabled",c);const y=s[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw KS(i,y,g);Ii(i,y)}}catch(a){if(a instanceof ss)throw a;Ii(i,"network-request-failed",{message:String(a)})}}async function vc(i,e,t,s,a={}){const l=await Xr(i,e,t,s,a);return"mfaPendingCredential"in l&&Ii(i,"multi-factor-auth-required",{_serverResponse:l}),l}async function $S(i,e,t,s){const a=`${e}${t}?${s}`,l=i,c=l.config.emulator?Y_(i.config,a):`${i.config.apiScheme}://${a}`;return vk.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function Tk(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class bk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(ts(this.auth,"network-request-failed")),Ek.get())})}}function Xh(i,e,t){const s={appName:i.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=ts(i,e,s);return a.customData._tokenResponse=t,a}function Eb(i){return i!==void 0&&i.enterprise!==void 0}class wk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Tk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Sk(i,e){return Xr(i,"GET","/v2/recaptchaConfig",Wr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ak(i,e){return Xr(i,"POST","/v1/accounts:delete",e)}async function Ud(i,e){return Xr(i,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Rk(i,e=!1){const t=St(i),s=await t.getIdToken(e),a=Q_(s);Ie(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l?.sign_in_provider;return{claims:a,token:s,authTime:Hu(Gp(a.auth_time)),issuedAtTime:Hu(Gp(a.iat)),expirationTime:Hu(Gp(a.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Gp(i){return Number(i)*1e3}function Q_(i){const[e,t,s]=i.split(".");if(e===void 0||t===void 0||s===void 0)return ad("JWT malformed, contained fewer than 3 sections"),null;try{const a=hd(t);return a?JSON.parse(a):(ad("Failed to decode base64 JWT payload"),null)}catch(a){return ad("Caught error parsing JWT payload as JSON",a?.toString()),null}}function Tb(i){const e=Q_(i);return Ie(e,"internal-error"),Ie(typeof e.exp<"u","internal-error"),Ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tc(i,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof ss&&Ck(s)&&i.auth.currentUser===i&&await i.auth.signOut(),s}}function Ck({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hu(this.lastLoginAt),this.creationTime=Hu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jd(i){var e;const t=i.auth,s=await i.getIdToken(),a=await tc(i,Ud(t,{idToken:s}));Ie(a?.users.length,t,"internal-error");const l=a.users[0];i._notifyReloadListener(l);const c=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?WS(l.providerUserInfo):[],f=Nk(i.providerData,c),p=i.isAnonymous,g=!(i.email&&l.passwordHash)&&!f?.length,y=p?g:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new Dg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(i,b)}async function xk(i){const e=St(i);await jd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Nk(i,e){return[...i.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function WS(i){return i.map(e=>{var{providerId:t}=e,s=G_(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dk(i,e){const t=await QS(i,{},async()=>{const s=cl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=i.config,c=await $S(i,a,"/v1/token",`key=${l}`),f=await i._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:s};return i.emulatorConfig&&$s(i.emulatorConfig.host)&&(p.credentials="include"),YS.fetch()(c,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Ok(i,e){return Xr(i,"POST","/v2/accounts:revokeToken",Wr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ie(e.idToken,"internal-error"),Ie(typeof e.idToken<"u","internal-error"),Ie(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Tb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ie(e.length!==0,"internal-error");const t=Tb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await Dk(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,c=new Xo;return s&&(Ie(typeof s=="string","internal-error",{appName:e}),c.refreshToken=s),a&&(Ie(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Ie(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xo,this.toJSON())}_performRefresh(){return Us("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(i,e){Ie(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class Ai{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=G_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ik(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Dg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await tc(this,this.stsTokenManager.getToken(this.auth,e));return Ie(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Rk(this,e)}reload(){return xk(this)}_assign(e){this!==e&&(Ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ai(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await jd(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pn(this.auth.app))return Promise.reject(zs(this.auth));const e=await this.getIdToken();return await tc(this,Ak(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,c,f,p,g,y;const b=(s=t.displayName)!==null&&s!==void 0?s:void 0,S=(a=t.email)!==null&&a!==void 0?a:void 0,P=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,k=(c=t.photoURL)!==null&&c!==void 0?c:void 0,q=(f=t.tenantId)!==null&&f!==void 0?f:void 0,K=(p=t._redirectEventId)!==null&&p!==void 0?p:void 0,pe=(g=t.createdAt)!==null&&g!==void 0?g:void 0,ae=(y=t.lastLoginAt)!==null&&y!==void 0?y:void 0,{uid:ce,emailVerified:Te,isAnonymous:be,providerData:Re,stsTokenManager:M}=t;Ie(ce&&M,e,"internal-error");const R=Xo.fromJSON(this.name,M);Ie(typeof ce=="string",e,"internal-error"),Cr(b,e.name),Cr(S,e.name),Ie(typeof Te=="boolean",e,"internal-error"),Ie(typeof be=="boolean",e,"internal-error"),Cr(P,e.name),Cr(k,e.name),Cr(q,e.name),Cr(K,e.name),Cr(pe,e.name),Cr(ae,e.name);const I=new Ai({uid:ce,auth:e,email:S,emailVerified:Te,displayName:b,isAnonymous:be,photoURL:k,phoneNumber:P,tenantId:q,stsTokenManager:R,createdAt:pe,lastLoginAt:ae});return Re&&Array.isArray(Re)&&(I.providerData=Re.map(D=>Object.assign({},D))),K&&(I._redirectEventId=K),I}static async _fromIdTokenResponse(e,t,s=!1){const a=new Xo;a.updateFromServerResponse(t);const l=new Ai({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await jd(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];Ie(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?WS(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!l?.length,f=new Xo;f.updateFromIdToken(s);const p=new Ai({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:c}),g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Dg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(p,g),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb=new Map;function js(i){Qs(i instanceof Function,"Expected a class definition");let e=bb.get(i);return e?(Qs(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,bb.set(i,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XS.type="NONE";const wb=XS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function od(i,e,t){return`firebase:${i}:${e}:${t}`}class Jo{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=od(this.userKey,a.apiKey,l),this.fullPersistenceKey=od("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ud(this.auth,{idToken:e}).catch(()=>{});return t?Ai._fromGetAccountInfoResponse(this.auth,t,e):null}return Ai._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Jo(js(wb),e,s);const a=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let l=a[0]||js(wb);const c=od(s,e.config.apiKey,e.name);let f=null;for(const g of t)try{const y=await g._get(c);if(y){let b;if(typeof y=="string"){const S=await Ud(e,{idToken:y}).catch(()=>{});if(!S)break;b=await Ai._fromGetAccountInfoResponse(e,S,y)}else b=Ai._fromJSON(e,y);g!==l&&(f=b),l=g;break}}catch{}const p=a.filter(g=>g._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new Jo(l,e,s):(l=p[0],f&&await l._set(c,f.toJSON()),await Promise.all(t.map(async g=>{if(g!==l)try{await g._remove(c)}catch{}})),new Jo(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sb(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(tA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(JS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(iA(e))return"Blackberry";if(sA(e))return"Webos";if(ZS(e))return"Safari";if((e.includes("chrome/")||eA(e))&&!e.includes("edge/"))return"Chrome";if(nA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=i.match(t);if(s?.length===2)return s[1]}return"Other"}function JS(i=Sn()){return/firefox\//i.test(i)}function ZS(i=Sn()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function eA(i=Sn()){return/crios\//i.test(i)}function tA(i=Sn()){return/iemobile/i.test(i)}function nA(i=Sn()){return/android/i.test(i)}function iA(i=Sn()){return/blackberry/i.test(i)}function sA(i=Sn()){return/webos/i.test(i)}function $_(i=Sn()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function kk(i=Sn()){var e;return $_(i)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Mk(){return EC()&&document.documentMode===10}function rA(i=Sn()){return $_(i)||nA(i)||sA(i)||iA(i)||/windows phone/i.test(i)||tA(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(i,e=[]){let t;switch(i){case"Browser":t=Sb(Sn());break;case"Worker":t=`${Sb(Sn())}-${i}`;break;default:t=i}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${za}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((c,f)=>{try{const p=e(l);c(p)}catch(p){f(p)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vk(i,e={}){return Xr(i,"GET","/v2/passwordPolicy",Wr(i,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lk=6;class Uk{constructor(e){var t,s,a,l;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:Lk,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,c,f;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(t=p.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),p.isValid&&(p.isValid=(s=p.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),p.isValid&&(p.isValid=(a=p.containsLowercaseLetter)!==null&&a!==void 0?a:!0),p.isValid&&(p.isValid=(l=p.containsUppercaseLetter)!==null&&l!==void 0?l:!0),p.isValid&&(p.isValid=(c=p.containsNumericCharacter)!==null&&c!==void 0?c:!0),p.isValid&&(p.isValid=(f=p.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),p}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ab(this),this.idTokenSubscription=new Ab(this),this.beforeStateQueue=new Pk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=GS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=js(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await Jo.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ud(this,{idToken:e}),s=await Ai._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Pn(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a?._redirectEventId,p=await this.tryRedirectSignIn(e);(!c||c===f)&&p?.user&&(a=p.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(c){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await jd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_k()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Pn(this.app))return Promise.reject(zs(this));const t=e?St(e):null;return t&&Ie(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Pn(this.app)?Promise.reject(zs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Pn(this.app)?Promise.reject(zs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(js(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Vk(this),t=new Uk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new sc("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await Ok(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&js(e)||this._popupRedirectResolver;Ie(t,this,"argument-error"),this.redirectPersistenceManager=await Jo.create(this,[js(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ie(f,this,"internal-error"),f.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,s,a);return()=>{c=!0,p()}}else{const p=e.addObserver(t);return()=>{c=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=aA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(Pn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&mk(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Qa(i){return St(i)}class Ab{constructor(e){this.auth=e,this.observer=null,this.addObserver=DC(t=>this.observer=t)}get next(){return Ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Bk(i){Tf=i}function oA(i){return Tf.loadJS(i)}function Fk(){return Tf.recaptchaEnterpriseScript}function zk(){return Tf.gapiScript}function qk(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class Hk{constructor(){this.enterprise=new Gk}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Gk{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Kk="recaptcha-enterprise",lA="NO_RECAPTCHA";class Yk{constructor(e){this.type=Kk,this.auth=Qa(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,f)=>{Sk(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const g=new wk(p);return l.tenantId==null?l._agentRecaptchaConfig=g:l._tenantRecaptchaConfigs[l.tenantId]=g,c(g.siteKey)}}).catch(p=>{f(p)})})}function a(l,c,f){const p=window.grecaptcha;Eb(p)?p.enterprise.ready(()=>{p.enterprise.execute(l,{action:e}).then(g=>{c(g)}).catch(()=>{c(lA)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Hk().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{s(this.auth).then(f=>{if(!t&&Eb(window.grecaptcha))a(f,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let p=Fk();p.length!==0&&(p+=f),oA(p).then(()=>{a(f,l,c)}).catch(g=>{c(g)})}}).catch(f=>{c(f)})})}}async function Rb(i,e,t,s=!1,a=!1){const l=new Yk(i);let c;if(a)c=lA;else try{c=await l.verify(t)}catch{c=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,g=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:g,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:c}):Object.assign(f,{captchaResponse:c}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Og(i,e,t,s,a){var l;if(!((l=i._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Rb(i,e,t,t==="getOobCode");return s(i,c)}else return s(i,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Rb(i,e,t,t==="getOobCode");return s(i,f)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qk(i,e){const t=rc(i,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Ur(l,e??{}))return a;Ii(a,"already-initialized")}return t.initialize({options:e})}function $k(i,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(js);e?.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(s,e?.popupRedirectResolver)}function Wk(i,e,t){const s=Qa(i);Ie(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=uA(e),{host:c,port:f}=Xk(e),p=f===null?"":`:${f}`,g={url:`${l}//${c}${p}/`},y=Object.freeze({host:c,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){Ie(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Ie(Ur(g,s.config.emulator)&&Ur(y,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=g,s.emulatorConfig=y,s.settings.appVerificationDisabledForTesting=!0,$s(c)?(Gd(`${l}//${c}${p}`),Kd("Auth",!0)):Jk()}function uA(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function Xk(i){const e=uA(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:Cb(s.substr(l.length+1))}}else{const[l,c]=s.split(":");return{host:l,port:Cb(c)}}}function Cb(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function Jk(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Us("not implemented")}_getIdTokenResponse(e){return Us("not implemented")}_linkToIdToken(e,t){return Us("not implemented")}_getReauthenticationResolver(e){return Us("not implemented")}}async function Zk(i,e){return Xr(i,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eM(i,e){return vc(i,"POST","/v1/accounts:signInWithPassword",Wr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tM(i,e){return vc(i,"POST","/v1/accounts:signInWithEmailLink",Wr(i,e))}async function nM(i,e){return vc(i,"POST","/v1/accounts:signInWithEmailLink",Wr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc extends W_{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new nc(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new nc(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Og(e,t,"signInWithPassword",eM);case"emailLink":return tM(e,{email:this._email,oobCode:this._password});default:Ii(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Og(e,s,"signUpPassword",Zk);case"emailLink":return nM(e,{idToken:t,email:this._email,oobCode:this._password});default:Ii(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zo(i,e){return vc(i,"POST","/v1/accounts:signInWithIdp",Wr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iM="http://localhost";class Ba extends W_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ba(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ii("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=G_(t,["providerId","signInMethod"]);if(!s||!a)return null;const c=new Ba(s,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Zo(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Zo(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Zo(e,t)}buildRequest(){const e={requestUri:iM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=cl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sM(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function rM(i){const e=Iu(xu(i)).link,t=e?Iu(xu(e)).deep_link_id:null,s=Iu(xu(i)).deep_link_id;return(s?Iu(xu(s)).link:null)||s||t||e||i}class X_{constructor(e){var t,s,a,l,c,f;const p=Iu(xu(e)),g=(t=p.apiKey)!==null&&t!==void 0?t:null,y=(s=p.oobCode)!==null&&s!==void 0?s:null,b=sM((a=p.mode)!==null&&a!==void 0?a:null);Ie(g&&y&&b,"argument-error"),this.apiKey=g,this.operation=b,this.code=y,this.continueUrl=(l=p.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(c=p.lang)!==null&&c!==void 0?c:null,this.tenantId=(f=p.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=rM(e);try{return new X_(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(){this.providerId=yl.PROVIDER_ID}static credential(e,t){return nc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=X_.parseLink(t);return Ie(s,"argument-error"),nc._fromEmailAndCode(e,s.code,s.tenantId)}}yl.PROVIDER_ID="password";yl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";yl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec extends cA{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir extends Ec{constructor(){super("facebook.com")}static credential(e){return Ba._fromParams({providerId:Ir.PROVIDER_ID,signInMethod:Ir.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ir.credentialFromTaggedObject(e)}static credentialFromError(e){return Ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ir.credential(e.oauthAccessToken)}catch{return null}}}Ir.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ir.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr extends Ec{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ba._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return xr.credential(t,s)}catch{return null}}}xr.GOOGLE_SIGN_IN_METHOD="google.com";xr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr extends Ec{constructor(){super("github.com")}static credential(e){return Ba._fromParams({providerId:Nr.PROVIDER_ID,signInMethod:Nr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Nr.credentialFromTaggedObject(e)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Nr.credential(e.oauthAccessToken)}catch{return null}}}Nr.GITHUB_SIGN_IN_METHOD="github.com";Nr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends Ec{constructor(){super("twitter.com")}static credential(e,t){return Ba._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Dr.credential(t,s)}catch{return null}}}Dr.TWITTER_SIGN_IN_METHOD="twitter.com";Dr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aM(i,e){return vc(i,"POST","/v1/accounts:signUp",Wr(i,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await Ai._fromIdTokenResponse(e,s,a),c=Ib(s);return new Fa({user:l,providerId:c,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Ib(s);return new Fa({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Ib(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd extends ss{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Bd.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Bd(e,t,s,a)}}function hA(i,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Bd._fromErrorAndOperation(i,l,e,s):l})}async function oM(i,e,t=!1){const s=await tc(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return Fa._forOperation(i,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lM(i,e,t=!1){const{auth:s}=i;if(Pn(s.app))return Promise.reject(zs(s));const a="reauthenticate";try{const l=await tc(i,hA(s,a,e,i),t);Ie(l.idToken,s,"internal-error");const c=Q_(l.idToken);Ie(c,s,"internal-error");const{sub:f}=c;return Ie(i.uid===f,s,"user-mismatch"),Fa._forOperation(i,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Ii(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dA(i,e,t=!1){if(Pn(i.app))return Promise.reject(zs(i));const s="signIn",a=await hA(i,s,e),l=await Fa._fromIdTokenResponse(i,s,a);return t||await i._updateCurrentUser(l.user),l}async function uM(i,e){return dA(Qa(i),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fA(i){const e=Qa(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function cM(i,e,t){if(Pn(i.app))return Promise.reject(zs(i));const s=Qa(i),c=await Og(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aM).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&fA(i),p}),f=await Fa._fromIdTokenResponse(s,"signIn",c);return await s._updateCurrentUser(f.user),f}function hM(i,e,t){return Pn(i.app)?Promise.reject(zs(i)):uM(St(i),yl.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&fA(i),s})}function dM(i,e,t,s){return St(i).onIdTokenChanged(e,t,s)}function fM(i,e,t){return St(i).beforeAuthStateChanged(e,t)}function mM(i,e,t,s){return St(i).onAuthStateChanged(e,t,s)}const Fd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Fd,"1"),this.storage.removeItem(Fd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pM=1e3,gM=10;class pA extends mA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,f,p)=>{this.notifyListeners(c,p)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(s);!t&&this.localCache[s]===c||this.notifyListeners(s,c)},l=this.storage.getItem(s);Mk()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,gM):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},pM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}pA.type="LOCAL";const _M=pA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA extends mA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}gA.type="SESSION";const _A=gA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yM(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new bf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!c?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(c).map(async g=>g(t.origin,l)),p=await yM(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}bf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(i="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return i+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((f,p)=>{const g=J_("",20);a.port1.start();const y=setTimeout(()=>{p(new Error("unsupported_event"))},s);c={messageChannel:a,onMessage(b){const S=b;if(S.data.eventId===g)switch(S.data.status){case"ack":clearTimeout(y),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(S.data.response);break;default:clearTimeout(y),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(){return window}function EM(i){ns().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(){return typeof ns().WorkerGlobalScope<"u"&&typeof ns().importScripts=="function"}async function TM(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function bM(){var i;return((i=navigator?.serviceWorker)===null||i===void 0?void 0:i.controller)||null}function wM(){return yA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA="firebaseLocalStorageDb",SM=1,zd="firebaseLocalStorage",EA="fbase_key";class Tc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function wf(i,e){return i.transaction([zd],e?"readwrite":"readonly").objectStore(zd)}function AM(){const i=indexedDB.deleteDatabase(vA);return new Tc(i).toPromise()}function kg(){const i=indexedDB.open(vA,SM);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const s=i.result;try{s.createObjectStore(zd,{keyPath:EA})}catch(a){t(a)}}),i.addEventListener("success",async()=>{const s=i.result;s.objectStoreNames.contains(zd)?e(s):(s.close(),await AM(),e(await kg()))})})}async function xb(i,e,t){const s=wf(i,!0).put({[EA]:e,value:t});return new Tc(s).toPromise()}async function RM(i,e){const t=wf(i,!1).get(e),s=await new Tc(t).toPromise();return s===void 0?null:s.value}function Nb(i,e){const t=wf(i,!0).delete(e);return new Tc(t).toPromise()}const CM=800,IM=3;class TA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>IM)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return yA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=bf._getInstance(wM()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await TM(),!this.activeServiceWorker)return;this.sender=new vM(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||bM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kg();return await xb(e,Fd,"1"),await Nb(e,Fd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>xb(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>RM(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Nb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=wf(a,!1).getAll();return new Tc(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),CM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}TA.type="LOCAL";const xM=TA;new yc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NM(i,e){return e?js(e):(Ie(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_ extends W_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Zo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Zo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Zo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function DM(i){return dA(i.auth,new Z_(i),i.bypassAuthState)}function OM(i){const{auth:e,user:t}=i;return Ie(t,e,"internal-error"),lM(t,new Z_(i),i.bypassAuthState)}async function kM(i){const{auth:e,user:t}=i;return Ie(t,e,"internal-error"),oM(t,new Z_(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:c,type:f}=e;if(c){this.reject(c);return}const p={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return DM;case"linkViaPopup":case"linkViaRedirect":return kM;case"reauthViaPopup":case"reauthViaRedirect":return OM;default:Ii(this.auth,"internal-error")}}resolve(e){Qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM=new yc(2e3,1e4);class Yo extends bA{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,Yo.currentPopupAction&&Yo.currentPopupAction.cancel(),Yo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ie(e,this.auth,"internal-error"),e}async onExecution(){Qs(this.filter.length===1,"Popup operations only handle one event");const e=J_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ts(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ts(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Yo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ts(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,MM.get())};e()}}Yo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM="pendingRedirect",ld=new Map;class VM extends bA{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=ld.get(this.auth._key());if(!e){try{const s=await LM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}ld.set(this.auth._key(),e)}return this.bypassAuthState||ld.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function LM(i,e){const t=BM(e),s=jM(i);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function UM(i,e){ld.set(i._key(),e)}function jM(i){return js(i._redirectPersistence)}function BM(i){return od(PM,i.config.apiKey,i.name)}async function FM(i,e,t=!1){if(Pn(i.app))return Promise.reject(zs(i));const s=Qa(i),a=NM(s,e),c=await new VM(s,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await s._persistUserIfCurrent(c.user),await s._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM=10*60*1e3;class qM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HM(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!wA(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(ts(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zM&&this.cachedEventUids.clear(),this.cachedEventUids.has(Db(e))}saveEventToCache(e){this.cachedEventUids.add(Db(e)),this.lastProcessedEventTime=Date.now()}}function Db(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function wA({type:i,error:e}){return i==="unknown"&&e?.code==="auth/no-auth-event"}function HM(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wA(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GM(i,e={}){return Xr(i,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,YM=/^https?/;async function QM(i){if(i.config.emulator)return;const{authorizedDomains:e}=await GM(i);for(const t of e)try{if($M(t))return}catch{}Ii(i,"unauthorized-domain")}function $M(i){const e=Ng(),{protocol:t,hostname:s}=new URL(e);if(i.startsWith("chrome-extension://")){const c=new URL(i);return c.hostname===""&&s===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===s}if(!YM.test(t))return!1;if(KM.test(i))return s===i;const a=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WM=new yc(3e4,6e4);function Ob(){const i=ns().___jsl;if(i?.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function XM(i){return new Promise((e,t)=>{var s,a,l;function c(){Ob(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ob(),t(ts(i,"network-request-failed"))},timeout:WM.get()})}if(!((a=(s=ns().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=ns().gapi)===null||l===void 0)&&l.load)c();else{const f=qk("iframefcb");return ns()[f]=()=>{gapi.load?c():t(ts(i,"network-request-failed"))},oA(`${zk()}?onload=${f}`).catch(p=>t(p))}}).catch(e=>{throw ud=null,e})}let ud=null;function JM(i){return ud=ud||XM(i),ud}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZM=new yc(5e3,15e3),eP="__/auth/iframe",tP="emulator/auth/iframe",nP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sP(i){const e=i.config;Ie(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?Y_(e,tP):`https://${i.config.authDomain}/${eP}`,s={apiKey:e.apiKey,appName:i.name,v:za},a=iP.get(i.config.apiHost);a&&(s.eid=a);const l=i._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${cl(s).slice(1)}`}async function rP(i){const e=await JM(i),t=ns().gapi;return Ie(t,i,"internal-error"),e.open({where:document.body,url:sP(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nP,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const c=ts(i,"network-request-failed"),f=ns().setTimeout(()=>{l(c)},ZM.get());function p(){ns().clearTimeout(f),a(s)}s.ping(p).then(p,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},oP=500,lP=600,uP="_blank",cP="http://localhost";class kb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hP(i,e,t,s=oP,a=lP){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const p=Object.assign(Object.assign({},aP),{width:s.toString(),height:a.toString(),top:l,left:c}),g=Sn().toLowerCase();t&&(f=eA(g)?uP:t),JS(g)&&(e=e||cP,p.scrollbars="yes");const y=Object.entries(p).reduce((S,[P,k])=>`${S}${P}=${k},`,"");if(kk(g)&&f!=="_self")return dP(e||"",f),new kb(null);const b=window.open(e||"",f,y);Ie(b,i,"popup-blocked");try{b.focus()}catch{}return new kb(b)}function dP(i,e){const t=document.createElement("a");t.href=i,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fP="__/auth/handler",mP="emulator/auth/handler",pP=encodeURIComponent("fac");async function Mb(i,e,t,s,a,l){Ie(i.config.authDomain,i,"auth-domain-config-required"),Ie(i.config.apiKey,i,"invalid-api-key");const c={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:s,v:za,eventId:a};if(e instanceof cA){e.setDefaultLanguage(i.languageCode),c.providerId=e.providerId||"",Yp(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[y,b]of Object.entries({}))c[y]=b}if(e instanceof Ec){const y=e.getScopes().filter(b=>b!=="");y.length>0&&(c.scopes=y.join(","))}i.tenantId&&(c.tid=i.tenantId);const f=c;for(const y of Object.keys(f))f[y]===void 0&&delete f[y];const p=await i._getAppCheckToken(),g=p?`#${pP}=${encodeURIComponent(p)}`:"";return`${gP(i)}?${cl(f).slice(1)}${g}`}function gP({config:i}){return i.emulator?Y_(i,mP):`https://${i.authDomain}/${fP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp="webStorageSupport";class _P{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_A,this._completeRedirectFn=FM,this._overrideRedirectResult=UM}async _openPopup(e,t,s,a){var l;Qs((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const c=await Mb(e,t,s,Ng(),a);return hP(e,c,J_())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await Mb(e,t,s,Ng(),a);return EM(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Qs(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await rP(e),s=new qM(e);return t.register("authEvent",a=>(Ie(a?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Kp,{type:Kp},a=>{var l;const c=(l=a?.[0])===null||l===void 0?void 0:l[Kp];c!==void 0&&t(!!c),Ii(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=QM(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rA()||ZS()||$_()}}const yP=_P;var Pb="@firebase/auth",Vb="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function TP(i){jr(new qs("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:f}=s.options;Ie(c&&!c.includes(":"),"invalid-api-key",{appName:s.name});const p={apiKey:c,authDomain:f,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:aA(i)},g=new jk(s,a,l,p);return $k(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),jr(new qs("auth-internal",e=>{const t=Qa(e.getProvider("auth").getImmediate());return(s=>new vP(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),hi(Pb,Vb,EP(i)),hi(Pb,Vb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bP=5*60,wP=Gb("authIdTokenMaxAge")||bP;let Lb=null;const SP=i=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>wP)return;const a=t?.token;Lb!==a&&(Lb=a,await fetch(i,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function AP(i=$d()){const e=rc(i,"auth");if(e.isInitialized())return e.getImmediate();const t=Qk(i,{popupRedirectResolver:yP,persistence:[xM,_M,_A]}),s=Gb("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const c=SP(l.toString());fM(t,c,()=>c(t.currentUser)),dM(t,f=>c(f))}}const a=qb("auth");return a&&Wk(t,`http://${a}`),t}function RP(){var i,e;return(e=(i=document.getElementsByTagName("head"))===null||i===void 0?void 0:i[0])!==null&&e!==void 0?e:document}Bk({loadJS(i){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",i),s.onload=e,s.onerror=a=>{const l=ts("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",RP().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});TP("Browser");const CP={apiKey:"AIzaSyD-EnuWkZgnjb6hnaP4LhUIZvxSCf5tiIo",authDomain:"game-of-trust-675c9.firebaseapp.com",projectId:"game-of-trust-675c9",storageBucket:"game-of-trust-675c9.firebasestorage.app",messagingSenderId:"72708199445",appId:"1:72708199445:web:ce23ac49a6c15fe7f02a1c",measurementId:"G-K3GSYXR89X"},Sf=Xb(CP);N2(Sf);const bi=I4(Sf),ic=AP(Sf),Af=hk(Sf,"us-central1"),IP=({onAuthSuccess:i})=>{const[e,t]=Se.useState(!0),[s,a]=Se.useState(""),[l,c]=Se.useState(""),[f,p]=Se.useState(""),[g,y]=Se.useState(!1),[b,S]=Se.useState(""),P=async k=>{k.preventDefault(),y(!0),S("");try{if(e){const q=await hM(ic,s,l);i(q.user.uid)}else{if(!f.trim()){S("Username is required for registration");return}const q=await cM(ic,s,l);await H4(Ki(bi,"usernames",q.user.uid),{username:f.trim(),createdAt:new Date().toISOString()}),i(q.user.uid)}}catch(q){S(q.message||"An error occurred")}finally{y(!1)}};return T.jsxs("div",{className:"max-w-md mx-auto mt-8 p-8 bg-gradient-to-br from-slate-900/95 via-slate-800/95 to-slate-900/95 rounded-3xl shadow-2xl border-2 border-slate-700/60 backdrop-blur-sm animate-fade-in hover:shadow-3xl hover:shadow-cyan-500/10 transition-all duration-500",children:[T.jsxs("div",{className:"text-center mb-8 animate-slide-in",children:[T.jsx("div",{className:"inline-block p-4 bg-gradient-to-r from-cyan-500/20 to-blue-500/20 rounded-full mb-4 border border-cyan-500/30 animate-pulse-glow",children:T.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center",children:T.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})}),T.jsx("h2",{className:"text-4xl font-bold text-transparent bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text mb-3",children:e?"Welcome Back":"Join the Battle"}),T.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:e?"Sign in to your account to continue your cellular warfare journey":"Create your account to start commanding cellular armies"})]}),T.jsxs("form",{onSubmit:P,className:"space-y-6",children:[T.jsxs("div",{className:"space-y-2",children:[T.jsxs("label",{htmlFor:"email",className:"text-sm font-semibold text-slate-300 flex items-center gap-2",children:[T.jsx("svg",{className:"w-4 h-4 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email Address"]}),T.jsx("input",{id:"email",type:"email",value:s,onChange:k=>a(k.target.value),required:!0,"aria-describedby":"email-hint",className:"w-full px-4 py-3 bg-slate-800/80 border border-slate-600/60 rounded-xl focus:outline-none focus:ring-2 focus:ring-cyan-400/50 focus:border-cyan-400/50 text-white placeholder-slate-400 transition-all duration-300 backdrop-blur-sm shadow-inner hover:border-slate-500/80 focus:scale-[1.02] active:scale-[0.98]",placeholder:"Enter your email address"})]}),T.jsxs("div",{className:"space-y-2",children:[T.jsxs("label",{htmlFor:"password",className:"text-sm font-semibold text-slate-300 flex items-center gap-2",children:[T.jsx("svg",{className:"w-4 h-4 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Password"]}),T.jsx("input",{id:"password",type:"password",value:l,onChange:k=>c(k.target.value),required:!0,"aria-describedby":"password-hint",className:"w-full px-4 py-3 bg-slate-800/80 border border-slate-600/60 rounded-xl focus:outline-none focus:ring-2 focus:ring-cyan-400/50 focus:border-cyan-400/50 text-white placeholder-slate-400 transition-all duration-300 backdrop-blur-sm shadow-inner hover:border-slate-500/80 focus:scale-[1.02] active:scale-[0.98]",placeholder:"Enter your password"})]}),!e&&T.jsxs("div",{className:"space-y-2 animate-fade-in",children:[T.jsxs("label",{htmlFor:"username",className:"text-sm font-semibold text-slate-300 flex items-center gap-2",children:[T.jsx("svg",{className:"w-4 h-4 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Username"]}),T.jsx("input",{id:"username",type:"text",value:f,onChange:k=>p(k.target.value),required:!0,"aria-describedby":"username-hint",className:"w-full px-4 py-3 bg-slate-800/80 border border-slate-600/60 rounded-xl focus:outline-none focus:ring-2 focus:ring-cyan-400/50 focus:border-cyan-400/50 text-white placeholder-slate-400 transition-all duration-300 backdrop-blur-sm shadow-inner hover:border-slate-500/80 focus:scale-[1.02] active:scale-[0.98]",placeholder:"Choose a unique username"})]}),b&&T.jsx("div",{className:"bg-red-500/20 border border-red-500/50 rounded-xl p-4 backdrop-blur-sm animate-fade-in",role:"alert","aria-live":"polite",children:T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"w-6 h-6 bg-red-500/30 rounded-full flex items-center justify-center flex-shrink-0",children:T.jsx("svg",{className:"w-4 h-4 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),T.jsx("div",{className:"text-red-300 text-sm leading-relaxed",children:b})]})}),T.jsx("button",{type:"submit",disabled:g,"aria-label":e?"Sign in to your account":"Create new account",className:"w-full py-4 px-6 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 disabled:from-slate-600 disabled:to-slate-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 disabled:scale-100 shadow-lg shadow-cyan-500/25 hover:shadow-cyan-400/40 disabled:shadow-slate-500/25 disabled:cursor-not-allowed backdrop-blur-sm animate-float active:scale-95",children:g?T.jsxs("div",{className:"flex items-center justify-center gap-3",children:[T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),T.jsx("span",{children:e?"Signing in...":"Creating account..."})]}):T.jsxs("div",{className:"flex items-center justify-center gap-2",children:[T.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:e?"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1":"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),T.jsx("span",{children:e?"Sign In":"Create Account"})]})})]}),T.jsxs("div",{className:"mt-8 text-center",children:[T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"absolute inset-0 flex items-center",children:T.jsx("div",{className:"w-full border-t border-slate-600/50"})}),T.jsx("div",{className:"relative flex justify-center text-sm",children:T.jsx("span",{className:"px-4 bg-gradient-to-r from-slate-900/95 via-slate-800/95 to-slate-900/95 text-slate-400",children:e?"New to Conway's Battle?":"Already have an account?"})})]}),T.jsx("button",{type:"button",onClick:()=>t(!e),"aria-label":e?"Switch to create new account":"Switch to sign in",className:"mt-4 w-full py-3 px-6 bg-slate-800/80 hover:bg-slate-700/90 text-slate-300 hover:text-white font-semibold rounded-xl transition-all duration-300 border border-slate-600/60 hover:border-slate-500/80 backdrop-blur-sm transform hover:scale-105 active:scale-95 shadow-lg",children:T.jsxs("div",{className:"flex items-center justify-center gap-2",children:[T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})}),T.jsx("span",{children:e?"Create New Account":"Sign In Instead"})]})})]})]})},qd=async i=>{try{const e=await q4(Ki(bi,"usernames",i));return e.exists()?e.data().username:null}catch(e){return console.error("Error fetching username:",e),null}},xP=({grid:i,gridSize:e=60,showAnimatedNumbers:t=!1})=>{const s=Se.useMemo(()=>{let c=0,f=0;for(let p=0;p<e;p++){const g=i[`row${p}`];if(g)for(let y=0;y<e;y++){const b=g[y];b===1?c++:b===2&&f++}}return{player1:c,player2:f,total:c+f}},[i,e]),a=Se.useMemo(()=>{const{player1:c,player2:f,total:p}=s;return p===0?{player1:0,player2:0}:{player1:c/p*100,player2:f/p*100}},[s]),l=Se.useMemo(()=>{const{player1:c,player2:f}=s;return c>f?1:f>c?2:0},[s]);return T.jsxs("div",{className:"w-full max-w-md mx-auto bg-slate-800/90 backdrop-blur-sm rounded-lg border border-slate-700/50 p-4 shadow-lg",children:[T.jsxs("div",{className:"flex items-center justify-between mb-3",children:[T.jsx("h3",{className:"text-slate-200 font-semibold text-sm",children:"Cell Count"}),T.jsxs("div",{className:"text-xs text-slate-400",children:["Total: ",s.total]})]}),T.jsxs("div",{className:"relative h-6 bg-slate-700/50 rounded-full overflow-hidden border border-slate-600/30",children:[T.jsx("div",{className:"absolute left-0 top-0 h-full bg-gradient-to-r from-blue-500 to-blue-600 transition-all duration-300 ease-out",style:{width:`${a.player1}%`}}),T.jsx("div",{className:"absolute right-0 top-0 h-full bg-gradient-to-l from-red-500 to-red-600 transition-all duration-300 ease-out",style:{width:`${a.player2}%`}}),T.jsx("div",{className:"absolute left-1/2 top-0 h-full w-px bg-slate-600/50 transform -translate-x-1/2"})]}),T.jsxs("div",{className:"flex items-center justify-between mt-3 text-sm",children:[T.jsxs("div",{className:"flex items-center space-x-2",children:[T.jsx("div",{className:"w-3 h-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full border border-blue-400/50"}),T.jsx("span",{className:`font-medium transition-colors duration-200 ${l===1?"text-blue-200":"text-slate-400"}`,children:t?T.jsx(Ub,{value:s.player1}):s.player1}),T.jsxs("span",{className:"text-xs text-slate-500",children:["(",a.player1.toFixed(1),"%)"]})]}),T.jsx("div",{className:"text-xs text-slate-500 font-medium",children:"VS"}),T.jsxs("div",{className:"flex items-center space-x-2",children:[T.jsxs("span",{className:"text-xs text-slate-500",children:["(",a.player2.toFixed(1),"%)"]}),T.jsx("span",{className:`font-medium transition-colors duration-200 ${l===2?"text-red-200":"text-slate-400"}`,children:t?T.jsx(Ub,{value:s.player2}):s.player2}),T.jsx("div",{className:"w-3 h-3 bg-gradient-to-br from-red-500 to-red-600 rounded-full border border-red-400/50"})]})]}),T.jsx("div",{className:"mt-2 text-center",children:T.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium transition-all duration-300 ${l===1?"bg-blue-500/20 text-blue-200 border border-blue-500/30":l===2?"bg-red-500/20 text-red-200 border border-red-500/30":"bg-slate-500/20 text-slate-300 border border-slate-500/30"}`,children:l===1?"Blue Leading":l===2?"Red Leading":"Tied"})})]})},Ub=({value:i})=>{const[e,t]=mE.useState(i);return mE.useEffect(()=>{const a=e,l=i,c=Date.now(),f=()=>{const p=Date.now()-c,g=Math.min(p/200,1),y=1-Math.pow(1-g,3),b=Math.round(a+(l-a)*y);t(b),g<1&&requestAnimationFrame(f)};f()},[i,e]),T.jsx("span",{children:e})},yn=18,SA=({game:i,currentUser:e,onCellClick:t,onAnimationComplete:s,gridSize:a=60,onShapeDrop:l,selectedShape:c,onShapePlace:f,onClearSelectedShape:p,onClearPlayerCells:g,onToggleReadyForFight:y})=>{const[b,S]=Se.useState(null),[P,k]=Se.useState(0),[q,K]=Se.useState(!1),pe=Se.useRef(!1),[ae,ce]=Se.useState([]),[Te,be]=Se.useState(null),[Re,M]=Se.useState(null),[R,I]=Se.useState(0),[D,V]=Se.useState(!1),[L,x]=Se.useState([]),[ue,oe]=Se.useState(!1),[z,te]=Se.useState(null),Z=Se.useMemo(()=>e?i.user1?.uid===e.uid?1:i.user2?.uid===e.uid?2:0:0,[e,i.user1?.uid,i.user2?.uid]),fe=Se.useMemo(()=>!D&&!q&&(i.state==="waiting"||i.state==="started"),[D,q,i.state]),N=Se.useCallback((ie,me)=>{if(!c||!Te)return!1;const ge=ie-Te.row,Ee=me-Te.col;return ge<0||ge>=c.pattern.length||Ee<0||Ee>=c.pattern[ge].length||!(c.pattern[ge][Ee]===1)?!1:Z===1&&ie<yn||Z===2&&ie>=a-yn},[c,Te,Z,a]);Se.useEffect(()=>{const ie=()=>{pe.current=!0},me=()=>{pe.current=!1},ge=Ee=>{Ee.key==="Escape"&&c&&(Ee.preventDefault(),be(null),p&&p())};return window.addEventListener("mousedown",ie),window.addEventListener("mouseup",me),window.addEventListener("dragend",me),window.addEventListener("keydown",ge),()=>{window.removeEventListener("mousedown",ie),window.removeEventListener("mouseup",me),window.removeEventListener("dragend",me),window.removeEventListener("keydown",ge)}},[c,p]);const X=ie=>{const me={};for(let ge=0;ge<a;ge++){me[`row${ge}`]=[];for(let Ee=0;Ee<a;Ee++){const Fe=Ne(ie,ge,Ee),ze=ie[`row${ge}`]?.[Ee]||0;if(ze>0)me[`row${ge}`][Ee]=Fe===2||Fe===3?ze:0;else if(Fe===3){const Ve=Mt(ie,ge,Ee);Ve.player1>Ve.player2?me[`row${ge}`][Ee]=1:Ve.player2>Ve.player1?me[`row${ge}`][Ee]=2:me[`row${ge}`][Ee]=Math.random()>.5?1:2}else me[`row${ge}`][Ee]=0}}return me},re=(ie,me)=>{for(let ge=0;ge<a;ge++){const Ee=`row${ge}`,Fe=ie[Ee]||[],ze=me[Ee]||[];if(Fe.length!==ze.length)return!1;for(let Ve=0;Ve<a;Ve++)if((Fe[Ve]||0)!==(ze[Ve]||0))return!1}return!0},ne=ie=>ae.length===0?!1:!!(re(ie,ae[ae.length-1])||ae.length>=2&&re(ie,ae[ae.length-2])),ye=Se.useCallback((ie,me)=>{let ge;D&&Re?ge=Re:q&&b||(i.state==="fighting"||i.state==="finished")&&!q&&i.winner&&b?ge=b:ge=i.grid;const Ee=ge[`row${ie}`];return Ee&&Ee[me]||0},[D,Re,q,b,i.grid,i.state,i.winner]),Oe=Se.useMemo(()=>(i.state==="fighting"||i.state==="finished")&&!q&&i.winner,[i.state,i.winner,q]),Ne=(ie,me,ge)=>{let Ee=0;for(let Fe=-1;Fe<=1;Fe++)for(let ze=-1;ze<=1;ze++){if(Fe===0&&ze===0)continue;const Ve=(me+Fe+a)%a,zt=(ge+ze+a)%a;(ie[`row${Ve}`]?.[zt]||0)>0&&Ee++}return Ee},Mt=(ie,me,ge)=>{let Ee=0,Fe=0;for(let ze=-1;ze<=1;ze++)for(let Ve=-1;Ve<=1;Ve++){if(ze===0&&Ve===0)continue;const zt=(me+ze+a)%a,xt=(ge+Ve+a)%a,rn=ie[`row${zt}`]?.[xt]||0;rn===1?Ee++:rn===2&&Fe++}return{player1:Ee,player2:Fe}};Se.useEffect(()=>{i.state==="fighting"&&!q&&P<10&&(K(!0),S(JSON.parse(JSON.stringify(i.grid))),k(0),ce([]))},[i.state,q,i.grid]),Se.useEffect(()=>{if(q&&b&&P<500){const ie=setTimeout(()=>{if(ne(b)){K(!1),s&&s();return}if($a(b)){K(!1),s&&s();return}const ge=X(b);ce(Ee=>[...Ee,JSON.parse(JSON.stringify(b))].slice(-2)),S(ge),k(Ee=>Ee+1)},50);return()=>clearTimeout(ie)}else q&&P>=500&&(K(!1),s&&s())},[q,b,P,s,ae]);const ot=()=>{const ie=JSON.parse(JSON.stringify(i.grid));V(!0),M(ie),te(ie),I(0),x([ie]),oe(!0)},Wn=()=>{V(!1),M(null),te(null),I(0),x([]),oe(!1)},xi=()=>{oe(!1)},mi=()=>{oe(!0)},rs=()=>{z&&(M(JSON.parse(JSON.stringify(z))),I(0),x([JSON.parse(JSON.stringify(z))]),oe(!1))},as=()=>{Re&&Xs()},os=()=>{if(L.length>1){const ie=[...L];ie.pop();const me=ie[ie.length-1];M(JSON.parse(JSON.stringify(me))),x(ie),I(Math.max(0,R-1)),oe(!1)}},Xs=()=>{if(!Re)return;if(R>=200){oe(!1);return}const ie=X(Re);x(me=>[...me,JSON.parse(JSON.stringify(Re))].slice(-200)),M(ie),I(me=>me+1)};Se.useEffect(()=>{if(D&&Re&&ue&&R<200){const ie=setTimeout(Xs,150);return()=>clearTimeout(ie)}},[D,Re,ue,R]);const ls=()=>Z===1?i.user1?.readyForFight||!1:Z===2&&i.user2?.readyForFight||!1,An=()=>(i.user1?.readyForFight||!1)&&(i.user2?.readyForFight||!1),vl=()=>{i.state!=="started"||!y||y()},Jr=()=>{!fe||!g||(c&&be(null),g())},Ni=(ie,me)=>{Z===0||!(Z===1&&ie<yn||Z===2&&ie>=a-yn)||(c&&f?f(c,ie,me):t(ie,me))},pi=(ie,me)=>{if(c&&fe){const ge=Z===1&&ie<yn||Z===2&&ie>=a-yn;be(ge?{row:ie,col:me}:null)}else be(null)},El=(ie,me,ge)=>{if(!(Z===0||!fe||!ie.pattern.every((Fe,ze)=>Fe.every((Ve,zt)=>{if(Ve===0)return!0;const xt=me+ze,rn=ge+zt;return xt<0||xt>=a||rn<0||rn>=a?!1:Z===1&&xt<yn||Z===2&&xt>=a-yn})))&&l){const Fe={...ie,pattern:ie.pattern.map((ze,Ve)=>ze.map(zt=>{if(zt===0)return 0;const xt=me+Ve;return Z===1&&xt<yn||Z===2&&xt>=a-yn?zt:0}))};l(Fe,me,ge)}},us=ie=>{ie.preventDefault(),ie.dataTransfer.dropEffect="copy"},Js=(ie,me,ge)=>{ie.preventDefault();try{const Ee=ie.dataTransfer.getData("shape");if(Ee){const Fe=JSON.parse(Ee);El(Fe,me,ge)}}catch(Ee){console.error("Error handling shape drop:",Ee)}},$a=ie=>{let me=0,ge=0;for(let Ee=0;Ee<a;Ee++){const Fe=ie[`row${Ee}`]||[];for(let ze=0;ze<a;ze++){const Ve=Fe[ze]||0;Ve===1?me++:Ve===2&&ge++}}return me===0&&ge===0?"tie":me===0?"player2":ge===0?"player1":null},Et=Se.useMemo(()=>{const ie=[];for(let me=0;me<a;me++)for(let ge=0;ge<a;ge++){const Ee=ye(me,ge),Fe=fe&&(Z===1&&me<yn||Z===2&&me>=a-yn);let ze="",Ve="border-slate-600/50",zt="";const xt=N(me,ge);Ee===1?(ze="bg-gradient-to-br from-blue-500 to-blue-600",Ve="border-blue-400/70",zt="shadow-sm shadow-blue-500/40"):Ee===2?(ze="bg-gradient-to-br from-red-500 to-red-600",Ve="border-red-400/70",zt="shadow-sm shadow-red-500/40"):xt?(ze=Z===1?"bg-gradient-to-br from-blue-400/50 to-blue-500/50 animate-pulse":"bg-gradient-to-br from-red-400/50 to-red-500/50 animate-pulse",Ve=Z===1?"border-blue-400/70":"border-red-400/70",zt="shadow-sm shadow-blue-400/30"):Fe?(ze="bg-slate-700/80 hover:bg-slate-600/90",Ve=Z===1?"border-blue-500/30 hover:border-blue-400/50":"border-red-500/30 hover:border-red-400/50"):(ze="bg-slate-800/60",Ve="border-slate-600/30");let rn="";Z===1&&me<yn?rn="ring-1 ring-blue-500/20":Z===2&&me>=a-yn&&(rn="ring-1 ring-red-500/20"),ie.push(T.jsx("div",{className:`aspect-square border ${Ve} ${ze} ${zt} ${rn}
                            transition-all duration-75 ease-in-out
                            ${Fe||c?"cursor-pointer hover:scale-105 active:scale-95 hover:z-10":"cursor-not-allowed"}`,onMouseEnter:()=>{pe.current&&Ni(me,ge),pi(me,ge)},onMouseMove:()=>pi(me,ge),onClick:()=>{Ni(me,ge)},onDragOver:us,onDrop:gi=>Js(gi,me,ge)},`${me}-${ge}`))}return ie},[a,ye,fe,Z,N,c,Ni,pi,us,Js]),Pe=Se.useMemo(()=>Z===1?{bg:"bg-gradient-to-br from-slate-900 via-slate-800 to-blue-900/20",border:"border-blue-500/40",text:"text-blue-200",textSecondary:"text-blue-300",button:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 shadow-lg shadow-blue-500/25",accent:"bg-gradient-to-r from-blue-500 to-blue-600",glow:"shadow-lg shadow-blue-500/20"}:Z===2?{bg:"bg-gradient-to-br from-slate-900 via-slate-800 to-red-900/20",border:"border-red-500/40",text:"text-red-200",textSecondary:"text-red-300",button:"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 shadow-lg shadow-red-500/25",accent:"bg-gradient-to-r from-red-500 to-red-600",glow:"shadow-lg shadow-red-500/20"}:{bg:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",border:"border-slate-500/40",text:"text-slate-200",textSecondary:"text-slate-300",button:"bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-500 hover:to-slate-600 shadow-lg shadow-slate-500/25",accent:"bg-gradient-to-r from-slate-500 to-slate-600",glow:"shadow-lg shadow-slate-500/20"},[Z]),Rn=({className:ie="w-4 h-4"})=>T.jsxs("svg",{className:ie,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[T.jsx("path",{d:"M3 6h18l-2 13H5L3 6zM8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),T.jsx("path",{d:"M10 11v6M14 11v6"})]}),$t=({className:ie="w-4 h-4"})=>T.jsxs("svg",{className:ie,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[T.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),T.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Wa=({className:ie="w-4 h-4"})=>T.jsx("svg",{className:ie,viewBox:"0 0 24 24",fill:"currentColor",children:T.jsx("path",{d:"M8 5v14l11-7z"})}),Tl=({className:ie="w-4 h-4"})=>T.jsx("svg",{className:ie,viewBox:"0 0 24 24",fill:"currentColor",children:T.jsx("path",{d:"M6 4h4v16H6V4zM14 4h4v16h-4V4z"})}),cs=({className:ie="w-4 h-4"})=>T.jsx("svg",{className:ie,viewBox:"0 0 24 24",fill:"currentColor",children:T.jsx("path",{d:"M19 20L9 12l10-8v16zM5 4v16h2V4H5z"})}),hs=({className:ie="w-4 h-4"})=>T.jsx("svg",{className:ie,viewBox:"0 0 24 24",fill:"currentColor",children:T.jsx("path",{d:"M5 4l10 8-10 8V4zM17 4v16h2V4h-2z"})}),ds=({className:ie="w-4 h-4"})=>T.jsxs("svg",{className:ie,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[T.jsx("path",{d:"M23 4v6h-6M1 20v-6h6"}),T.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]}),Un=({className:ie="w-4 h-4"})=>T.jsx("svg",{className:ie,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:T.jsx("path",{d:"M18 6L6 18M6 6l12 12"})}),Zs=({className:ie="w-4 h-4"})=>T.jsx("svg",{className:ie,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:T.jsx("path",{d:"M20 6L9 17l-5-5"})}),fs=({className:ie="w-4 h-4"})=>T.jsx("svg",{className:ie,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:T.jsx("circle",{cx:"12",cy:"12",r:"10"})});return T.jsxs("div",{className:"w-full h-full flex flex-col bg-slate-900/50 backdrop-blur-sm rounded-xl border border-slate-700/50 overflow-hidden",children:[T.jsx("header",{className:`${Pe.bg} ${Pe.border} border-b px-4 py-2 flex-shrink-0 backdrop-blur-sm`,children:T.jsxs("div",{className:"flex items-center justify-between gap-4",children:[T.jsxs("div",{className:`${Pe.button} text-white px-3 py-1.5 rounded-lg font-bold text-sm flex-shrink-0 shadow-md`,children:["Player ",Z]}),T.jsx("div",{className:"flex-1 max-w-md mx-4",children:T.jsx(xP,{grid:D&&Re||q&&b||i.grid||{},gridSize:a,showAnimatedNumbers:q})}),Z>0&&T.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[T.jsxs("button",{onClick:Jr,disabled:!fe,className:`${Pe.button} text-white px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 hover:opacity-90 disabled:opacity-40 disabled:cursor-not-allowed flex items-center gap-2`,title:"Clear board",children:[T.jsx(Rn,{}),T.jsx("span",{className:"hidden sm:inline",children:"Clear"})]}),i.state==="started"&&T.jsxs("button",{onClick:vl,className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 hover:opacity-90 flex items-center gap-2 ${ls()?"bg-green-600 hover:bg-green-500 text-white shadow-md":`${Pe.button} text-white`}`,title:ls()?"Ready for battle":"Mark as ready",children:[ls()?T.jsx(Zs,{}):T.jsx(fs,{}),T.jsx("span",{className:"hidden sm:inline",children:ls()?"Ready!":"Ready"})]}),T.jsx("div",{className:"flex items-center gap-1 bg-slate-800/50 rounded-lg p-1 border border-slate-600/30",children:D?T.jsxs(T.Fragment,{children:[T.jsx("button",{onClick:ue?xi:mi,className:`${Pe.button} text-white p-1.5 rounded-md transition-colors duration-200 hover:opacity-90`,title:ue?"Pause preview":"Resume preview",children:ue?T.jsx(Tl,{}):T.jsx(Wa,{})}),T.jsx("button",{onClick:os,disabled:L.length<=1,className:`${Pe.button} text-white p-1.5 rounded-md transition-colors duration-200 hover:opacity-90 disabled:opacity-40 disabled:cursor-not-allowed`,title:"Step backward",children:T.jsx(cs,{})}),T.jsx("button",{onClick:as,disabled:R>=200,className:`${Pe.button} text-white p-1.5 rounded-md transition-colors duration-200 hover:opacity-90 disabled:opacity-40 disabled:cursor-not-allowed`,title:"Step forward",children:T.jsx(hs,{})}),T.jsx("button",{onClick:rs,className:`${Pe.button} text-white p-1.5 rounded-md transition-colors duration-200 hover:opacity-90`,title:"Reset preview",children:T.jsx(ds,{})}),T.jsx("button",{onClick:Wn,className:"bg-red-600 hover:bg-red-500 text-white p-1.5 rounded-md transition-colors duration-200",title:"Stop preview",children:T.jsx(Un,{})})]}):T.jsxs("button",{onClick:ot,disabled:!fe,className:`${Pe.button} text-white px-3 py-1.5 rounded-md text-sm font-medium transition-colors duration-200 hover:opacity-90 disabled:opacity-40 disabled:cursor-not-allowed flex items-center gap-2`,title:"Start preview",children:[T.jsx($t,{}),T.jsx("span",{className:"hidden sm:inline",children:"Preview"})]})})]})]})}),T.jsxs("div",{className:"flex-shrink-0 px-2 sm:px-4 py-1",children:[i.state==="started"&&An()&&T.jsx("div",{className:"bg-gradient-to-r from-amber-800/80 to-amber-900/80 backdrop-blur-sm rounded-lg p-1.5 sm:p-2 border border-amber-500/40",children:T.jsxs("div",{className:"flex items-center justify-center gap-1 sm:gap-2",children:[T.jsx("div",{className:"animate-spin rounded-full h-2 w-2 sm:h-3 sm:w-3 border-2 border-amber-300 border-t-transparent"}),T.jsx("p",{className:"text-amber-200 text-xs font-semibold",children:"BATTLE STARTING..."})]})}),i.state==="started"&&!An()&&T.jsx("div",{className:"bg-gradient-to-r from-slate-800/80 to-slate-900/80 backdrop-blur-sm rounded-lg p-1.5 sm:p-2 border border-slate-600/40",children:T.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4",children:[T.jsx("p",{className:"text-slate-300 text-xs font-medium",children:"WAITING FOR PLAYERS"}),T.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[T.jsxs("div",{className:"flex items-center gap-1",children:[T.jsx("div",{className:`w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full ${i.user1?.readyForFight?"bg-green-500 animate-pulse":"bg-slate-600"}`}),T.jsx("span",{className:"text-xs text-slate-400",children:i.user1?.username||"P1"})]}),T.jsxs("div",{className:"flex items-center gap-1",children:[T.jsx("div",{className:`w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full ${i.user2?.readyForFight?"bg-green-500 animate-pulse":"bg-slate-600"}`}),T.jsx("span",{className:"text-xs text-slate-400",children:i.user2?.username||"P2"})]})]})]})}),fe&&c&&T.jsx("div",{className:"bg-gradient-to-r from-slate-800/80 to-slate-900/80 backdrop-blur-sm rounded-lg p-1.5 sm:p-2 border border-slate-600/40",children:T.jsxs("div",{className:"flex items-center justify-center gap-1 sm:gap-2",children:[T.jsx("div",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-blue-500 rounded-full animate-pulse"}),T.jsx("p",{className:"text-slate-300 text-xs font-medium",children:"SHAPE MODE - ESC to exit"})]})}),fe&&!c&&T.jsx("div",{className:"bg-gradient-to-r from-slate-800/80 to-slate-900/80 backdrop-blur-sm rounded-lg p-1.5 sm:p-2 border border-slate-600/40",children:T.jsxs("p",{className:"text-slate-300 text-xs text-center font-medium",children:["EDITABLE ROWS:"," ",T.jsx("span",{className:"font-mono text-slate-300",children:Z===1?`0-${yn-1}`:`${a-yn}-${a-1}`})]})}),Oe&&T.jsx("div",{className:"bg-gradient-to-r from-green-800/80 to-green-900/80 backdrop-blur-sm rounded-lg p-2 sm:p-3 border border-green-500/40",children:T.jsxs("div",{className:"text-center",children:[T.jsx("h3",{className:"text-sm sm:text-base font-bold text-green-300 mb-1",children:"🏆 BATTLE COMPLETE 🏆"}),i.winner==="tie"?T.jsx("p",{className:"text-green-200 text-xs sm:text-sm font-semibold",children:"DRAW"}):T.jsxs("p",{className:"text-green-200 text-xs sm:text-sm font-semibold",children:["PLAYER"," ",i.winner==="player1"?"1":"2"," WINS"]})]})}),i.state==="fighting"&&!q&&!i.winner&&T.jsx("div",{className:"bg-gradient-to-r from-slate-800/80 to-slate-900/80 backdrop-blur-sm rounded-lg p-1.5 sm:p-2 border border-slate-600/40",children:T.jsxs("div",{className:"flex items-center justify-center gap-1 sm:gap-2",children:[T.jsx("div",{className:"animate-spin rounded-full h-2 w-2 sm:h-3 sm:w-3 border-2 border-slate-300 border-t-transparent"}),T.jsx("p",{className:"text-slate-300 text-xs font-medium",children:"PROCESSING BATTLE..."})]})})]}),T.jsx("div",{className:"flex-1 flex items-center justify-center p-2 sm:p-4 min-h-0",children:T.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 sm:gap-4 h-full w-full",children:[T.jsx("div",{className:"flex-1 flex items-center justify-center w-full min-h-0",children:T.jsx("div",{className:"bg-slate-900/90 backdrop-blur-sm rounded-lg sm:rounded-xl border-2 border-slate-700/50 p-1 sm:p-2 shadow-2xl shadow-slate-900/50 transition-all duration-300",style:{height:"fit-content",maxHeight:"100%",width:"fit-content",maxWidth:"100%"},children:T.jsx("div",{className:"bg-slate-800/70 rounded-md sm:rounded-lg p-1 border border-slate-600/40 overflow-hidden",style:{width:"fit-content",height:"fit-content",boxShadow:"inset 0 0 20px rgba(0, 0, 0, 0.6)"},children:T.jsx("div",{className:"grid bg-slate-900/60 rounded-sm sm:rounded-md overflow-hidden",style:{gridTemplateColumns:`repeat(${a}, minmax(0, 1fr))`,width:"min(80vw, 60vh, 500px)",height:"min(80vw, 60vh, 500px)",gap:"0.5px",padding:"1px"},children:Et})})})}),T.jsx("div",{className:"flex-shrink-0 w-full max-w-sm sm:max-w-md",children:(q||D)&&T.jsxs("div",{className:"bg-slate-800/80 backdrop-blur-sm rounded-lg p-2 sm:p-3 border border-slate-600/40",children:[T.jsxs("div",{className:"flex items-center justify-between mb-1 sm:mb-2",children:[T.jsx("p",{className:"text-slate-300 text-xs sm:text-sm font-semibold",children:q?"SIMULATION":"PREVIEW"}),T.jsx("p",{className:"text-slate-300 text-xs sm:text-sm font-mono",children:q?`${P}/500`:`${R}/200`})]}),T.jsx("div",{className:"w-full h-1.5 sm:h-2 bg-slate-700 rounded-full overflow-hidden",children:T.jsx("div",{className:`h-full ${Pe.accent} transition-all duration-300 ease-out`,style:{width:`${q?P/500*100:R/200*100}%`}})})]})})]})})]})},NP=Ef(Af,"createGame"),DP=Ef(Af,"joinGame"),OP=Ef(Af,"startFightingPhase"),kP=Ef(Af,"scheduleGameTransition"),MP=async(i,e)=>{try{return(await NP({userId:i,username:e})).data}catch(t){throw console.error("Error calling createGame function:",t),new Error("Failed to create game. Please try again.")}},PP=async(i,e,t)=>{try{return(await DP({gameId:i,userId:e,username:t})).data}catch(s){throw console.error("Error calling joinGame function:",s),new Error("Failed to join game. Please check the game ID and try again.")}},VP=async i=>{try{return(await OP({gameId:i})).data}catch(e){throw console.error("Error calling startFightingPhase function:",e),new Error("Failed to start fighting phase. Please try again.")}},LP=async i=>{try{return(await kP({gameId:i})).data}catch(e){throw console.error("Error calling scheduleGameTransition function:",e),new Error("Failed to schedule game transition. Please try again.")}},UP=({playerNumber:i,onShapeSelect:e,selectedShape:t})=>{const[s,a]=Se.useState(0),l=[{id:"block",name:"Block",pattern:[[1,1],[1,1]],color:"#1e40af",description:"Still life - never changes",category:"Still Life"},{id:"blinker",name:"Blinker",pattern:[[1,1,1]],color:"#1e40af",description:"Oscillates between horizontal and vertical",category:"Oscillator"},{id:"glider",name:"Glider",pattern:[[0,1,0],[0,0,1],[1,1,1]],color:"#1e40af",description:"Moves diagonally across the board",category:"Spaceship"},{id:"lwss",name:"Lightweight Spaceship",pattern:[[0,1,1,1,1],[1,0,0,0,1],[0,0,0,0,1],[1,0,0,1,0]],color:"#1e40af",description:"Fast horizontal spaceship",category:"Spaceship"},{id:"mwss",name:"Middleweight Spaceship",pattern:[[0,0,1,1,1,1,1],[1,0,0,0,0,0,1],[0,0,0,0,0,0,1],[1,0,0,0,0,1,0],[0,0,1,1,0,0,0]],color:"#1e40af",description:"Medium-sized spaceship",category:"Spaceship"},{id:"pulsar",name:"Pulsar",pattern:[[0,0,1,1,1,0,0,0,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,0,0,0,1,0,1,0,0,0,0,1],[1,0,0,0,0,1,0,1,0,0,0,0,1],[1,0,0,0,0,1,0,1,0,0,0,0,1],[0,0,1,1,1,0,0,0,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,1,1,0,0,0,1,1,1,0,0],[1,0,0,0,0,1,0,1,0,0,0,0,1],[1,0,0,0,0,1,0,1,0,0,0,0,1],[1,0,0,0,0,1,0,1,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,1,1,0,0,0,1,1,1,0,0]],color:"#1e40af",description:"Large period-3 oscillator",category:"Oscillator"},{id:"gosper_gun",name:"Gosper Glider Gun",pattern:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],color:"#1e40af",description:"Infinite glider generator",category:"Gun"},{id:"r_pentomino",name:"R-Pentomino",pattern:[[0,1,1],[1,1,0],[0,1,0]],color:"#1e40af",description:"Chaotic pattern that stabilizes after 1103 generations",category:"Methuselah"},{id:"acorn",name:"Acorn",pattern:[[0,1,0,0,0,0,0],[0,0,0,1,0,0,0],[1,1,0,0,1,1,1]],color:"#1e40af",description:"Long-lived pattern that creates many gliders",category:"Methuselah"},{id:"diehard",name:"Diehard",pattern:[[0,0,0,0,0,0,1,0],[1,1,0,0,0,0,0,0],[0,1,0,0,0,1,1,1]],color:"#1e40af",description:"Dies after exactly 130 generations",category:"Methuselah"},{id:"copperhead",name:"Copperhead",pattern:[[0,1,1,0,0,1,1,0],[1,0,0,1,1,0,0,1],[0,1,0,0,0,0,1,0],[0,0,1,0,0,1,0,0],[0,0,1,0,0,1,0,0],[0,1,0,0,0,0,1,0],[1,0,0,1,1,0,0,1],[0,1,1,0,0,1,1,0]],color:"#1e40af",description:"Period-12 spaceship",category:"Spaceship"}],c=(q,K)=>{let pe=q;for(let ae=0;ae<K;ae++)pe=f(pe);return pe},f=q=>{const K=q.length,pe=q[0].length,ae=[];for(let ce=0;ce<pe;ce++){ae[ce]=[];for(let Te=0;Te<K;Te++)ae[ce][Te]=q[K-1-Te][ce]}return ae},p=q=>{const K={...q,pattern:c(q.pattern,s)};e(K)},g=()=>{a(q=>(q+1)%4)},y=()=>{a(q=>(q-1+4)%4)},b=q=>{const K=c(q.pattern,s),pe=[];for(let ae=0;ae<K.length;ae++){const ce=[];for(let Te=0;Te<K[ae].length;Te++){const be=K[ae][Te];ce.push(T.jsx("div",{className:`w-2.5 h-2.5 border-[0.5px] inline-block rounded-sm transition-all duration-300 ${be===1?i===1?"bg-gradient-to-br from-blue-400 to-blue-600 border-blue-300/80 shadow-sm shadow-blue-400/50 animate-pulse":"bg-gradient-to-br from-red-400 to-red-600 border-red-300/80 shadow-sm shadow-red-400/50 animate-pulse":"bg-slate-700/80 border-slate-600/60 hover:bg-slate-600/80"}`},`${ae}-${Te}`))}pe.push(T.jsx("div",{className:"flex gap-[1px]",children:ce},ae))}return T.jsx("div",{className:"flex flex-col gap-[1px] p-1",children:pe})},S=[...new Set(l.map(q=>q.category))],k=i===1?{bg:"bg-gradient-to-br from-slate-900/95 via-slate-800/95 to-blue-900/30",border:"border-blue-500/50",text:"text-blue-100",textSecondary:"text-blue-200/80",accent:"text-blue-400",button:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600",cardBg:"bg-slate-800/80",cardBorder:"border-slate-600/50",cardHover:"hover:border-blue-500/60 hover:bg-slate-700/90 hover:shadow-lg hover:shadow-blue-500/20",selectedBg:"bg-blue-900/40",selectedBorder:"border-blue-400/90",selectedShadow:"shadow-xl shadow-blue-500/30"}:i===2?{bg:"bg-gradient-to-br from-slate-900/95 via-slate-800/95 to-red-900/30",border:"border-red-500/50",text:"text-red-100",textSecondary:"text-red-200/80",accent:"text-red-400",button:"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600",cardBg:"bg-slate-800/80",cardBorder:"border-slate-600/50",cardHover:"hover:border-red-500/60 hover:bg-slate-700/90 hover:shadow-lg hover:shadow-red-500/20",selectedBg:"bg-red-900/40",selectedBorder:"border-red-400/90",selectedShadow:"shadow-xl shadow-red-500/30"}:{bg:"bg-gradient-to-br from-slate-900/95 via-slate-800/95 to-slate-900/95",border:"border-slate-500/50",text:"text-slate-100",textSecondary:"text-slate-200/80",accent:"text-slate-400",button:"bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-500 hover:to-slate-600",cardBg:"bg-slate-800/80",cardBorder:"border-slate-600/50",cardHover:"hover:border-slate-500/60 hover:bg-slate-700/90 hover:shadow-lg hover:shadow-slate-500/20",selectedBg:"bg-slate-900/40",selectedBorder:"border-slate-400/90",selectedShadow:"shadow-xl shadow-slate-500/30"};return T.jsxs("div",{className:`${k.bg} ${k.border} border-2 p-6 rounded-2xl min-w-80 max-w-96 shadow-2xl backdrop-blur-sm`,children:[T.jsxs("div",{className:"flex items-center justify-between mb-6",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:`w-10 h-10 ${k.button} rounded-lg flex items-center justify-center shadow-lg`,children:T.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),T.jsx("h3",{className:`text-xl font-bold ${k.text} tracking-wide`,children:"Pattern Library"})]}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:y,className:`p-2.5 ${k.button} text-white rounded-xl transition-all duration-300 shadow-lg transform hover:scale-110 active:scale-95 hover:shadow-xl`,title:"Rotate Counterclockwise",children:T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),T.jsx("button",{onClick:g,className:`p-2.5 ${k.button} text-white rounded-xl transition-all duration-300 shadow-lg transform hover:scale-110 active:scale-95 hover:shadow-xl`,title:"Rotate Clockwise",children:T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})]}),T.jsxs("div",{className:`text-xs ${k.textSecondary} mb-4 p-3 ${k.cardBg} rounded-xl border ${k.cardBorder} flex items-center justify-between`,children:[T.jsx("span",{children:"Select a pattern to place on the board"}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("span",{className:"text-xs opacity-70",children:"Rotation:"}),T.jsxs("span",{className:`${k.accent} font-mono font-bold`,children:[s*90,"°"]})]})]}),T.jsx("div",{className:"space-y-6 max-h-96 overflow-y-auto pr-2 scrollbar-thin scrollbar-track-slate-800/50 scrollbar-thumb-slate-600/50 scrollbar-thumb-rounded-full hover:scrollbar-thumb-slate-500/70",children:S.map(q=>T.jsxs("div",{className:"animate-fade-in",children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4 px-2",children:[T.jsx("div",{className:`w-8 h-8 ${k.button} rounded-lg flex items-center justify-center shadow-md`,children:T.jsx("span",{className:"text-white text-xs font-bold",children:q.charAt(0)})}),T.jsx("h4",{className:`text-sm font-bold ${k.accent} tracking-wider uppercase`,children:q}),T.jsx("div",{className:`flex-1 h-px ${k.button} opacity-30`})]}),T.jsx("div",{className:"space-y-3",children:l.filter(K=>K.category===q).map(K=>T.jsx("div",{className:`${k.cardBg} p-4 rounded-xl border cursor-pointer transition-all duration-300 ${t?.id===K.id?`${k.selectedBorder} ${k.selectedBg} ${k.selectedShadow} scale-[1.02]`:`${k.cardBorder} ${k.cardHover} hover:scale-[1.01]`} transform active:scale-[0.98] backdrop-blur-sm`,onClick:()=>p(K),children:T.jsxs("div",{className:"flex items-start gap-4",children:[T.jsxs("div",{className:"relative",children:[T.jsxs("div",{className:"flex flex-col items-center p-3 bg-slate-900/60 rounded-xl border border-slate-600/40 shadow-inner",children:[T.jsx("div",{className:"mb-2",children:b(K)}),T.jsxs("div",{className:`text-xs ${k.textSecondary} opacity-60`,children:[c(K.pattern,s).length,"×",c(K.pattern,s)[0]?.length||0]})]}),t?.id===K.id&&T.jsx("div",{className:`absolute -top-2 -right-2 w-6 h-6 ${k.button} rounded-full flex items-center justify-center shadow-lg`,children:T.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]}),T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsxs("div",{className:`text-sm font-bold ${k.text} mb-2 flex items-center gap-2`,children:[K.name,T.jsx("span",{className:`text-xs px-2 py-1 ${k.button} text-white rounded-full opacity-80`,children:K.category})]}),T.jsx("div",{className:`text-xs ${k.textSecondary} leading-relaxed mb-3`,children:K.description}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:`w-2 h-2 rounded-full ${i===1?"bg-blue-400":"bg-red-400"}`}),T.jsxs("span",{className:`text-xs ${k.textSecondary} opacity-60`,children:["Player ",i]})]})]})]})},K.id))})]},q))}),T.jsxs("div",{className:`mt-6 p-4 ${k.cardBg} rounded-xl border ${k.cardBorder} backdrop-blur-sm`,children:[T.jsxs("div",{className:`font-bold mb-3 ${k.text} flex items-center gap-2`,children:[T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Controls"]}),T.jsxs("div",{className:`text-xs ${k.textSecondary} space-y-2`,children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:`w-2 h-2 rounded-full ${k.button}`}),T.jsx("span",{children:"Select a pattern to activate placement mode"})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:`w-2 h-2 rounded-full ${k.button}`}),T.jsx("span",{children:"Use rotation buttons to orient patterns"})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:`w-2 h-2 rounded-full ${k.button}`}),T.jsx("span",{children:"Click on the board to place selected pattern"})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:`w-2 h-2 rounded-full ${k.button}`}),T.jsxs("span",{children:["Press"," ",T.jsx("kbd",{className:`px-1 py-0.5 ${k.cardBg} border rounded text-xs`,children:"ESC"})," ","to cancel placement"]})]})]})]})]})},jP=({game:i,currentUser:e,onCellClick:t,onShapeDrop:s,onClearPlayerCells:a,onToggleReadyForFight:l,gridSize:c=60})=>{const[f,p]=Se.useState(null),g=()=>e?i.user1?.uid===e.uid?1:i.user2?.uid===e.uid?2:0:0,y=P=>{p(P)},b=(P,k,q)=>{s&&s(P,k,q)},S=()=>{p(null)};return T.jsx("div",{className:"min-h-screen from-slate-900 via-slate-800 to-slate-900 p-4",children:T.jsx("div",{className:"max-w-[1920px] mx-auto h-full",children:T.jsxs("div",{className:"flex flex-col xl:flex-row gap-6 h-full",children:[T.jsx("div",{className:"flex-1 xl:flex-none xl:w-1/3 flex justify-center",children:T.jsx("div",{className:"w-full max-w-sm xl:max-w-none",children:T.jsx(UP,{playerNumber:g(),onShapeSelect:y,selectedShape:f})})}),T.jsx("div",{className:"flex-1 xl:flex-none xl:w-2/3 flex justify-center items-center",children:T.jsx("div",{className:"w-full max-w-5xl",children:T.jsx(SA,{game:i,currentUser:e,onCellClick:t,onShapeDrop:s,selectedShape:f,onShapePlace:b,onClearSelectedShape:S,onClearPlayerCells:a,onToggleReadyForFight:l,gridSize:c})})})]})})})},BP=()=>{const[i,e]=Se.useState(null),[t,s]=Se.useState(""),[a,l]=Se.useState(!1),[c,f]=Se.useState(null),[p,g]=Se.useState(!1),[y,b]=Se.useState(!1),[S,P]=Se.useState(!0),[k,q]=Se.useState(0),[K,pe]=Se.useState(!1);Se.useEffect(()=>ic.onAuthStateChanged(async oe=>{f(oe),oe&&await ae(oe.uid),P(!1)}),[]);const ae=async ue=>{try{const oe=C4(bi,"games"),z=db(oe,Wh("user1.uid","==",ue),Wh("state","!=","ended")),te=db(oe,Wh("user2.uid","==",ue),Wh("state","!=","ended")),[Z,fe]=await Promise.all([pb(z),pb(te)]);if(Z.empty){if(!fe.empty){const N=fe.docs[0];s(N.id),e({id:N.id,...N.data()})}}else{const N=Z.docs[0];s(N.id),e({id:N.id,...N.data()})}}catch(oe){console.error("Error checking for existing game:",oe)}},ce=async()=>{if(c){l(!0);try{const ue=await qd(c.uid);if(!ue){alert("Username not found. Please set up your username first."),l(!1);return}const oe=await MP(c.uid,ue);oe.success?(s(oe.gameId),b(!0)):alert("Failed to create game. Please try again.")}catch(ue){console.error("Error creating game:",ue),alert("Failed to create game. Please try again.")}finally{l(!1)}}},Te=async ue=>{if(c)try{const oe=await qd(c.uid);if(!oe){alert("Username not found. Please set up your username first.");return}(await PP(ue,c.uid,oe)).success&&s(ue)}catch(oe){console.error("Error joining game:",oe),alert("Failed to join game. Please check the game ID and try again.")}},be=async()=>{if(!t||!c||!i)return;const ue=Ki(bi,"games",t),z=i.user1?.uid===c.uid?"user1.ready":"user2.ready";try{await Rr(ue,{[z]:!p})}catch(te){console.error("Error updating ready state:",te)}},Re=async()=>{if(!t||!c)return;const ue=Ki(bi,"games",t);try{await Rr(ue,{state:"ended"}),e(null),s(""),g(!1),b(!1)}catch(oe){console.error("Error aborting game:",oe)}},M=async()=>{if(!t||!c)return;const ue=Ki(bi,"games",t);try{await Rr(ue,{state:"waiting","user1.ready":!1,"user2.ready":!1,"user1.readyForFight":!1,"user2.readyForFight":!1,grid:R(60),startedAt:null,fightingStartedAt:null,finalGrid:null,winner:null,timerStarted:!1}),g(!1),pe(!1),q(0)}catch(oe){console.error("Error restarting game:",oe)}},R=ue=>{const oe={};for(let z=0;z<ue;z++)oe[`row${z}`]=Array(ue).fill(0);return oe},I=async(ue,oe)=>{if(!t||!c||!i)return;const z=i.user1?.uid===c.uid?1:i.user2?.uid===c.uid?2:0;if(z===0)return;const te=Ki(bi,"games",t);try{const Z={...i.grid};Z[`row${ue}`]||(Z[`row${ue}`]=Array(60).fill(0));const fe=Z[`row${ue}`][oe]||0;Z[`row${ue}`][oe]=fe===0?z:0,await Rr(te,{grid:Z})}catch(Z){console.error("Error updating grid:",Z)}},D=async()=>{if(!t||!c||!i)return;const ue=i.user1?.uid===c.uid?1:i.user2?.uid===c.uid?2:0;if(ue===0)return;const oe=Ki(bi,"games",t);try{const z={...i.grid},te=18,Z=60;for(let fe=0;fe<Z;fe++)if((ue===1&&fe<te||ue===2&&fe>=Z-te)&&z[`row${fe}`])for(let X=0;X<Z;X++)z[`row${fe}`][X]===ue&&(z[`row${fe}`][X]=0);await Rr(oe,{grid:z})}catch(z){console.error("Error clearing player cells:",z)}},V=async()=>{if(!t||!c||!i||i.state!=="started")return;const ue=Ki(bi,"games",t),oe=i.user1?.uid===c.uid,z=oe?"user1.readyForFight":"user2.readyForFight",te=oe?i.user1?.readyForFight:i.user2?.readyForFight;try{if(await Rr(ue,{[z]:!te}),(oe?i.user2?.readyForFight:i.user1?.readyForFight)&&!te)try{await VP(t)}catch(N){console.error("Error starting fighting phase:",N)}}catch(Z){console.error("Error toggling ready for fight:",Z)}},L=()=>{pe(!0)},x=async(ue,oe,z)=>{if(!t||!c||!i)return;const te=i.user1?.uid===c.uid?1:i.user2?.uid===c.uid?2:0;if(te===0)return;const Z=Ki(bi,"games",t);try{const fe={...i.grid};ue.pattern.forEach((N,X)=>{N.forEach((re,ne)=>{if(re===1){const ye=oe+X,Oe=z+ne;ye>=0&&ye<60&&Oe>=0&&Oe<60&&(fe[`row${ye}`]||(fe[`row${ye}`]=Array(60).fill(0)),fe[`row${ye}`][Oe]===0&&(fe[`row${ye}`][Oe]=te))}})}),await Rr(Z,{grid:fe})}catch(fe){console.error("Error dropping shape:",fe)}};if(Se.useEffect(()=>{let ue;if(i?.state==="started"&&i.startedAt){const oe=i.startedAt.toDate?i.startedAt.toDate():new Date(i.startedAt),z=new Date(oe.getTime()+2*60*1e3);ue=setInterval(()=>{const te=new Date,Z=Math.max(0,Math.ceil((z.getTime()-te.getTime())/1e3));q(Z),Z===0&&(clearInterval(ue),console.log("Client-side timer reached zero - waiting for server to transition game"))},1e3)}return()=>{ue&&clearInterval(ue)}},[i?.state,i?.startedAt]),Se.useEffect(()=>{i?.state==="started"&&i.user1?.readyForFight&&i.user2?.readyForFight&&console.log("Both players ready for fight - battle should start soon")},[i?.state,i?.user1?.readyForFight,i?.user2?.readyForFight]),Se.useEffect(()=>{if(!t)return;const ue=Ki(bi,"games",t);return G4(ue,z=>{if(z.exists()){const te={id:z.id,...z.data()};if(te.state==="ended"){e(null),s(""),g(!1),b(!1);return}if(e(te),c){const fe=te.user1?.uid===c.uid?te.user1?.ready:te.user2?.ready;g(fe||!1)}te.user1?.ready&&te.user2?.ready&&te.state==="waiting"&&(async()=>{await Rr(ue,{state:"started",startedAt:new Date,timerStarted:!1});try{await LP(t),console.log("Server-side timer started successfully")}catch(fe){console.error("Error starting server-side timer:",fe)}})()}})},[t,c]),i?.state==="started"){const ue=Math.floor(k/60),oe=k%60;return T.jsxs("div",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl shadow-2xl p-8 border-2 border-slate-700/50 backdrop-blur-sm",children:[T.jsxs("div",{className:"text-center mb-8",children:[T.jsx("h2",{className:"text-4xl font-bold text-transparent bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text mb-4",children:"🎮 Battle Arena Active 🎮"}),T.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm rounded-xl p-6 border border-slate-600/40",children:[T.jsxs("div",{className:"flex justify-center items-center gap-4 mb-4",children:[T.jsx("div",{className:"text-cyan-300 font-semibold",children:i.user1?.username}),T.jsx("div",{className:"text-2xl text-slate-400",children:"VS"}),T.jsx("div",{className:"text-cyan-300 font-semibold",children:i.user2?.username})]}),T.jsxs("div",{className:"text-center mb-4",children:[T.jsxs("div",{className:"text-3xl font-bold text-transparent bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text mb-2",children:["⏰ ",ue,":",oe.toString().padStart(2,"0")]}),T.jsx("p",{className:"text-slate-400 text-sm",children:"Prepare your strategy! Battle begins automatically when timer reaches zero."})]}),T.jsx("div",{className:"flex justify-center",children:T.jsx("button",{onClick:Re,className:"px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-semibold rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-red-500/25",children:"Abort Game"})})]})]}),T.jsx(jP,{game:i,currentUser:c,onCellClick:I,onShapeDrop:x,onClearPlayerCells:D,onToggleReadyForFight:V,gridSize:60})]})}return i?.state==="fighting"?T.jsxs("div",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl shadow-2xl p-8 border-2 border-slate-700/50 backdrop-blur-sm",children:[T.jsxs("div",{className:"text-center mb-8",children:[T.jsx("h2",{className:"text-4xl font-bold text-transparent bg-gradient-to-r from-red-400 to-orange-400 bg-clip-text mb-4",children:"⚔️ Battle in Progress ⚔️"}),T.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm rounded-xl p-6 border border-slate-600/40",children:[T.jsxs("div",{className:"flex justify-center items-center gap-4 mb-6",children:[T.jsx("div",{className:"text-cyan-300 font-semibold",children:i.user1?.username}),T.jsx("div",{className:"text-2xl text-slate-400",children:"VS"}),T.jsx("div",{className:"text-cyan-300 font-semibold",children:i.user2?.username})]}),T.jsxs("div",{className:"flex justify-center gap-4",children:[K&&T.jsx("button",{onClick:M,className:"px-6 py-3 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white font-semibold rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-cyan-500/25",children:"🔄 Restart Game"}),T.jsx("button",{onClick:Re,className:"px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-semibold rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-red-500/25",children:"Abort Game"})]})]})]}),T.jsx(SA,{game:i,currentUser:c,onCellClick:I,onAnimationComplete:L,onClearPlayerCells:D,onToggleReadyForFight:V,gridSize:60})]}):T.jsx("div",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl shadow-2xl p-8 border-2 border-slate-700/50 backdrop-blur-sm",children:S?T.jsxs("div",{className:"text-center py-12",children:[T.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-cyan-400 border-t-transparent mx-auto mb-4"}),T.jsx("h2",{className:"text-xl font-semibold text-cyan-400",children:"Loading..."})]}):T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"text-center mb-8",children:[T.jsx("h2",{className:"text-4xl font-bold text-transparent bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text mb-2",children:"Game Arena"}),T.jsx("p",{className:"text-slate-400",children:"Create or join a Conway's Game of Life battle"})]}),t?T.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm p-8 rounded-xl border border-slate-600/40",children:[T.jsxs("div",{className:"text-center mb-8",children:[T.jsx("h3",{className:"text-3xl font-bold text-cyan-300 mb-4",children:"Game Lobby"}),T.jsxs("div",{className:"bg-slate-700/60 rounded-lg p-4 border border-slate-600/40",children:[T.jsx("p",{className:"text-slate-300 mb-2",children:"Game ID:"}),T.jsx("div",{className:"text-2xl font-mono text-cyan-400 tracking-wider",children:t})]})]}),T.jsxs("div",{className:"mb-8",children:[T.jsx("h4",{className:"text-xl font-semibold text-slate-300 mb-6 text-center",children:"Players"}),T.jsxs("div",{className:"grid gap-4",children:[T.jsx("div",{className:"bg-slate-700/60 backdrop-blur-sm p-6 rounded-xl border border-slate-600/40",children:T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold",children:"1"}),T.jsx("span",{className:"font-semibold text-slate-200",children:i?.user1?.username||"Player 1"})]}),T.jsx("div",{className:`px-4 py-2 rounded-full text-sm font-semibold transition-all duration-300 ${i?.user1?.ready?"bg-green-500/20 text-green-400 border-2 border-green-500/50 shadow-lg shadow-green-500/20":"bg-slate-600/60 text-slate-400 border-2 border-slate-500/50"}`,children:i?.user1?.ready?"✓ Ready":"○ Not Ready"})]})}),T.jsx("div",{className:"bg-slate-700/60 backdrop-blur-sm p-6 rounded-xl border border-slate-600/40",children:T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-red-500 to-red-600 rounded-full flex items-center justify-center text-white font-bold",children:"2"}),T.jsx("span",{className:"font-semibold text-slate-200",children:i?.user2?.username||"Waiting for Player 2..."})]}),i?.user2&&T.jsx("div",{className:`px-4 py-2 rounded-full text-sm font-semibold transition-all duration-300 ${i?.user2?.ready?"bg-green-500/20 text-green-400 border-2 border-green-500/50 shadow-lg shadow-green-500/20":"bg-slate-600/60 text-slate-400 border-2 border-slate-500/50"}`,children:i?.user2?.ready?"✓ Ready":"○ Not Ready"})]})})]})]}),i?.user2&&T.jsxs("div",{className:"mb-8",children:[T.jsx("button",{onClick:be,className:`w-full py-4 px-6 font-semibold rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg ${p?"bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-500 hover:to-orange-500 text-white shadow-amber-500/25":"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white shadow-green-500/25"}`,children:p?"Cancel Ready":"Ready to Start"}),i?.user1?.ready&&i?.user2?.ready&&T.jsx("div",{className:"mt-6 text-center",children:T.jsx("div",{className:"bg-green-500/20 rounded-lg p-4 border border-green-500/50",children:T.jsxs("div",{className:"flex items-center justify-center gap-2",children:[T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-green-400 border-t-transparent"}),T.jsx("p",{className:"text-green-400 font-semibold",children:"Starting game..."})]})})})]}),y&&!i?.user2&&T.jsx("div",{className:"mb-8",children:T.jsx("div",{className:"bg-cyan-500/20 rounded-lg p-6 border border-cyan-500/50",children:T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"text-4xl mb-3",children:"⏳"}),T.jsx("p",{className:"text-cyan-300 font-semibold mb-2",children:"Waiting for another player to join..."}),T.jsx("p",{className:"text-cyan-400 text-sm",children:"Share this Game ID with your friend:"}),T.jsx("div",{className:"mt-3 p-3 bg-cyan-900/30 rounded-lg",children:T.jsx("div",{className:"text-xl font-mono text-cyan-300 tracking-wider",children:t})})]})})}),T.jsx("div",{className:"text-center",children:T.jsx("button",{onClick:Re,className:"px-8 py-4 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-semibold rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-red-500/25",children:"Abort Game"})})]}):T.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[T.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm p-6 rounded-xl border border-slate-600/40",children:[T.jsx("h3",{className:"text-2xl font-bold text-cyan-300 mb-6 text-center",children:"Create New Game"}),T.jsxs("div",{className:"text-center mb-6",children:[T.jsx("div",{className:"text-6xl mb-4",children:"🎮"}),T.jsx("p",{className:"text-slate-400 text-sm",children:"Start a new battle arena and invite a friend"})]}),T.jsx("button",{onClick:ce,disabled:a||!c,className:"w-full py-4 px-6 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white font-semibold rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-cyan-500/25 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:a?T.jsxs("div",{className:"flex items-center justify-center gap-2",children:[T.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"Creating..."]}):"Create Game"})]}),T.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm p-6 rounded-xl border border-slate-600/40",children:[T.jsx("h3",{className:"text-2xl font-bold text-green-300 mb-6 text-center",children:"Join Existing Game"}),T.jsxs("div",{className:"text-center mb-6",children:[T.jsx("div",{className:"text-6xl mb-4",children:"🤝"}),T.jsx("p",{className:"text-slate-400 text-sm",children:"Enter a Game ID to join an existing battle"})]}),T.jsx("input",{type:"text",placeholder:"Enter Game ID",className:"w-full px-4 py-3 bg-slate-700/60 border border-slate-600/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-400 text-white placeholder-slate-400 mb-4 transition-all duration-300 backdrop-blur-sm",onKeyDown:ue=>{if(ue.key==="Enter"){const oe=ue.target.value.trim();oe&&Te(oe)}}}),T.jsx("button",{onClick:()=>{const oe=document.querySelector('input[placeholder="Enter Game ID"]')?.value.trim();oe&&Te(oe)},disabled:!c,className:"w-full py-4 px-6 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white font-semibold rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-green-500/25 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:"Join Game"})]})]})]})})},FP=({onJoinGame:i})=>T.jsx("main",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center px-4",children:T.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[T.jsxs("header",{className:"mb-12 animate-fade-in",children:[T.jsx("div",{className:"inline-block p-4 bg-gradient-to-r from-cyan-500/20 to-blue-500/20 rounded-full mb-6 border border-cyan-500/30 animate-pulse",children:T.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center",children:T.jsx("svg",{className:"w-8 h-8 text-white animate-bounce",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})}),T.jsx("h1",{className:"text-6xl md:text-7xl font-bold text-transparent bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 bg-clip-text mb-6 animate-gradient",children:"Conway's Battle"}),T.jsxs("p",{className:"text-xl md:text-2xl text-slate-300 mb-8 max-w-3xl mx-auto leading-relaxed opacity-90",children:["Experience the ultimate strategy game where"," ",T.jsx("span",{className:"text-cyan-400 font-semibold",children:"Conway's Game of Life"})," ","meets competitive multiplayer action. Design your cellular army and watch it evolve in real-time!"]})]}),T.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-12",children:[T.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50 hover:border-cyan-500/50 transition-all duration-300 hover:transform hover:scale-105",children:[T.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mb-4 mx-auto",children:T.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),T.jsx("h3",{className:"text-xl font-semibold text-blue-300 mb-2",children:"Strategic Gameplay"}),T.jsx("p",{className:"text-slate-400",children:"Design your initial cellular patterns and watch them evolve through Conway's rules"})]}),T.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50 hover:border-red-500/50 transition-all duration-300 hover:transform hover:scale-105",children:[T.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-red-500 to-red-600 rounded-lg flex items-center justify-center mb-4 mx-auto",children:T.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),T.jsx("h3",{className:"text-xl font-semibold text-red-300 mb-2",children:"Multiplayer Combat"}),T.jsx("p",{className:"text-slate-400",children:"Battle against other players in real-time cellular warfare"})]}),T.jsxs("div",{className:"bg-slate-800/60 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50 hover:border-purple-500/50 transition-all duration-300 hover:transform hover:scale-105",children:[T.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg flex items-center justify-center mb-4 mx-auto",children:T.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),T.jsx("h3",{className:"text-xl font-semibold text-purple-300 mb-2",children:"Live Evolution"}),T.jsx("p",{className:"text-slate-400",children:"Watch your designs come to life with smooth animations and real-time updates"})]})]}),T.jsxs("div",{className:"bg-slate-800/40 backdrop-blur-sm rounded-xl p-8 border border-slate-700/50 mb-12",children:[T.jsx("h2",{className:"text-3xl font-bold text-slate-200 mb-6",children:"How to Play"}),T.jsxs("div",{className:"grid md:grid-cols-2 gap-6 text-left",children:[T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-cyan-300 mb-3",children:"Setup Phase"}),T.jsxs("ul",{className:"space-y-2 text-slate-300",children:[T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-cyan-400 font-bold",children:"1."}),T.jsx("span",{children:"Each player gets their own section of the grid"})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-cyan-400 font-bold",children:"2."}),T.jsx("span",{children:"Place your cells strategically in your area"})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-cyan-400 font-bold",children:"3."}),T.jsx("span",{children:"Use pre-made patterns or create your own designs"})]})]})]}),T.jsxs("div",{children:[T.jsx("h3",{className:"text-lg font-semibold text-red-300 mb-3",children:"Battle Phase"}),T.jsxs("ul",{className:"space-y-2 text-slate-300",children:[T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-red-400 font-bold",children:"1."}),T.jsx("span",{children:"Conway's Game of Life rules take effect"})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-red-400 font-bold",children:"2."}),T.jsx("span",{children:"Cells evolve, survive, or die based on neighbors"})]}),T.jsxs("li",{className:"flex items-start gap-2",children:[T.jsx("span",{className:"text-red-400 font-bold",children:"3."}),T.jsx("span",{children:"Player with the most surviving cells wins!"})]})]})]})]})]}),T.jsxs("section",{className:"space-y-6 animate-fade-in",children:[T.jsx("button",{type:"button",onClick:i,"aria-label":"Start playing Conway's Battle",className:"px-12 py-5 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-400 hover:to-blue-400 text-white font-bold text-xl rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg shadow-cyan-500/25 hover:shadow-cyan-400/40 active:scale-95",children:T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h1a3 3 0 000-6h-1m3 6V4a3 3 0 00-3-3H6a3 3 0 00-3 3v6h4.5m11.5 0h-4.5m0 0v6a3 3 0 003 3h3a3 3 0 003-3v-6m-9-6h4.5m0 0V4a3 3 0 00-3-3h-3a3 3 0 00-3 3v6"})}),"Start Playing"]})}),T.jsx("p",{className:"text-slate-400 text-sm",children:"Join the cellular revolution and prove your strategic mastery!"})]}),T.jsx("div",{className:"mt-16 pt-8 border-t border-slate-700/50",children:T.jsx("p",{className:"text-slate-500 text-sm pb-1",children:"Built with React, Firebase, and the power of Conway's Game of Life"})})]})});function zP(){const[i,e]=Se.useState(null),[t,s]=Se.useState(null),[a,l]=Se.useState(!0),[c,f]=Se.useState(!1);Se.useEffect(()=>{const b=mM(ic,async S=>{if(e(S),S){const P=await qd(S.uid);s(P),f(!1)}else s(null);l(!1)});return()=>b()},[]);const p=async b=>{const S=await qd(b);s(S)},g=()=>{f(!0)},y=()=>{f(!1)};return a?T.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:T.jsxs("div",{className:"text-center animate-fade-in",children:[T.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-cyan-400 border-t-transparent mx-auto mb-6"}),T.jsx("div",{className:"text-xl text-cyan-400 font-semibold mb-2",children:"Loading Conway's Battle..."}),T.jsx("div",{className:"text-sm text-slate-400",children:"Preparing your cellular warfare experience"})]})}):T.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:i?T.jsxs("div",{className:"container mx-auto px-4 py-8",children:[T.jsx("div",{className:"bg-slate-800/60 backdrop-blur-sm rounded-2xl shadow-2xl p-6 mb-6 border-2 border-slate-700/50",children:T.jsxs("div",{className:"flex justify-between items-center mb-4",children:[T.jsxs("div",{className:"flex items-center gap-4",children:[T.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center",children:T.jsx("span",{className:"text-white font-bold text-lg",children:(t||i.email||"U").charAt(0).toUpperCase()})}),T.jsxs("div",{children:[T.jsxs("div",{className:"text-2xl font-bold text-transparent bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text",children:["Welcome, ",t||i.email,"!"]}),T.jsx("div",{className:"text-slate-400 text-sm",children:"Ready to battle in Conway's Game of Life?"})]})]}),T.jsx("button",{onClick:()=>ic.signOut(),className:"px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 text-white font-semibold rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-red-500/25 active:scale-95",children:T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})})]})}),T.jsx(BP,{})]}):c?T.jsx("div",{className:"flex items-center justify-center min-h-screen",children:T.jsxs("div",{className:"relative",children:[T.jsxs("button",{onClick:y,className:"absolute -top-16 left-0 text-slate-400 hover:text-cyan-400 transition-all duration-200 flex items-center gap-2 group",children:[T.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:-translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Home"]}),T.jsx(IP,{onAuthSuccess:p})]})}):T.jsx(FP,{onJoinGame:g})})}rC.createRoot(document.getElementById("root")).render(T.jsx(Se.StrictMode,{children:T.jsx(zP,{})}));
